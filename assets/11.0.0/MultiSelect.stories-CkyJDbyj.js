import{j as e}from"./jsx-runtime-BlAj40OV.js";import{r as o}from"./index-Cs7sjTYM.js";import{s as U,j as he,V as K,t as M,e as Z,c as a,r as be,k as ee,i as z,F as Se,ad as xe,p as te,B as _,I as D,l as ve,S as B,T as G}from"./ScrollView-DAMcnhPN.js";import{u as Te}from"./useBoolean-DHW5baxv.js";import{u as we}from"./useDisclosure-DLkMFUa4.js";import{g as je}from"./array-BfAlyugE.js";import{s as ke}from"./string-CSzQMepT.js";import{P as Ie,F as Ce}from"./Popover-SzN_tnL1.js";import{I as qe}from"./InputError-CkzCzEWc.js";import{a as Ve}from"./Pressable-8N6ahZPW.js";import{T as re}from"./Tag-BsNIDiwk.js";import{T as Pe}from"./index-Cyz8msWj.js";import{M as $}from"./index-Cp2lnEJT.js";import{S as ce,a as C}from"./_StoriesComponents-4WTDdsYg.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-DJFdew98.js";import"./useResponsive-CzIqCC5v.js";import"./function-DMPX11KF.js";import"./BottomPanel-DvLAyyFQ.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-DMoYUPTW.js";import"./FocusTrap-HMOsJfWh.js";import"./Suspendable-Bl-Qq_g-.js";import"./index-CJghV6hQ.js";import"./extends-CF3RwP-h.js";import"./TransitionView-_995VKea.js";import"./Separator-qitoqTAJ.js";const Me=U.create({scrollTracker:{position:"absolute",pointerEvents:"none",right:0,bottom:0}}),Le=({ItemSeparatorComponent:s,ListEmptyComponent:i,ListFooterComponent:m,ListHeaderComponent:b,contentContainerStyle:w,horizontal:u=!1,keyExtractor:c,onEndReached:d,onEndReachedThresholdPx:S=200,onKeyDown:j,onScroll:x,renderItem:l,renderSectionHeader:p,role:y,scrollEventThrottle:N=16,sections:k,showsScrollIndicators:V=!0,style:I},P)=>{const R=o.useId(),g=o.useRef(null),H=u?{top:0,width:S}:{left:0,height:S};return o.useEffect(()=>{const f=g.current;if(f!=null){const v=new IntersectionObserver(T=>{T.forEach(F=>{F.isIntersecting&&(d==null||d())})});return v.observe(f),()=>{v.unobserve(f)}}},[k.length]),e.jsxs(he,{contentContainerStyle:w,horizontal:u,onKeyDown:j,onScroll:x,ref:P,role:y,scrollEventThrottle:N,showsScrollIndicators:V,style:I,children:[b,k.length<=0?i:k.map(f=>e.jsxs(o.Fragment,{children:[p==null?void 0:p(f),f.data.map((v,T)=>e.jsxs(o.Fragment,{children:[T!==0&&s,l({item:v,index:T})]},c(v,T)))]},`group-${R}-${f.title}`)),m,e.jsx(K,{role:"none",ref:g,style:[Me.scrollTracker,H]})]})},de=o.forwardRef(Le);de.__docgenInfo={description:"",methods:[],displayName:"SectionList",props:{ItemSeparatorComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListEmptyComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListHeaderComponent:{required:!1,tsType:{name:"ReactNode"},description:""},contentContainerStyle:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},horizontal:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: T, index: number) => string",signature:{arguments:[{type:{name:"T"},name:"item"},{type:{name:"number"},name:"index"}],return:{name:"string"}}},description:""},onEndReached:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEndReachedThresholdPx:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"200",computed:!1}},onKeyDown:{required:!1,tsType:{name:'intersection["onKeyDown"]',raw:'ScrollViewProps["onKeyDown"]'},description:""},onScroll:{required:!1,tsType:{name:'intersection["onScroll"]',raw:'ScrollViewProps["onScroll"]'},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(info: ListRenderItemInfo<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  item: T;
  index: number;
}`,signature:{properties:[{key:"item",value:{name:"T",required:!0}},{key:"index",value:{name:"number",required:!0}}]}},name:"info"}],return:{name:"ReactNode"}}},description:""},renderSectionHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(section: Section<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}},name:"section"}],return:{name:"ReactNode"}}},description:""},role:{required:!1,tsType:{name:"WebRole"},description:""},scrollEventThrottle:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"16",computed:!1}},sections:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}}],raw:"Section<T>[]"},description:""},showsScrollIndicators:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""}}};const Ee=120,Ne=32,Re=10.5,n=U.create({base:{...M.regular,backgroundColor:Z.accented,borderColor:a.gray[100],borderRadius:be[6],borderWidth:1,cursor:"default",overflow:"hidden",transitionDuration:"150ms",transitionProperty:"border-color, box-shadow"},errored:{borderColor:a.negative[500]},tag:{marginRight:4,marginVertical:2},hovered:{boxShadow:ee.tile},focused:{borderColor:a.gray[500],boxShadow:ee.tile,outlineStyle:"none"},disabled:{backgroundColor:a.gray[50],borderColor:a.gray[100],cursor:"not-allowed"},actions:{marginVertical:"auto",position:"absolute",bottom:0,top:0,right:20},placeholder:{...M.regular,color:a.gray[300],userSelect:"none"},list:{marginVertical:4,maxHeight:Ne*Re,minHeight:224},filterContainer:{flexGrow:1,flexShrink:1,margin:16},filterInput:{...M.regular,backgroundColor:Z.accented,borderColor:a.gray[100],borderRadius:4,borderWidth:1,flexGrow:1,flexShrink:1,height:40,outlineStyle:"none",paddingHorizontal:12,paddingLeft:40,placeholderTextColor:a.gray[300]},filterFocused:{borderColor:a.gray[200]},searchIcon:{position:"absolute",left:14},tagsList:{flexWrap:"wrap",maxHeight:Ee,minHeight:40,overflowY:"auto",paddingHorizontal:16,paddingRight:60,paddingVertical:8},groupTitleBase:{alignItems:"center",flexDirection:"row",flexGrow:1,flexShrink:1,justifyContent:"space-between",paddingHorizontal:16,paddingVertical:12,transitionDuration:"200ms",transitionProperty:"background-color"},groupTitle:{...M.semibold,userSelect:"none"},line:{...M.regular,paddingHorizontal:16,paddingVertical:8,transitionDuration:"200ms",transitionProperty:"background-color",userSelect:"none"},lineInGroup:{paddingLeft:24},emptyList:{height:136},emptyListText:{color:a.gray.primary}}),Y=({color:s="gray",disabled:i=!1,emptyResultText:m,enableGroups:b=!0,filterPlaceholder:w,items:u,onValueChange:c,placeholder:d,renderTagGroup:S,error:j,style:x,values:l,id:p})=>{const[y,N]=o.useState(""),[k,V]=Te(!1),I=o.useRef(!1),P=o.useRef(null),R=o.useRef(null),[g,{open:H,close:f}]=we(!1),v=a[s][50],T=a[s][100];o.useEffect(()=>{g||N("")},[g]),o.useEffect(()=>{var t,r;if(I.current){const h=(t=P.current)==null?void 0:t.scrollHeight;(r=P.current)==null||r.scrollTo({top:h})}I.current=!1},[l]);const F=t=>{I.current=!0,c([...l,t.value])},me=t=>{c(l.filter(r=>r!==t.value))},pe=()=>{c([])},ye=t=>{I.current=!0;const r=t.map(O=>O.value),h=[...new Set([...l,...r])];c(h)},X=o.useMemo(()=>{const t=new Map;return u.forEach(r=>{t.set(r.value,r)}),t},[u]),A=o.useMemo(()=>l.map(t=>X.get(t)).filter(z),[l,X]),W=o.useMemo(()=>{const t=u.filter(h=>!l.includes(h.value)),r=y.trim().toLowerCase();return r===""?t:t.filter(({label:h})=>h.toLowerCase().includes(r))},[y,u,l]),ge=o.useMemo(()=>Se.filterMap(xe.entries(je(W,({group:t})=>t)),([t,r])=>r===void 0?te.None():te.Some({title:t,data:r})),[W]),J=o.useMemo(()=>e.jsxs(_,{direction:"row",alignItems:"center",style:n.filterContainer,children:[e.jsx(Pe,{autoComplete:"off",inputMode:"search",multiline:!1,rows:1,onChangeText:t=>N(t),placeholder:w,value:y,onFocus:V.on,onBlur:V.off,style:[n.filterInput,k&&n.filterFocused]}),e.jsx(D,{name:"search-filled",color:a[s].primary,size:20,style:n.searchIcon})]}),[y,k,V,w,s]),Q=o.useMemo(()=>e.jsxs(_,{justifyContent:"center",alignItems:"center",style:n.emptyList,children:[e.jsx(D,{name:"clipboard-search-regular",size:24,color:a.gray.primary}),ve(m)&&e.jsxs(e.Fragment,{children:[e.jsx(B,{height:8}),e.jsx(G,{style:n.emptyListText,children:m})]})]}),[m]);return e.jsxs(K,{style:x,children:[e.jsxs($,{id:p,ref:R,"aria-haspopup":"listbox",role:"button","aria-expanded":g,disabled:i,onPress:H,style:({hovered:t,focused:r})=>[n.base,t&&n.hovered,(r||g)&&n.focused,i&&n.disabled,z(j)&&n.errored],children:[e.jsx(_,{ref:P,alignItems:"center",direction:"row",style:n.tagsList,children:A.length>0?A.map(t=>e.jsx(re,{color:s,onPressRemove:i?void 0:()=>me(t),style:n.tag,children:t.label},String(t.value))):d!==""?e.jsx(G,{role:"label",numberOfLines:1,style:n.placeholder,children:d}):null}),e.jsxs(_,{direction:"row",alignItems:"center",style:n.actions,children:[A.length>=1&&!i&&e.jsxs(e.Fragment,{children:[e.jsx($,{role:"button",onPress:pe,children:e.jsx(D,{name:"dismiss-filled",color:a.gray.primary,size:15})}),e.jsx(B,{width:8})]}),e.jsx(D,{color:a.gray.primary,name:g?"chevron-up-filled":"chevron-down-filled",size:20})]})]}),e.jsx(Ie,{role:"listbox",matchReferenceWidth:!0,onDismiss:f,referenceRef:R,returnFocus:!0,visible:g,children:e.jsx(K,{style:n.list,children:b?e.jsx(de,{role:"listbox","aria-multiselectable":!0,keyExtractor:(t,r)=>`group-field-${String(t.value)}-${r}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(B,{height:16}),sections:ge,renderSectionHeader:({title:t,data:r})=>e.jsxs($,{role:"listitem",onPress:()=>ye(r),style:({hovered:h,pressed:O,focused:fe})=>[n.groupTitleBase,(h||fe)&&{backgroundColor:v},O&&{backgroundColor:T}],children:[e.jsx(G,{numberOfLines:1,style:n.groupTitle,children:t}),z(S)&&e.jsx(re,{color:s,children:S(r)})]}),renderItem:({item:t})=>e.jsx(ae,{color:s,filter:y,item:t,handleSelectItem:F,style:n.lineInGroup})}):e.jsx(Ce,{role:"list",data:W,keyExtractor:t=>`field-${String(t.value)}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(B,{height:8}),renderItem:({item:t})=>e.jsx(ae,{color:s,filter:y,item:t,handleSelectItem:F})})})}),e.jsx(qe,{message:j})]})},ae=({item:s,color:i,filter:m,handleSelectItem:b,style:w})=>{const{label:u,disabled:c=!1}=s,d=m.trim().toLowerCase(),S=a[i][50],j=a[i][100],x=o.useMemo(()=>c||d===""?u:ke(u,d),[u,c,d]);return e.jsx(Ve,{role:"listitem",disabled:c,numberOfLines:1,onPress:()=>b(s),style:({hovered:l,pressed:p})=>[n.line,w,l&&{backgroundColor:S},p&&{backgroundColor:j},c&&{backgroundColor:a.gray[50],color:a.gray[100]}],children:typeof x=="string"?x:x.map((l,p)=>l.toLowerCase()===d?e.jsx(G,{style:{color:i},children:l},p):l)})};Y.__docgenInfo={description:"",methods:[],displayName:"MultiSelect",props:{color:{required:!1,tsType:{name:"union",raw:"keyof typeof colors",elements:[{name:"literal",value:"gray"},{name:"literal",value:"live"},{name:"literal",value:"sandbox"},{name:"literal",value:"positive"},{name:"literal",value:"warning"},{name:"literal",value:"negative"},{name:"literal",value:"current"},{name:"literal",value:"partner"},{name:"literal",value:"swan"},{name:"literal",value:"shakespear"},{name:"literal",value:"darkPink"},{name:"literal",value:"sunglow"},{name:"literal",value:"mediumSladeBlue"}]},description:"",defaultValue:{value:'"gray"',computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},error:{required:!1,tsType:{name:"string"},description:""},emptyResultText:{required:!1,tsType:{name:"string"},description:""},enableGroups:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},filterPlaceholder:{required:!1,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  disabled?: boolean;
  group: string;
  label: string;
  value: Value;
}`,signature:{properties:[{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"Value",required:!0}}]}}],raw:"MultiSelectItem<Value>[]"},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(values: Value[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"Value"}],raw:"Value[]"},name:"values"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},renderTagGroup:{required:!1,tsType:{name:"signature",type:"function",raw:"(items: readonly MultiSelectItem<Value>[]) => string",signature:{arguments:[{type:{name:"unknown"},name:"items"}],return:{name:"string"}}},description:""},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},values:{required:!0,tsType:{name:"Array",elements:[{name:"Value"}],raw:"Value[]"},description:""},id:{required:!1,tsType:{name:"string"},description:""}}};const Fe=U.create({select:{maxWidth:400}}),dt={title:"Forms/MultiSelect",component:Y},_e=[{label:"Camille",value:"camille",group:"C"},{label:"Charlotte",value:"charlotte",group:"C"},{label:"Francis",value:"francis",group:"F"},{label:"Émilie",value:"emilie",group:"E"},{label:"François",value:"francois",group:"F"},{label:"Laura",value:"laura",group:"L"},{label:"Marie-Anne",value:"marie_anne",group:"M"},{label:"Natasha",value:"natasha",group:"N",disabled:!0},{label:"Nicolas",value:"nicolas",group:"N"},{label:"Pierre",value:"pierre",group:"P"}],q=({initialValues:s=[],...i})=>{const[m,b]=o.useState(s);return e.jsx(Y,{placeholder:"Select people...",filterPlaceholder:"Search...",emptyResultText:"No result",values:m,items:_e,onValueChange:b,style:Fe.select,...i})},L=()=>e.jsxs(ce,{title:"MultiSelect variations",children:[e.jsx(C,{title:"Default",children:e.jsx(q,{})}),e.jsx(C,{title:"Without groups",children:e.jsx(q,{enableGroups:!1})}),e.jsx(C,{title:"Disabled",children:e.jsx(q,{disabled:!0})}),e.jsx(C,{title:"Disabled with a value",children:e.jsx(q,{disabled:!0,initialValues:["charlotte"]})}),e.jsx(C,{title:"Without any option",children:e.jsx(q,{items:[]})})]}),E=()=>e.jsx(ce,{title:"MultiSelect colors",children:Object.keys(a).map(s=>e.jsx(C,{title:s,children:e.jsx(q,{color:s})},s))});L.__docgenInfo={description:"",methods:[],displayName:"Variations"};E.__docgenInfo={description:"",methods:[],displayName:"Colors"};var ne,oe,se;L.parameters={...L.parameters,docs:{...(ne=L.parameters)==null?void 0:ne.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect variations">
      <StoryPart title="Default">
        <EditableMultiSelect />
      </StoryPart>

      <StoryPart title="Without groups">
        <EditableMultiSelect enableGroups={false} />
      </StoryPart>

      <StoryPart title="Disabled">
        <EditableMultiSelect disabled={true} />
      </StoryPart>

      <StoryPart title="Disabled with a value">
        <EditableMultiSelect disabled={true} initialValues={["charlotte"]} />
      </StoryPart>

      <StoryPart title="Without any option">
        <EditableMultiSelect items={[]} />
      </StoryPart>
    </StoryBlock>;
}`,...(se=(oe=L.parameters)==null?void 0:oe.docs)==null?void 0:se.source}}};var le,ie,ue;E.parameters={...E.parameters,docs:{...(le=E.parameters)==null?void 0:le.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect colors">
      {Object.keys(colors).map(color => <StoryPart key={color} title={color}>
          <EditableMultiSelect color={color as ColorVariants} />
        </StoryPart>)}
    </StoryBlock>;
}`,...(ue=(ie=E.parameters)==null?void 0:ie.docs)==null?void 0:ue.source}}};const mt=["Variations","Colors"];export{E as Colors,L as Variations,mt as __namedExportsOrder,dt as default};
//# sourceMappingURL=MultiSelect.stories-CkyJDbyj.js.map
