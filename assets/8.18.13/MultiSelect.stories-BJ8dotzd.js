import{s as U,j as e,n as he,V as K,t as E,d as Z,c as s,r as be,k as ee,i as A,G as xe,X as Se,e as te,B as _,I as D,l as je,S as B,T as G}from"./ScrollView-DWjQ00nM.js";import{r as o}from"./index-Cs7sjTYM.js";import{u as Te}from"./useBoolean-DHW5baxv.js";import{u as we}from"./useDisclosure-DLkMFUa4.js";import{g as ve}from"./array-BfAlyugE.js";import{s as Ce}from"./string-CooJ28LA.js";import{P as Ie,F as ke}from"./Popover-CdPSbsOC.js";import{I as Pe}from"./InputError-BsC90isV.js";import{T as Le,a as Me}from"./Pressable-CMe_F2_9.js";import{T as re}from"./Tag-CN2d3BfY.js";import{M as $}from"./index-CCMTQrND.js";import{S as ue,a as k}from"./_StoriesComponents-_jmnnGUR.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BU4L-DQy.js";import"./useResponsive-CzIqCC5v.js";import"./function-c-Au7wom.js";import"./BottomPanel-DIUwAyP4.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-DMoYUPTW.js";import"./FocusTrap-BmeT9-In.js";import"./Suspendable-Di1_g3U1.js";import"./index-BJ6ZNIxC.js";import"./extends-CF3RwP-h.js";import"./TransitionView-cETjUupd.js";const Ee=U.create({scrollTracker:{position:"absolute",pointerEvents:"none",right:0,bottom:0}}),Ve=({ItemSeparatorComponent:n,ListEmptyComponent:i,ListFooterComponent:m,ListHeaderComponent:b,contentContainerStyle:w,horizontal:c=!1,keyExtractor:u,onEndReached:d,onEndReachedThresholdPx:x=200,onKeyDown:v,onScroll:S,renderItem:l,renderSectionHeader:p,role:f,scrollEventThrottle:N=16,sections:C,showsScrollIndicators:L=!0,style:I},M)=>{const R=o.useId(),y=o.useRef(null),H=c?{top:0,width:x}:{left:0,height:x};return o.useEffect(()=>{const g=y.current;if(g!=null){const j=new IntersectionObserver(T=>{T.forEach(F=>{F.isIntersecting&&(d==null||d())})});return j.observe(g),()=>{j.unobserve(g)}}},[C.length]),e.jsxs(he,{contentContainerStyle:w,horizontal:c,onKeyDown:v,onScroll:S,ref:M,role:f,scrollEventThrottle:N,showsScrollIndicators:L,style:I,children:[b,C.length<=0?i:C.map(g=>e.jsxs(o.Fragment,{children:[p==null?void 0:p(g),g.data.map((j,T)=>e.jsxs(o.Fragment,{children:[T!==0&&n,l({item:j,index:T})]},u(j,T)))]},`group-${R}-${g.title}`)),m,e.jsx(K,{role:"none",ref:y,style:[Ee.scrollTracker,H]})]})},de=o.forwardRef(Ve);de.__docgenInfo={description:"",methods:[],displayName:"SectionList",props:{ItemSeparatorComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListEmptyComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListHeaderComponent:{required:!1,tsType:{name:"ReactNode"},description:""},contentContainerStyle:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},horizontal:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: T, index: number) => string",signature:{arguments:[{type:{name:"T"},name:"item"},{type:{name:"number"},name:"index"}],return:{name:"string"}}},description:""},onEndReached:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEndReachedThresholdPx:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"200",computed:!1}},onKeyDown:{required:!1,tsType:{name:'intersection["onKeyDown"]',raw:'ScrollViewProps["onKeyDown"]'},description:""},onScroll:{required:!1,tsType:{name:'intersection["onScroll"]',raw:'ScrollViewProps["onScroll"]'},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(info: ListRenderItemInfo<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  item: T;
  index: number;
}`,signature:{properties:[{key:"item",value:{name:"T",required:!0}},{key:"index",value:{name:"number",required:!0}}]}},name:"info"}],return:{name:"ReactNode"}}},description:""},renderSectionHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(section: Section<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}},name:"section"}],return:{name:"ReactNode"}}},description:""},role:{required:!1,tsType:{name:"WebRole"},description:""},scrollEventThrottle:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"16",computed:!1}},sections:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}}],raw:"Section<T>[]"},description:""},showsScrollIndicators:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""}}};const qe=120,Ne=32,Re=10.5,a=U.create({base:{...E.regular,backgroundColor:Z.accented,borderColor:s.gray[100],borderRadius:be[6],borderWidth:1,cursor:"default",overflow:"hidden",transitionDuration:"150ms",transitionProperty:"border-color, box-shadow"},errored:{borderColor:s.negative[500]},tag:{marginRight:4,marginVertical:2},hovered:{boxShadow:ee.tile},focused:{borderColor:s.gray[500],boxShadow:ee.tile,outlineStyle:"none"},disabled:{backgroundColor:s.gray[50],borderColor:s.gray[100],cursor:"not-allowed"},actions:{marginVertical:"auto",position:"absolute",bottom:0,top:0,right:20},placeholder:{...E.regular,color:s.gray[300],userSelect:"none"},list:{marginVertical:4,maxHeight:Ne*Re,minHeight:224},filterContainer:{flexGrow:1,flexShrink:1,margin:16},filterInput:{...E.regular,backgroundColor:Z.accented,borderColor:s.gray[100],borderRadius:4,borderWidth:1,flexGrow:1,flexShrink:1,height:40,outlineStyle:"none",paddingHorizontal:12,paddingLeft:40,placeholderTextColor:s.gray[300]},filterFocused:{borderColor:s.gray[200]},searchIcon:{position:"absolute",left:14},tagsList:{flexWrap:"wrap",maxHeight:qe,minHeight:40,overflowY:"auto",paddingHorizontal:16,paddingRight:60,paddingVertical:8},groupTitleBase:{alignItems:"center",flexDirection:"row",flexGrow:1,flexShrink:1,justifyContent:"space-between",paddingHorizontal:16,paddingVertical:12,transitionDuration:"200ms",transitionProperty:"background-color"},groupTitle:{...E.semibold,userSelect:"none"},line:{...E.regular,paddingHorizontal:16,paddingVertical:8,transitionDuration:"200ms",transitionProperty:"background-color",userSelect:"none"},lineInGroup:{paddingLeft:24},emptyList:{height:136},emptyListText:{color:s.gray.primary}}),X=o.memo(({color:n="gray",disabled:i=!1,emptyResultText:m,enableGroups:b=!0,filterPlaceholder:w,items:c,onValueChange:u,placeholder:d,renderTagGroup:x,error:v,style:S,values:l,id:p})=>{const[f,N]=o.useState(""),[C,L]=Te(!1),I=o.useRef(!1),M=o.useRef(null),R=o.useRef(null),[y,{open:H,close:g}]=we(!1),j=s[n][50],T=s[n][100];o.useEffect(()=>{y||N("")},[y]),o.useEffect(()=>{var t,r;if(I.current){const h=(t=M.current)==null?void 0:t.scrollHeight;(r=M.current)==null||r.scrollTo({top:h})}I.current=!1},[l]);const F=t=>{I.current=!0,u([...l,t.value])},me=t=>{u(l.filter(r=>r!==t.value))},pe=()=>{u([])},fe=t=>{I.current=!0;const r=t.map(z=>z.value),h=[...new Set([...l,...r])];u(h)},Y=o.useMemo(()=>c.reduce((t,r)=>(t[r.value]=r,t),{}),[c]),W=o.useMemo(()=>l.map(t=>Y[t]).filter(A),[l,Y]),O=o.useMemo(()=>{const t=c.filter(h=>!l.includes(h.value)),r=f.trim().toLowerCase();return r===""?t:t.filter(({label:h})=>h.toLowerCase().includes(r))},[f,c,l]),ye=o.useMemo(()=>xe.filterMap(Se.entries(ve(O,({group:t})=>t)),([t,r])=>r===void 0?te.None():te.Some({title:t,data:r})),[O]),J=o.useMemo(()=>e.jsxs(_,{direction:"row",alignItems:"center",style:a.filterContainer,children:[e.jsx(Le,{autoComplete:"off",inputMode:"search",multiline:!1,rows:1,onChangeText:t=>N(t),placeholder:w,value:f,onFocus:L.on,onBlur:L.off,style:[a.filterInput,C&&a.filterFocused]}),e.jsx(D,{name:"search-filled",color:s[n].primary,size:20,style:a.searchIcon})]}),[f,C,L,w,n]),Q=o.useMemo(()=>e.jsxs(_,{justifyContent:"center",alignItems:"center",style:a.emptyList,children:[e.jsx(D,{name:"clipboard-search-regular",size:24,color:s.gray.primary}),je(m)&&e.jsxs(e.Fragment,{children:[e.jsx(B,{height:8}),e.jsx(G,{style:a.emptyListText,children:m})]})]}),[m]);return e.jsxs(K,{style:S,children:[e.jsxs($,{id:p,ref:R,"aria-haspopup":"listbox",role:"button","aria-expanded":y,disabled:i,onPress:H,style:({hovered:t,focused:r})=>[a.base,t&&a.hovered,(r||y)&&a.focused,i&&a.disabled,A(v)&&a.errored],children:[e.jsx(_,{ref:M,alignItems:"center",direction:"row",style:a.tagsList,children:W.length>0?W.map(t=>e.jsx(re,{color:n,onPressRemove:i?void 0:()=>me(t),style:a.tag,children:t.label},t.value)):d!==""?e.jsx(G,{role:"label",numberOfLines:1,style:a.placeholder,children:d}):null}),e.jsxs(_,{direction:"row",alignItems:"center",style:a.actions,children:[W.length>=1&&!i&&e.jsxs(e.Fragment,{children:[e.jsx($,{role:"button",onPress:pe,children:e.jsx(D,{name:"dismiss-filled",color:s.gray.primary,size:15})}),e.jsx(B,{width:8})]}),e.jsx(D,{color:s.gray.primary,name:y?"chevron-up-filled":"chevron-down-filled",size:20})]})]}),e.jsx(Ie,{role:"listbox",matchReferenceWidth:!0,onDismiss:g,referenceRef:R,returnFocus:!0,visible:y,children:e.jsx(K,{style:a.list,children:b?e.jsx(de,{role:"listbox","aria-multiselectable":!0,keyExtractor:(t,r)=>`group-field-${t.value}-${r}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(B,{height:16}),sections:ye,renderSectionHeader:({title:t,data:r})=>e.jsxs($,{role:"listitem",onPress:()=>fe(r),style:({hovered:h,pressed:z,focused:ge})=>[a.groupTitleBase,(h||ge)&&{backgroundColor:j},z&&{backgroundColor:T}],children:[e.jsx(G,{numberOfLines:1,style:a.groupTitle,children:t}),A(x)&&e.jsx(re,{color:n,children:x(r)})]}),renderItem:({item:t})=>e.jsx(oe,{color:n,filter:f,item:t,handleSelectItem:F,style:a.lineInGroup})}):e.jsx(ke,{role:"list",data:O,keyExtractor:t=>`field-${t.value}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(B,{height:8}),renderItem:({item:t})=>e.jsx(oe,{color:n,filter:f,item:t,handleSelectItem:F})})})}),e.jsx(Pe,{message:v})]})}),oe=({item:n,color:i,filter:m,handleSelectItem:b,style:w})=>{const{label:c,disabled:u=!1}=n,d=m.trim().toLowerCase(),x=s[i][50],v=s[i][100],S=o.useMemo(()=>u||d===""?c:Ce(c,d),[c,u,d]);return e.jsx(Me,{role:"listitem",disabled:u,numberOfLines:1,onPress:()=>b(n),style:({hovered:l,pressed:p})=>[a.line,w,l&&{backgroundColor:x},p&&{backgroundColor:v},u&&{backgroundColor:s.gray[50],color:s.gray[100]}],children:typeof S=="string"?S:S.map((l,p)=>l.toLowerCase()===d?e.jsx(G,{style:{color:i},children:l},p):l)})};X.__docgenInfo={description:"",methods:[],displayName:"MultiSelect",props:{color:{defaultValue:{value:'"gray"',computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1},enableGroups:{defaultValue:{value:"true",computed:!1},required:!1}}};const Fe=U.create({select:{maxWidth:400}}),it={title:"Forms/MultiSelect",component:X},_e=[{label:"Camille",value:"camille",group:"C"},{label:"Charlotte",value:"charlotte",group:"C"},{label:"Francis",value:"francis",group:"F"},{label:"Émilie",value:"emilie",group:"E"},{label:"François",value:"francois",group:"F"},{label:"Laura",value:"laura",group:"L"},{label:"Marie-Anne",value:"marie_anne",group:"M"},{label:"Natasha",value:"natasha",group:"N",disabled:!0},{label:"Nicolas",value:"nicolas",group:"N"},{label:"Pierre",value:"pierre",group:"P"}],P=({initialValues:n=[],...i})=>{const[m,b]=o.useState(n);return e.jsx(X,{placeholder:"Select people...",filterPlaceholder:"Search...",emptyResultText:"No result",values:m,items:_e,onValueChange:b,style:Fe.select,...i})},V=()=>e.jsxs(ue,{title:"MultiSelect variations",children:[e.jsx(k,{title:"Default",children:e.jsx(P,{})}),e.jsx(k,{title:"Without groups",children:e.jsx(P,{enableGroups:!1})}),e.jsx(k,{title:"Disabled",children:e.jsx(P,{disabled:!0})}),e.jsx(k,{title:"Disabled with a value",children:e.jsx(P,{disabled:!0,initialValues:["charlotte"]})}),e.jsx(k,{title:"Without any option",children:e.jsx(P,{items:[]})})]}),q=()=>e.jsx(ue,{title:"MultiSelect colors",children:Object.keys(s).map(n=>e.jsx(k,{title:n,children:e.jsx(P,{color:n})},n))});V.__docgenInfo={description:"",methods:[],displayName:"Variations"};q.__docgenInfo={description:"",methods:[],displayName:"Colors"};var se,ae,ne;V.parameters={...V.parameters,docs:{...(se=V.parameters)==null?void 0:se.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect variations">
      <StoryPart title="Default">
        <EditableMultiSelect />
      </StoryPart>

      <StoryPart title="Without groups">
        <EditableMultiSelect enableGroups={false} />
      </StoryPart>

      <StoryPart title="Disabled">
        <EditableMultiSelect disabled={true} />
      </StoryPart>

      <StoryPart title="Disabled with a value">
        <EditableMultiSelect disabled={true} initialValues={["charlotte"]} />
      </StoryPart>

      <StoryPart title="Without any option">
        <EditableMultiSelect items={[]} />
      </StoryPart>
    </StoryBlock>;
}`,...(ne=(ae=V.parameters)==null?void 0:ae.docs)==null?void 0:ne.source}}};var le,ie,ce;q.parameters={...q.parameters,docs:{...(le=q.parameters)==null?void 0:le.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect colors">
      {Object.keys(colors).map(color => <StoryPart key={color} title={color}>
          <EditableMultiSelect color={(color as ColorVariants)} />
        </StoryPart>)}
    </StoryBlock>;
}`,...(ce=(ie=q.parameters)==null?void 0:ie.docs)==null?void 0:ce.source}}};const ct=["Variations","Colors"];export{q as Colors,V as Variations,ct as __namedExportsOrder,it as default};
//# sourceMappingURL=MultiSelect.stories-BJ8dotzd.js.map
