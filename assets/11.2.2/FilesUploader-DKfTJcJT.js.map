{"version":3,"file":"FilesUploader-DKfTJcJT.js","sources":["../../../packages/shared-business/src/hooks/useFilesUploader.ts","../../../packages/shared-business/src/components/FileTile.tsx","../../../packages/shared-business/src/components/FilesUploader.tsx"],"sourcesContent":["import { Future, Result } from \"@swan-io/boxed\";\nimport { useCallback, useState } from \"react\";\nimport { SwanFile } from \"../utils/SwanFile\";\n\nexport type UploadFileInput<UploadOutput> = {\n  id: string;\n  upload: UploadOutput;\n  file: File;\n  onLoadStart: (event: ProgressEvent<XMLHttpRequestEventTarget>) => void;\n  onProgress: (event: ProgressEvent<XMLHttpRequestEventTarget>) => void;\n};\n\nexport type UploadOutputWithId<UploadOutput> = { id: string; upload: UploadOutput };\n\nexport type Config<UploadInput, UploadOutput, GenerateUploadError, UploadFileError> = {\n  initialFiles: SwanFile[];\n  // Takes a configuration and outputs the needed input for the actual upload\n  // It also provides an ID that's required to keep track of the file\n  generateUpload: (\n    config: UploadInput,\n  ) => Future<Result<UploadOutputWithId<UploadOutput>, GenerateUploadError>>;\n  // Effectively uploads the file\n  uploadFile: (config: UploadFileInput<UploadOutput>) => Future<Result<unknown, UploadFileError>>;\n  onError?: (error: GenerateUploadError | UploadFileError) => void;\n};\n\nexport const useFilesUploader = <UploadInput, UploadOutput, GenerateUploadError, UploadFileError>(\n  config: Config<UploadInput, UploadOutput, GenerateUploadError, UploadFileError>,\n) => {\n  const [files, setFiles] = useState(config.initialFiles);\n\n  const add = useCallback((fileToAdd: SwanFile) => {\n    setFiles(files => {\n      if (files.some(item => item.id === fileToAdd.id)) {\n        return files.map(item => (item.id === fileToAdd.id ? fileToAdd : item));\n      } else {\n        return [...files, fileToAdd];\n      }\n    });\n  }, []);\n\n  const upload = useCallback(\n    (uploadInput: UploadInput, file: File) => {\n      return config\n        .generateUpload(uploadInput)\n        .tapError(error => {\n          if (config.onError != undefined) {\n            config.onError(error);\n          }\n        })\n        .flatMapOk(({ upload, id }) => {\n          setFiles(files => [\n            ...files.filter(file => file.id !== id),\n            {\n              id,\n              statusInfo: { status: \"Uploading\", progress: 0 },\n              name: file.name,\n            },\n          ]);\n\n          const onProgress = (event: ProgressEvent<XMLHttpRequestEventTarget>) => {\n            setFiles(files =>\n              files.map(file => {\n                if (file.id !== id) {\n                  return file;\n                }\n                return {\n                  ...file,\n                  statusInfo: { status: \"Uploading\", progress: event.loaded / event.total },\n                };\n              }),\n            );\n          };\n\n          return config\n            .uploadFile({\n              id,\n              upload,\n              file,\n              onLoadStart: onProgress,\n              onProgress,\n            })\n            .tapOk(() => {\n              setFiles(files =>\n                files.map(file => {\n                  if (file.id !== id) {\n                    return file;\n                  }\n                  return {\n                    ...file,\n                    statusInfo: { status: \"Uploaded\" },\n                  };\n                }),\n              );\n            })\n            .tapError(error => {\n              if (config.onError != undefined) {\n                config.onError(error);\n              }\n              setFiles(files => files.filter(file => file.id !== id));\n            });\n        });\n    },\n    [config],\n  );\n\n  const remove = useCallback((id: string) => {\n    setFiles(files => files.filter(file => file.id !== id));\n  }, []);\n\n  return {\n    files,\n    upload,\n    remove,\n    add,\n  };\n};\n","import { Future } from \"@swan-io/boxed\";\nimport { Box } from \"@swan-io/lake/src/components/Box\";\nimport { Icon } from \"@swan-io/lake/src/components/Icon\";\nimport { LakeAlert } from \"@swan-io/lake/src/components/LakeAlert\";\nimport { LakeButton, LakeButtonGroup } from \"@swan-io/lake/src/components/LakeButton\";\nimport { LakeText } from \"@swan-io/lake/src/components/LakeText\";\nimport { LakeTooltip } from \"@swan-io/lake/src/components/LakeTooltip\";\nimport { Pressable } from \"@swan-io/lake/src/components/Pressable\";\nimport { Space } from \"@swan-io/lake/src/components/Space\";\nimport { Tag } from \"@swan-io/lake/src/components/Tag\";\nimport { commonStyles } from \"@swan-io/lake/src/constants/commonStyles\";\nimport { backgroundColor, colors, gray75, spacings } from \"@swan-io/lake/src/constants/design\";\nimport { setClipboardText } from \"@swan-io/lake/src/utils/clipboard\";\nimport { getIconNameFromFilename } from \"@swan-io/lake/src/utils/file\";\nimport { isNotNullish, isNotNullishOrEmpty } from \"@swan-io/lake/src/utils/nullish\";\nimport { useCallback, useState } from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { P, match } from \"ts-pattern\";\nimport { SwanFile } from \"../utils/SwanFile\";\nimport { t } from \"../utils/i18n\";\nimport { LakeModal } from \"./LakeModal\";\n\nconst styles = StyleSheet.create({\n  base: {\n    backgroundColor: backgroundColor.accented,\n    borderRadius: 8,\n    borderWidth: 1,\n    overflow: \"hidden\",\n  },\n  content: {\n    height: 56,\n    paddingLeft: spacings[20],\n    paddingRight: spacings[8],\n  },\n  progressBar: {\n    flex: 1,\n    height: 4,\n    borderRadius: 2,\n    backgroundColor: gray75,\n  },\n  progress: {\n    height: 4,\n    transitionProperty: \"width\",\n    transitionDuration: \"300ms\",\n    transitionTimingFunction: \"ease-in-out\",\n    borderRadius: 2,\n    backgroundColor: colors.current[500],\n  },\n  id: {\n    alignSelf: \"flex-start\",\n  },\n});\n\ntype Props = {\n  file: SwanFile;\n  showId?: boolean;\n  onRemove?: () => Future<unknown>;\n};\n\nexport const FileTile = ({\n  file: { id, statusInfo, name, url },\n  showId = false,\n  onRemove,\n}: Props) => {\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [isDeleteModalVisible, setIsDeleteModalVisible] = useState(false);\n\n  const onPressRemove = useCallback(() => {\n    if (onRemove != undefined) {\n      setIsDeleting(true);\n      onRemove().tap(() => {\n        setIsDeleting(false);\n        setIsDeleteModalVisible(false);\n      });\n    }\n  }, [onRemove]);\n\n  const [visibleState, setVisibleState] = useState<\"copy\" | \"copied\">(\"copy\");\n\n  return (\n    <Box\n      style={[\n        styles.base,\n        {\n          borderColor: match(statusInfo.status)\n            .with(\"Uploaded\", \"Uploading\", () => colors.gray[100])\n            .with(\"Pending\", () => colors.shakespear[100])\n            .with(\"Validated\", () => colors.positive[500])\n            .with(\"Refused\", () => colors.negative[100])\n            .exhaustive(),\n        },\n      ]}\n    >\n      <Box alignItems=\"center\" direction=\"row\" style={styles.content}>\n        {statusInfo.status === \"Uploading\" ? (\n          <>\n            <LakeText numberOfLines={1} color={colors.gray[700]}>\n              {t(\"fileTile.uploading\")}\n            </LakeText>\n\n            <Space width={20} />\n\n            <View role=\"progressbar\" style={styles.progressBar}>\n              <View style={[styles.progress, { width: `${statusInfo.progress * 100}%` }]} />\n            </View>\n          </>\n        ) : (\n          <>\n            {statusInfo.status === \"Validated\" ? (\n              <Icon size={24} color={colors.positive[500]} name=\"checkmark-circle-regular\" />\n            ) : (\n              <Tag\n                icon={getIconNameFromFilename(name)}\n                iconSize={20}\n                color={match(statusInfo)\n                  .with({ status: P.union(\"Uploaded\", \"Pending\") }, () => \"shakespear\" as const)\n                  .with({ status: \"Refused\" }, () => \"negative\" as const)\n                  .exhaustive()}\n              />\n            )}\n\n            <Space width={16} />\n\n            <Box grow={1}>\n              <LakeText numberOfLines={1} color={colors.gray[700]} style={commonStyles.fill}>\n                {name}\n              </LakeText>\n\n              {showId ? (\n                <View style={styles.id}>\n                  <LakeTooltip\n                    describedBy=\"copy\"\n                    onHide={() => setVisibleState(\"copy\")}\n                    togglableOnFocus={true}\n                    content={\n                      visibleState === \"copy\"\n                        ? t(\"copyButton.copyTooltip\")\n                        : t(\"copyButton.copiedTooltip\")\n                    }\n                  >\n                    <Pressable\n                      onPress={event => {\n                        event.stopPropagation();\n                        event.preventDefault();\n                        setClipboardText(id);\n                        setVisibleState(\"copied\");\n                      }}\n                    >\n                      <Box direction=\"row\" alignItems=\"center\">\n                        <LakeText numberOfLines={1} variant=\"smallRegular\">\n                          {t(\"fileTile.id\", { id })}\n                        </LakeText>\n\n                        <Space width={4} />\n                        <Icon size={14} name=\"copy-regular\" />\n                      </Box>\n                    </Pressable>\n                  </LakeTooltip>\n                </View>\n              ) : null}\n            </Box>\n\n            <Space width={12} />\n\n            {isNotNullishOrEmpty(url) && (\n              <LakeButton\n                mode=\"tertiary\"\n                size=\"small\"\n                icon=\"open-filled\"\n                onPress={() => {\n                  window.open(url, \"_blank\");\n                }}\n                ariaLabel={t(\"common.open\")}\n              />\n            )}\n\n            {isNotNullish(onRemove) && (\n              <LakeButton\n                mode=\"tertiary\"\n                size=\"small\"\n                icon=\"delete-regular\"\n                color=\"negative\"\n                onPress={() => setIsDeleteModalVisible(true)}\n                ariaLabel={t(\"common.remove\")}\n              />\n            )}\n\n            <LakeModal\n              title={t(\"fileTile.deleteModal.title\")}\n              icon=\"subtract-circle-regular\"\n              visible={isDeleteModalVisible}\n              onPressClose={() => setIsDeleteModalVisible(false)}\n              color=\"negative\"\n            >\n              <LakeButtonGroup paddingBottom={0}>\n                <LakeButton\n                  loading={isDeleting}\n                  grow={true}\n                  color=\"negative\"\n                  onPress={onPressRemove}\n                >\n                  {t(\"fileTile.deleteModal.delete\")}\n                </LakeButton>\n              </LakeButtonGroup>\n            </LakeModal>\n          </>\n        )}\n      </Box>\n\n      {match(statusInfo)\n        .with({ status: \"Pending\" }, () => (\n          <LakeAlert anchored={true} title={t(\"fileTile.status.Pending\")} variant=\"info\" />\n        ))\n        .with({ status: \"Refused\" }, ({ reason, reasonCode }) => (\n          <LakeAlert anchored={true} title={t(\"fileTile.status.Refused\")} variant=\"error\">\n            <Box direction=\"column\">\n              <LakeText>\n                {match(reasonCode)\n                  .with(\"BadDocumentQuality\", () =>\n                    t(\"supportingDocuments.rejectionReason.BadDocumentQuality\"),\n                  )\n                  .with(\"CompanyNameMismatch\", () =>\n                    t(\"supportingDocuments.rejectionReason.CompanyNameMismatch\"),\n                  )\n                  .with(\"DeclaredAmountMismatch\", () =>\n                    t(\"supportingDocuments.rejectionReason.DeclaredAmountMismatch\"),\n                  )\n                  .with(\"ExpiredDocument\", () =>\n                    t(\"supportingDocuments.rejectionReason.ExpiredDocument\"),\n                  )\n                  .with(\"FullDocumentRequired\", () =>\n                    t(\"supportingDocuments.rejectionReason.FullDocumentRequired\"),\n                  )\n                  .with(\"IbanMismatch\", () => t(\"supportingDocuments.rejectionReason.IbanMismatch\"))\n                  .with(\"InvalidAddress\", () =>\n                    t(\"supportingDocuments.rejectionReason.InvalidAddress\"),\n                  )\n                  .with(\"InvalidDocument\", () =>\n                    t(\"supportingDocuments.rejectionReason.InvalidDocument\"),\n                  )\n                  .with(\"InvalidOrMissingData\", () =>\n                    t(\"supportingDocuments.rejectionReason.InvalidOrMissingData\"),\n                  )\n                  .with(\"InvalidTransaction\", () =>\n                    t(\"supportingDocuments.rejectionReason.InvalidTransaction\"),\n                  )\n                  .with(\"HandwrittenOrCertifiedElectronicSignatureRequired\", () =>\n                    t(\n                      \"supportingDocuments.rejectionReason.HandwrittenOrCertifiedElectronicSignatureRequired\",\n                    ),\n                  )\n                  .with(\"MissingAccommodationProviderId\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingAccommodationProviderId\"),\n                  )\n                  .with(\"MissingAccommodationProviderIdLetter\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingAccommodationProviderIdLetter\"),\n                  )\n                  .with(\"MissingAccommodationProviderLetter\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingAccommodationProviderLetter\"),\n                  )\n                  .with(\"MissingCompanyDomiciliationStatement\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingCompanyDomiciliationStatement\"),\n                  )\n                  .with(\"MissingProviderProofOfAddress\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingProviderProofOfAddress\"),\n                  )\n                  .with(\"MissingProviderProofOfAddressAndIdDocument\", () =>\n                    t(\n                      \"supportingDocuments.rejectionReason.MissingProviderProofOfAddressAndIdDocument\",\n                    ),\n                  )\n                  .with(\"MissingDescription\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingDescription\"),\n                  )\n                  .with(\"MissingSignature\", () =>\n                    t(\"supportingDocuments.rejectionReason.MissingSignature\"),\n                  )\n                  .with(\"PowerOfAttorneyToSwanRequired\", () =>\n                    t(\"supportingDocuments.rejectionReason.PowerOfAttorneyToSwanRequired\"),\n                  )\n                  .with(\"ProviderColorIdDocumentRequired\", () =>\n                    t(\"supportingDocuments.rejectionReason.ProviderColorIdDocumentRequired\"),\n                  )\n                  .with(\"TransactionAmountMismatch\", () =>\n                    t(\"supportingDocuments.rejectionReason.TransactionAmountMismatch\"),\n                  )\n                  .with(\"TransactionDateMismatch\", () =>\n                    t(\"supportingDocuments.rejectionReason.TransactionDateMismatch\"),\n                  )\n                  .with(\"TransactionNameMismatch\", () =>\n                    t(\"supportingDocuments.rejectionReason.TransactionNameMismatch\"),\n                  )\n                  .with(\"UnacceptableDocument\", () =>\n                    t(\"supportingDocuments.rejectionReason.UnacceptableDocument\"),\n                  )\n                  .with(\"other\", () => null)\n                  .otherwise(reasonCode => reasonCode)}\n              </LakeText>\n\n              <LakeText>{reason}</LakeText>\n            </Box>\n          </LakeAlert>\n        ))\n        .otherwise(() => null)}\n    </Box>\n  );\n};\n","import { Future, Result } from \"@swan-io/boxed\";\nimport { Box } from \"@swan-io/lake/src/components/Box\";\nimport { IconName } from \"@swan-io/lake/src/components/Icon\";\nimport { Space } from \"@swan-io/lake/src/components/Space\";\nimport {\n  ForwardedRef,\n  Fragment,\n  Ref,\n  forwardRef,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n} from \"react\";\nimport { Config, useFilesUploader } from \"../hooks/useFilesUploader\";\nimport { SwanFile } from \"../utils/SwanFile\";\nimport { FileInput } from \"./FileInput\";\nimport { FileTile } from \"./FileTile\";\n\ntype Props<UploadInput, UploadOutput, GenerateUploadError, UploadFileError> = Config<\n  UploadInput,\n  UploadOutput,\n  GenerateUploadError,\n  UploadFileError\n> & {\n  getUploadConfig: (file: File) => UploadInput;\n  accept: string[];\n  maxSize: number;\n  icon: IconName;\n  formatAndSizeDescription?: string;\n  onRemoveFile?: (file: SwanFile) => Future<Result<unknown, unknown>>;\n  onChange?: (files: SwanFile[]) => void;\n  canUpload?: boolean;\n  showIds?: boolean;\n};\n\nexport type FilesUploaderRef = {\n  add: (file: SwanFile) => void;\n};\n\nconst FilesUploaderWithRef = <UploadInput, UploadOutput, GenerateUploadError, UploadFileError>(\n  {\n    maxSize,\n    accept,\n    icon,\n    getUploadConfig,\n    onRemoveFile,\n    onChange,\n    formatAndSizeDescription,\n    canUpload = true,\n    showIds = false,\n    ...config\n  }: Props<UploadInput, UploadOutput, GenerateUploadError, UploadFileError>,\n  ref: Ref<FilesUploaderRef>,\n) => {\n  const { files, upload, remove, add } = useFilesUploader(config);\n\n  // Keep the `onChange` callback as a ref to avoid running the effect\n  // every time the function updates\n  const onChangeRef = useRef(onChange);\n  onChangeRef.current = onChange;\n  const isFirstRender = useRef(true);\n\n  useImperativeHandle(ref, () => ({\n    add,\n  }));\n\n  useEffect(() => {\n    // Avoid calling `onChange` on first render\n    if (isFirstRender.current) {\n      isFirstRender.current = false;\n      return;\n    }\n    const onChange = onChangeRef.current;\n    if (onChange != undefined) {\n      onChange(files);\n    }\n  }, [files]);\n\n  return (\n    <Box>\n      {canUpload ? (\n        <>\n          <FileInput\n            layout=\"horizontal\"\n            onFiles={files => {\n              files.forEach(file => {\n                upload(getUploadConfig(file), file);\n              });\n            }}\n            accept={accept}\n            icon={icon}\n            description={formatAndSizeDescription}\n            maxSize={maxSize}\n          />\n\n          <Space height={12} />\n        </>\n      ) : null}\n\n      {files.map((file, index) => (\n        <Fragment key={file.id}>\n          {index > 0 ? <Space height={12} /> : null}\n\n          <FileTile\n            file={file}\n            showId={showIds}\n            onRemove={\n              onRemoveFile != undefined && file.statusInfo.status === \"Uploaded\"\n                ? () =>\n                    onRemoveFile(file).tapOk(() => {\n                      remove(file.id);\n                    })\n                : undefined\n            }\n          />\n        </Fragment>\n      ))}\n    </Box>\n  );\n};\n\nexport const FilesUploader = forwardRef(FilesUploaderWithRef) as <\n  UploadInput,\n  UploadOutput,\n  GenerateUploadError,\n  UploadFileError,\n>(\n  props: Props<UploadInput, UploadOutput, GenerateUploadError, UploadFileError> & {\n    ref?: ForwardedRef<FilesUploaderRef>;\n  },\n) => ReturnType<typeof FilesUploaderWithRef>;\n"],"names":["useFilesUploader","config","files","setFiles","useState","add","useCallback","fileToAdd","item","upload","uploadInput","file","error","id","onProgress","event","remove","styles","StyleSheet","backgroundColor","spacings","gray75","colors","FileTile","statusInfo","name","url","showId","onRemove","isDeleting","setIsDeleting","isDeleteModalVisible","setIsDeleteModalVisible","onPressRemove","visibleState","setVisibleState","jsxs","Box","match","jsx","Fragment","LakeText","Space","View","Icon","Tag","getIconNameFromFilename","P","commonStyles","LakeTooltip","Pressable","setClipboardText","isNotNullishOrEmpty","LakeButton","isNotNullish","LakeModal","LakeButtonGroup","LakeAlert","reason","reasonCode","FilesUploaderWithRef","maxSize","accept","icon","getUploadConfig","onRemoveFile","onChange","formatAndSizeDescription","canUpload","showIds","ref","onChangeRef","useRef","isFirstRender","useImperativeHandle","useEffect","FileInput","index","FilesUploader","forwardRef"],"mappings":"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"}