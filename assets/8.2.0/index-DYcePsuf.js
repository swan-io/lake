import{_ as m}from"./extends-CCbyfPlC.js";import{Q as P,R as c,_ as F,V as T}from"./Space-BXMyA1ws.js";import{k as w,_ as N,V as O,P as K}from"./index-D1fXScZT.js";import{r as p}from"./index-CBqU2yxZ.js";var W=["ItemSeparatorComponent","SectionSeparatorComponent","renderItem","renderSectionFooter","renderSectionHeader","sections","stickySectionHeadersEnabled"];class j extends p.PureComponent{constructor(){super(...arguments),this._keyExtractor=(e,t)=>{var r=this._subExtractor(t);return r&&r.key||String(t)},this._convertViewable=e=>{var t;P(e.index!=null,"Received a broken ViewToken");var r=this._subExtractor(e.index);if(!r)return null;var a=r.section.keyExtractor,i=this.props.keyExtractor||w,o=a!=null?a(e.item,r.index):i(e.item,(t=r.index)!==null&&t!==void 0?t:0);return c(c({},e),{},{index:r.index,key:o,section:r.section})},this._onViewableItemsChanged=e=>{var t=e.viewableItems,r=e.changed,a=this.props.onViewableItemsChanged;a!=null&&a({viewableItems:t.map(this._convertViewable,this).filter(Boolean),changed:r.map(this._convertViewable,this).filter(Boolean)})},this._renderItem=e=>t=>{var r=t.item,a=t.index,i=this._subExtractor(a);if(!i)return null;var o=i.index;if(o==null){var s=i.section;if(i.header===!0){var l=this.props.renderSectionHeader;return l?l({section:s}):null}else{var d=this.props.renderSectionFooter;return d?d({section:s}):null}}else{var h=i.section.renderItem||this.props.renderItem,u=this._getSeparatorComponent(a,i,e);return P(h,"no renderItem!"),p.createElement(z,{SeparatorComponent:u,LeadingSeparatorComponent:o===0?this.props.SectionSeparatorComponent:void 0,cellKey:i.key,index:o,item:r,leadingItem:i.leadingItem,leadingSection:i.leadingSection,prevCellKey:(this._subExtractor(a-1)||{}).key,setSelfHighlightCallback:this._setUpdateHighlightFor,setSelfUpdatePropsCallback:this._setUpdatePropsFor,updateHighlightFor:this._updateHighlightFor,updatePropsFor:this._updatePropsFor,renderItem:h,section:i.section,trailingItem:i.trailingItem,trailingSection:i.trailingSection,inverted:!!this.props.inverted})}},this._updatePropsFor=(e,t)=>{var r=this._updatePropsMap[e];r!=null&&r(t)},this._updateHighlightFor=(e,t)=>{var r=this._updateHighlightMap[e];r!=null&&r(t)},this._setUpdateHighlightFor=(e,t)=>{t!=null?this._updateHighlightMap[e]=t:delete this._updateHighlightFor[e]},this._setUpdatePropsFor=(e,t)=>{t!=null?this._updatePropsMap[e]=t:delete this._updatePropsMap[e]},this._updateHighlightMap={},this._updatePropsMap={},this._captureRef=e=>{this._listRef=e}}scrollToLocation(e){for(var t=e.itemIndex,r=0;r<e.sectionIndex;r++)t+=this.props.getItemCount(this.props.sections[r].data)+2;var a=e.viewOffset||0;if(this._listRef!=null){if(e.itemIndex>0&&this.props.stickySectionHeadersEnabled){var i=this._listRef.__getFrameMetricsApprox(t-e.itemIndex,this._listRef.props);a+=i.length}var o=c(c({},e),{},{viewOffset:a,index:t});this._listRef.scrollToIndex(o)}}getListRef(){return this._listRef}render(){var e=this.props;e.ItemSeparatorComponent,e.SectionSeparatorComponent,e.renderItem,e.renderSectionFooter,e.renderSectionHeader,e.sections,e.stickySectionHeadersEnabled;for(var t=F(e,W),r=this.props.ListHeaderComponent?1:0,a=this.props.stickySectionHeadersEnabled?[]:void 0,i=0,o=N(this.props.sections),s;!(s=o()).done;){var l=s.value;a!=null&&a.push(i+r),i+=2,i+=this.props.getItemCount(l.data)}var d=this._renderItem(i);return p.createElement(O,m({},t,{keyExtractor:this._keyExtractor,stickyHeaderIndices:a,renderItem:d,data:this.props.sections,getItem:(h,u)=>this._getItem(this.props,h,u),getItemCount:()=>i,onViewableItemsChanged:this.props.onViewableItemsChanged?this._onViewableItemsChanged:void 0,ref:this._captureRef}))}_getItem(e,t,r){if(!t)return null;for(var a=r-1,i=0;i<t.length;i++){var o=t[i],s=o.data,l=e.getItemCount(s);if(a===-1||a===l)return o;if(a<l)return e.getItem(s,a);a-=l+2}return null}_subExtractor(e){for(var t=e,r=this.props,a=r.getItem,i=r.getItemCount,o=r.keyExtractor,s=r.sections,l=0;l<s.length;l++){var d=s[l],h=d.data,u=d.key||String(l);if(t-=1,t>=i(h)+1)t-=i(h)+1;else{if(t===-1)return{section:d,key:u+":header",index:null,header:!0,trailingSection:s[l+1]};if(t===i(h))return{section:d,key:u+":footer",index:null,header:!1,trailingSection:s[l+1]};var g=d.keyExtractor||o||w;return{section:d,key:u+":"+g(a(h,t),t),index:t,leadingItem:a(h,t-1),leadingSection:s[l-1],trailingItem:a(h,t+1),trailingSection:s[l+1]}}}}_getSeparatorComponent(e,t,r){if(t=t||this._subExtractor(e),!t)return null;var a=t.section.ItemSeparatorComponent||this.props.ItemSeparatorComponent,i=this.props.SectionSeparatorComponent,o=e===r-1,s=t.index===this.props.getItemCount(t.section.data)-1;return i&&s?i:a&&!s&&!o?a:null}}function z(n){var e=n.LeadingSeparatorComponent,t=n.SeparatorComponent,r=n.cellKey,a=n.prevCellKey,i=n.setSelfHighlightCallback,o=n.updateHighlightFor,s=n.setSelfUpdatePropsCallback,l=n.updatePropsFor,d=n.item,h=n.index,u=n.section,g=n.inverted,C=p.useState(!1),V=C[0],R=C[1],k=p.useState(!1),$=k[0],f=k[1],b=p.useState({leadingItem:n.leadingItem,leadingSection:n.leadingSection,section:n.section,trailingItem:n.item,trailingSection:n.trailingSection}),S=b[0],M=b[1],E=p.useState({leadingItem:n.item,leadingSection:n.leadingSection,section:n.section,trailingItem:n.trailingItem,trailingSection:n.trailingSection}),H=E[0],v=E[1];p.useEffect(()=>(i(r,f),s(r,v),()=>{s(r,null),i(r,null)}),[r,i,v,s]);var U={highlight:()=>{R(!0),f(!0),a!=null&&o(a,!0)},unhighlight:()=>{R(!1),f(!1),a!=null&&o(a,!1)},updateProps:(y,x)=>{y==="leading"?e!=null?M(c(c({},S),x)):a!=null&&l(a,c(c({},S),x)):y==="trailing"&&t!=null&&v(c(c({},H),x))}},L=n.renderItem({item:d,index:h,section:u,separators:U}),I=e!=null&&p.createElement(e,m({highlighted:V},S)),_=t!=null&&p.createElement(t,m({highlighted:$},H));return I||_?p.createElement(T,null,g===!1?I:_,L,g===!1?_:I):L}var B=["stickySectionHeadersEnabled"];class J extends p.PureComponent{constructor(){super(...arguments),this._captureRef=e=>{this._wrapperListRef=e}}scrollToLocation(e){this._wrapperListRef!=null&&this._wrapperListRef.scrollToLocation(e)}recordInteraction(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();e&&e.recordInteraction()}flashScrollIndicators(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();e&&e.flashScrollIndicators()}getScrollResponder(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();if(e)return e.getScrollResponder()}getScrollableNode(){var e=this._wrapperListRef&&this._wrapperListRef.getListRef();if(e)return e.getScrollableNode()}render(){var e=this.props,t=e.stickySectionHeadersEnabled,r=F(e,B),a=t??K.OS==="ios";return p.createElement(j,m({},r,{stickySectionHeadersEnabled:a,ref:this._captureRef,getItemCount:i=>i.length,getItem:(i,o)=>i[o]}))}}export{J as S};
//# sourceMappingURL=index-DYcePsuf.js.map
