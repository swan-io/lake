import{s as z,c as a,t as h,a as e,L as be,S as P,g as Y,r as Se,l as X,i as F,j as p,I as L,m as ve,F as J,T as _,V as K}from"./Space-Cr8ejQ8c.js";import{r as i}from"./index-CBqU2yxZ.js";import{y as xe,i as Ce,v as Q}from"./Boxed-xcydBHmC.js";import{u as Pe}from"./useDisclosure-CS9t68_Y.js";import{g as Ie}from"./array-rjEBP2Ry.js";import{s as Me}from"./string-DF1vKQT8.js";import{B as T}from"./commonStyles-DId4VXP7.js";import{P as we}from"./Popover-iFRIaIFl.js";import{b as Ve,a as Le}from"./Pressable-Cx43sXP-.js";import{T as Z}from"./Tag-B3DLCZ5G.js";import{P as G}from"./index-Cg8tSjyI.js";import{S as Te}from"./index-Cl7tNRMJ.js";import{F as ke}from"./index-DcDn2-mZ.js";import{S as ne,a as b}from"./_StoriesComponents-rwsxbjnl.js";import"./extends-CCbyfPlC.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BtM5VmRH.js";import"./useResponsive-DXzu4OoK.js";import"./function-8kd1jXRQ.js";import"./BottomPanel-JNgK8jbS.js";import"./useBodyClassName-FAgY5CgW.js";import"./math-CGPZN-U7.js";import"./FocusTrap-DcqpiOWx.js";import"./a11y-DXvpDVrG.js";import"./LoadingView-D1HOg_Nq.js";import"./index-D5AZJu8Z.js";import"./TransitionView-ap0JNWUB.js";import"./index-D6b1_9m0.js";const Ee=z.create({base:{color:a.negative[500],lineHeight:h.h1.lineHeight,minHeight:32,paddingHorizontal:3,paddingVertical:4}}),B=({message:r="",style:s})=>r!==""?e(be,{variant:"smallRegular",style:[Ee.base,s],children:r}):e(P,{height:32});try{B.displayName="InputError",B.__docgenInfo={description:"",displayName:"InputError",props:{message:{defaultValue:{value:""},description:"",name:"message",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"StyleProp<TextStyle>"}}}}}catch{}const _e=120,He=32,Ne=10.5,o=z.create({base:{...h.regular,backgroundColor:Y.accented,borderColor:a.gray[100],borderRadius:Se[6],borderWidth:1,cursor:"default",overflow:"hidden",transitionDuration:"150ms",transitionProperty:"border-color, box-shadow"},errored:{borderColor:a.negative[500]},tag:{marginRight:4,marginVertical:2},hovered:{boxShadow:X.tile},focused:{borderColor:a.gray[500],boxShadow:X.tile,outlineStyle:"none"},disabled:{backgroundColor:a.gray[50],borderColor:a.gray[100],cursor:"not-allowed"},actions:{marginVertical:"auto",position:"absolute",bottom:0,top:0,right:20},placeholder:{...h.regular,color:a.gray[300],userSelect:"none"},list:{marginVertical:4,maxHeight:He*Ne,minHeight:224},filterContainer:{flexGrow:1,flexShrink:1,margin:16},filterInput:{...h.regular,backgroundColor:Y.accented,borderColor:a.gray[100],borderRadius:4,borderWidth:1,flexGrow:1,flexShrink:1,height:40,outlineStyle:"none",paddingHorizontal:12,paddingLeft:40,placeholderTextColor:a.gray[300]},filterfocused:{borderColor:a.gray[200]},searchIcon:{position:"absolute",left:14},tagsList:{flexWrap:"wrap",maxHeight:_e,minHeight:40,overflowY:"auto",paddingHorizontal:16,paddingRight:60,paddingVertical:8},groupTitleBase:{alignItems:"center",flexDirection:"row",flexGrow:1,flexShrink:1,justifyContent:"space-between",paddingHorizontal:16,paddingVertical:12,transitionDuration:"200ms",transitionProperty:"background-color"},groupTitle:{...h.semibold,userSelect:"none"},line:{...h.regular,paddingHorizontal:16,paddingVertical:8,transitionDuration:"200ms",transitionProperty:"background-color",userSelect:"none"},lineInGroup:{paddingLeft:24},emptyList:{height:136},emptyListText:{color:a.gray.primary}}),H=i.memo(({color:r="gray",disabled:s=!1,emptyResultText:g,enableGroups:v=!0,filterPlaceholder:I,items:m,onValueChange:u,placeholder:f,renderTagGroup:M,error:w,style:x,values:n,id:C})=>{const[c,W]=i.useState(""),V=i.useRef(!1),N=i.useRef(null),O=i.useRef(null),se=i.useRef(null),[y,{open:ue,close:ce}]=Pe(!1),de=a[r][50],pe=a[r][100];i.useEffect(()=>{y||W("")},[y]),i.useEffect(()=>{var t,l;if(V.current){const d=(t=N.current)==null?void 0:t.scrollHeight;(l=N.current)==null||l.scrollTo({top:d})}V.current=!1},[n]);const j=t=>{V.current=!0,u([...n,t.value])},me=t=>{u(n.filter(l=>l!==t.value))},ge=()=>{u([])},fe=t=>{V.current=!0;const l=t.map(q=>q.value),d=[...new Set([...n,...l])];u(d)},A=i.useMemo(()=>m.reduce((t,l)=>(t[l.value]=l,t),{}),[m]),R=i.useMemo(()=>n.map(t=>A[t]).filter(F),[n,A]),D=i.useMemo(()=>{const t=m.filter(d=>!n.includes(d.value)),l=c.trim().toLowerCase();return l===""?t:t.filter(({label:d})=>d.toLowerCase().includes(l))},[c,m,n]),ye=i.useMemo(()=>xe.filterMap(Ce.entries(Ie(D,({group:t})=>t)),([t,l])=>l===void 0?Q.None():Q.Some({title:t,data:l})),[D]),$=i.useMemo(()=>p(T,{direction:"row",alignItems:"center",style:o.filterContainer,children:[e(Ve,{autoComplete:"off",inputMode:"search",multiline:!1,rows:1,onChangeText:t=>W(t),placeholder:I,value:c,style:({focused:t})=>[o.filterInput,t&&o.filterfocused]}),e(L,{name:"search-filled",color:a[r].primary,size:20,style:o.searchIcon})]}),[c,I,r]),U=i.useMemo(()=>p(T,{justifyContent:"center",alignItems:"center",style:o.emptyList,children:[e(L,{name:"clipboard-search-regular",size:24,color:a.gray.primary}),ve(g)&&p(J,{children:[e(P,{height:8}),e(_,{style:o.emptyListText,children:g})]})]}),[g]);return p(K,{style:x,children:[p(G,{id:C,ref:O,"aria-haspopup":"listbox",role:"button","aria-expanded":y,disabled:s,onPress:ue,style:({hovered:t,focused:l})=>[o.base,t&&o.hovered,(l||y)&&o.focused,s&&o.disabled,F(w)&&o.errored],children:[e(T,{ref:N,alignItems:"center",direction:"row",style:o.tagsList,children:R.length>0?R.map(t=>e(Z,{color:r,onPressRemove:s?void 0:()=>me(t),style:o.tag,children:t.label},t.value)):f!==""?e(_,{role:"label",numberOfLines:1,style:o.placeholder,children:f}):null}),p(T,{direction:"row",alignItems:"center",style:o.actions,children:[R.length>=1&&!s&&p(J,{children:[e(G,{role:"button",onPress:ge,children:e(L,{name:"dismiss-filled",color:a.gray.primary,size:15})}),e(P,{width:8})]}),e(L,{color:a.gray.primary,name:y?"chevron-up-filled":"chevron-down-filled",size:20})]})]}),e(we,{role:"listbox",matchReferenceWidth:!0,onDismiss:ce,referenceRef:O,returnFocus:!0,visible:y,children:e(K,{style:o.list,children:v?e(Te,{role:"listbox","aria-multiselectable":!0,keyExtractor:(t,l)=>`group-field-${t.value}-${l}`,extraData:c,ListHeaderComponent:$,ListEmptyComponent:U,ListFooterComponent:e(P,{height:16}),sections:ye,renderSectionHeader:({section:{title:t,data:l}})=>p(G,{role:"listitem",onPress:()=>fe(l),style:({hovered:d,pressed:q,focused:he})=>[o.groupTitleBase,(d||he)&&{backgroundColor:de},q&&{backgroundColor:pe}],children:[e(_,{numberOfLines:1,style:o.groupTitle,children:t}),F(M)&&e(Z,{color:r,children:M(l)})]}),renderItem:({item:t})=>e(ee,{color:r,filter:c,item:t,handleSelectItem:j,style:o.lineInGroup})}):e(ke,{ref:se,role:"list",data:D,extraData:c,keyExtractor:t=>`field-${t.value}`,ListHeaderComponent:$,ListEmptyComponent:U,ListFooterComponent:e(P,{height:8}),renderItem:({item:t})=>e(ee,{color:r,filter:c,item:t,handleSelectItem:j})})})}),e(B,{message:w})]})}),ee=({item:r,color:s,filter:g,handleSelectItem:v,style:I})=>{const{label:m,disabled:u=!1}=r,f=g.trim().toLowerCase(),M=a[s][50],w=a[s][100],x=i.useMemo(()=>u||f===""?m:Me(m,f),[m,u,f]);return e(Le,{role:"listitem",disabled:u,numberOfLines:1,onPress:()=>v(r),style:({hovered:n,pressed:C})=>[o.line,I,n&&{backgroundColor:M},C&&{backgroundColor:w},u&&{backgroundColor:a.gray[50],color:a.gray[100]}],children:typeof x=="string"?x:x.map((n,C)=>n.toLowerCase()===f?e(_,{style:{color:s},children:n},C):n)})};try{H.displayName="MultiSelect",H.__docgenInfo={description:"",displayName:"MultiSelect",props:{color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"enum",value:[{value:'"warning"'},{value:'"gray"'},{value:'"live"'},{value:'"sandbox"'},{value:'"positive"'},{value:'"negative"'},{value:'"current"'},{value:'"partner"'},{value:'"swan"'},{value:'"shakespear"'},{value:'"darkPink"'},{value:'"sunglow"'},{value:'"mediumSladeBlue"'}]}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"string"}},emptyResultText:{defaultValue:null,description:"",name:"emptyResultText",required:!1,type:{name:"string"}},enableGroups:{defaultValue:null,description:"",name:"enableGroups",required:!1,type:{name:"boolean"}},filterPlaceholder:{defaultValue:null,description:"",name:"filterPlaceholder",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"MultiSelectItem[]"}},onValueChange:{defaultValue:null,description:"",name:"onValueChange",required:!0,type:{name:"(values: string[]) => void"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},renderTagGroup:{defaultValue:null,description:"",name:"renderTagGroup",required:!1,type:{name:"((items: readonly MultiSelectItem[]) => string)"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"StyleProp<ViewStyle>"}},values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"string[]"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}}}}}catch{}const Re=z.create({select:{maxWidth:400}}),dt={title:"Forms/MultiSelect",component:H},De=[{label:"Camille",value:"camille",group:"C"},{label:"Charlotte",value:"charlotte",group:"C"},{label:"Francis",value:"francis",group:"F"},{label:"Émilie",value:"emilie",group:"E"},{label:"François",value:"francois",group:"F"},{label:"Laura",value:"laura",group:"L"},{label:"Marie-Anne",value:"marie_anne",group:"M"},{label:"Natasha",value:"natasha",group:"N",disabled:!0},{label:"Nicolas",value:"nicolas",group:"N"},{label:"Pierre",value:"pierre",group:"P"}],S=({initialValues:r=[],...s})=>{const[g,v]=i.useState(r);return e(H,{placeholder:"Select people...",filterPlaceholder:"Search...",emptyResultText:"No result",values:g,items:De,onValueChange:v,style:Re.select,...s})},k=()=>p(ne,{title:"MultiSelect variations",children:[e(b,{title:"Default",children:e(S,{})}),e(b,{title:"Without groups",children:e(S,{enableGroups:!1})}),e(b,{title:"Disabled",children:e(S,{disabled:!0})}),e(b,{title:"Disabled with a value",children:e(S,{disabled:!0,initialValues:["charlotte"]})}),e(b,{title:"Without any option",children:e(S,{items:[]})})]}),E=()=>e(ne,{title:"MultiSelect colors",children:Object.keys(a).map(r=>e(b,{title:r,children:e(S,{color:r})},r))});var te,re,le;k.parameters={...k.parameters,docs:{...(te=k.parameters)==null?void 0:te.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect variations">
      <StoryPart title="Default">
        <EditableMultiSelect />
      </StoryPart>

      <StoryPart title="Without groups">
        <EditableMultiSelect enableGroups={false} />
      </StoryPart>

      <StoryPart title="Disabled">
        <EditableMultiSelect disabled={true} />
      </StoryPart>

      <StoryPart title="Disabled with a value">
        <EditableMultiSelect disabled={true} initialValues={["charlotte"]} />
      </StoryPart>

      <StoryPart title="Without any option">
        <EditableMultiSelect items={[]} />
      </StoryPart>
    </StoryBlock>;
}`,...(le=(re=k.parameters)==null?void 0:re.docs)==null?void 0:le.source}}};var ae,oe,ie;E.parameters={...E.parameters,docs:{...(ae=E.parameters)==null?void 0:ae.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect colors">
      {Object.keys(colors).map(color => <StoryPart key={color} title={color}>
          <EditableMultiSelect color={(color as ColorVariants)} />
        </StoryPart>)}
    </StoryBlock>;
}`,...(ie=(oe=E.parameters)==null?void 0:oe.docs)==null?void 0:ie.source}}};const pt=["Variations","Colors"];export{E as Colors,k as Variations,pt as __namedExportsOrder,dt as default};
//# sourceMappingURL=MultiSelect.stories-Dn6RLUJY.js.map
