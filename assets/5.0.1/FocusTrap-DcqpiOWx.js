import{i as y,k as T,N as R,a as q,V as N}from"./Space-Cr8ejQ8c.js";import{r as e}from"./index-CBqU2yxZ.js";import{g}from"./a11y-DXvpDVrG.js";import{f as I,l as S}from"./array-rjEBP2Ry.js";const F=(r,n)=>{const c=e.useRef(r);e.useEffect(()=>{c.current=r},[r]),e.useEffect(()=>{const u=window.setInterval(()=>c.current(u),n);return()=>window.clearInterval(u)},[n])},k=({containerRef:r,onClickOutside:n,onFocusOutside:c})=>{const u=e.useRef(!1),a=e.useCallback(s=>{const o=s.target;return y(r.current)&&r.current instanceof HTMLElement&&r.current.contains(o)},[r]);e.useEffect(()=>{if(T(n))return;const s=l=>{a(l)||(u.current=!0)},o=l=>{!a(l)&&u.current&&(n==null||n(l)),u.current=!1};return document.addEventListener("mousedown",s,!0),document.addEventListener("mouseup",o,!0),document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",o,!0),()=>{document.removeEventListener("mousedown",s,!0),document.removeEventListener("mouseup",o,!0),document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",o,!0)}},[a,n]),e.useEffect(()=>{if(T(c))return;const s=o=>{a(o)||c==null||c(o)};return document.addEventListener("focusin",s,!0),()=>{document.removeEventListener("focusin",s,!0)}},[a,c])};let h=0;const V=e.forwardRef(({children:r,focusLock:n,onClickOutside:c,onEscapeKey:u,returnFocus:a,style:s,autoFocus:o},l)=>{const d=e.useRef(null),v=e.useRef(null),w=e.useRef(!1);e.useImperativeHandle(l,()=>({setInitiallyFocusedElement:t=>v.current=t}));const[L]=e.useState(h);e.useEffect(()=>(++h,()=>{--h}));const _=e.useCallback(({nativeEvent:t})=>{R(t.key).with("Escape",()=>{h===L+1&&(u==null||u())}).with("Tab",()=>{if(!n)return;const f=d.current;if(y(f)){const m=t.target,i=g(f),p=I(i),E=S(i);m===p&&t.shiftKey&&(t.preventDefault(),E==null||E.focus()),m===E&&!t.shiftKey&&(t.preventDefault(),p==null||p.focus())}}).otherwise(()=>{})},[n,u,L]);e.useEffect(()=>{if(a)return v.current=document.activeElement,()=>{var t;w.current||(t=v.current)==null||t.focus()}},[a]),F(t=>{if(o){const f=d.current;if(y(f)){if(f.offsetWidth===0)return;const m=g(f),i=I(m);i==null||i.focus(),window.clearInterval(t)}}},16);const b=e.useCallback(()=>{w.current=!0},[]);return k({containerRef:d,onClickOutside:c,onFocusOutside:b}),q(N,{ref:d,onKeyDownCapture:_,style:s,children:r})});try{V.displayName="FocusTrap",V.__docgenInfo={description:"",displayName:"FocusTrap",props:{autoFocus:{defaultValue:null,description:"",name:"autoFocus",required:!0,type:{name:"boolean"}},focusLock:{defaultValue:null,description:"",name:"focusLock",required:!0,type:{name:"boolean"}},onClickOutside:{defaultValue:null,description:"",name:"onClickOutside",required:!1,type:{name:"((event: MouseEvent | TouchEvent) => void)"}},onEscapeKey:{defaultValue:null,description:"",name:"onEscapeKey",required:!1,type:{name:"(() => void)"}},returnFocus:{defaultValue:null,description:"",name:"returnFocus",required:!0,type:{name:"boolean"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"StyleProp<ViewStyle>"}}}}}catch{}export{V as F};
//# sourceMappingURL=FocusTrap-DcqpiOWx.js.map
