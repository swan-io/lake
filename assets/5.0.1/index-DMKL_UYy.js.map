{"version":3,"file":"index-DMKL_UYy.js","sources":["../../../node_modules/@swan-io/use-form/dist/index.mjs"],"sourcesContent":["import{Dict as e,Option as t,Future as r}from\"@swan-io/boxed\";import{useReducer as n,useRef as u,useEffect as i,useMemo as l,useSyncExternalStore as c}from\"react\";const a=function(){return e=>{const[t,...r]=[].slice.call(arguments);if(null!=t&&!1!==t){const r=t(e);if(void 0!==r)return r}if(r.length>0)return a(...r)(e)}},o=e=>e,s=()=>{},d=e=>\"\"===e,v=function(e){return t=>{const[r=d]=[].slice.call(arguments,1);if(!r(t))return e(t)}},f=a=>{const[,d]=n(()=>[],[]),v=u(!1),f=u(\"untouched\"),F=u(a);F.current=a,i(()=>(v.current=!0,()=>{v.current=!1}),[]);const m=u(),g=u(),b=u(),h=l(()=>{const n=e=>F.current[e].initialValue,u=e=>{var t;return null!=(t=F.current[e].sanitize)?t:o},i=(e,t)=>{m.current[e].state=\"function\"==typeof t?t(m.current[e].state):t},l=e=>{const{talkative:t,value:r,validity:i}=m.current[e].state;if(!t||\"unknown\"===i.tag)return{value:r,valid:!1,error:void 0};const l=u(e),c=(e=>{var t;return null!=(t=F.current[e].isEqual)?t:Object.is})(e);return{value:r,valid:\"valid\"===i.tag&&!c(l(n(e)),l(r)),error:\"invalid\"===i.tag?i.error:void 0}},c=e=>{m.current[e].callbacks.forEach(e=>e())},a=(e,t)=>{const r=(e=>{var t;return null!=(t=F.current[e].strategy)?t:\"onSuccessOrBlur\"})(e);t&&!t.some(e=>r===e)||i(e,e=>({...e,talkative:!0}))},g=e=>void 0===e?{tag:\"valid\"}:{tag:\"invalid\",error:e},b=function(e,t){void 0===t&&(t={});const{sanitize:r=!1}=t,i=null==m.current[e]?n(e):m.current[e].state.value;return r?u(e)(i):i},h=e=>{const{ref:t}=m.current[e];t.current&&\"function\"==typeof t.current.focus&&t.current.focus()},y=e=>{const t=(e=>{var t;return null!=(t=F.current[e].validate)?t:s})(e),r=t(b(e,{sanitize:!0}),{getFieldValue:b,focusField:h});return void 0===r&&a(e,[\"onSuccess\",\"onSuccessOrBlur\"]),i(e,e=>({...e,validity:g(r)})),c(e),r},p=e=>{i(e,{value:n(e),talkative:!1,validity:{tag:\"unknown\"}}),c(e)},k=()=>{f.current=\"submitted\",v.current&&d()};return{getFieldValue:b,setFieldValue:function(e,t,r){void 0===r&&(r={});const{validate:n=!1}=r;i(e,e=>({...e,value:t})),n&&a(e),y(e)},setFieldError:(e,t)=>{i(e,e=>({...e,validity:g(t)})),a(e),c(e)},focusField:h,resetField:p,sanitizeField:e=>{const t=u(e);i(e,e=>{let{talkative:r,value:n,validity:u}=e;return{value:t(n),talkative:r,validity:u}}),c(e)},validateField:e=>{if((e=>m.current[e].mounted)(e))return a(e),y(e)},listenFields:(e,t)=>{const r=()=>{t(e.reduce((e,t)=>(e[t]=l(t),e),{}))};return e.forEach(e=>m.current[e].callbacks.add(r)),()=>{e.forEach(e=>m.current[e].callbacks.delete(r))}},resetForm:()=>{e.keys(F.current).forEach(e=>p(e)),f.current=\"untouched\",d()},submitForm:function(n){let{onSuccess:u=s,onFailure:i=s,focusOnFirstError:l=!0}=void 0===n?{}:n;if(\"submitting\"===f.current)return;f.current=\"submitting\";const c=e.keys(m.current),o=c.filter(e=>m.current[e].mounted),v={},F={},g=[];if(c.forEach(e=>{v[e]=t.None()}),o.forEach((e,r)=>{a(e),v[e]=t.Some(b(e,{sanitize:!0})),g[r]=y(e)}),(e=>e.every(e=>void 0===e))(g)){const e=u(v),t=r.isFuture(e)?e.toPromise():e;!(p=t)||\"object\"!=typeof p&&\"function\"!=typeof p||\"function\"!=typeof p.then?k():(d(),t.finally(k))}else l&&((e,t)=>{const r=e[t.findIndex(e=>void 0!==e)];void 0!==r&&h(r)})(o,g),o.forEach((e,t)=>{F[e]=g[t]}),i(F),f.current=\"submitted\",d();var p},getOnChange:e=>t=>{i(e,e=>({...e,value:t})),a(e,[\"onChange\"]),\"untouched\"!==f.current&&\"submitted\"!==f.current||(f.current=\"editing\",d()),y(e)},getOnBlur:e=>()=>{const{validity:t}=m.current[e].state;\"unknown\"===t.tag||(e=>m.current[e].state.talkative)(e)||(a(e,[\"onBlur\",\"onSuccessOrBlur\"]),y(e))},getFieldState:l}},[]),y={};for(const e in F.current){var p,k;Object.prototype.hasOwnProperty.call(F.current,e)&&(y[e]=null!=(p=null==(k=m.current)?void 0:k[e])?p:{callbacks:new Set,ref:{current:null},mounted:!1,state:{value:F.current[e].initialValue,talkative:!1,validity:{tag:\"unknown\"}}})}if(m.current=y,!g.current){const e=e=>{let{name:t,children:r}=e;const{subscribe:n,getSnapshot:u}=l(()=>({getSnapshot:()=>m.current[t].state,subscribe:e=>(m.current[t].callbacks.add(e),()=>{m.current[t].callbacks.delete(e)})}),[t]);return c(n,u,u),i(()=>{const e=!m.current[t].mounted;return e?m.current[t].mounted=!0:\"development\"===process.env.NODE_ENV&&console.error(\"Mounting multiple fields with identical names is not supported and will lead to errors\"),()=>{e&&(m.current[t].mounted=!1)}},[t]),r({...h.getFieldState(t),ref:m.current[t].ref,onBlur:l(()=>h.getOnBlur(t),[t]),onChange:l(()=>h.getOnChange(t),[t])})};e.displayName=\"Field\",g.current=e;const t=e=>{let{names:t,children:r}=e;const{subscribe:n,getSnapshot:u}=l(()=>({getSnapshot:()=>JSON.stringify(t.map(e=>m.current[e].state)),subscribe:e=>(t.forEach(t=>m.current[t].callbacks.add(e)),()=>{t.forEach(t=>m.current[t].callbacks.delete(e))})}),[JSON.stringify(t)]);return c(n,u,u),r(t.reduce((e,t)=>(e[t]=h.getFieldState(t),e),{}))};t.displayName=\"FieldsListener\",b.current=t}return{formStatus:f.current,Field:g.current,FieldsListener:b.current,getFieldValue:h.getFieldValue,setFieldValue:h.setFieldValue,setFieldError:h.setFieldError,focusField:h.focusField,resetField:h.resetField,sanitizeField:h.sanitizeField,validateField:h.validateField,listenFields:h.listenFields,resetForm:h.resetForm,submitForm:h.submitForm}};export{a as combineValidators,v as toOptionalValidator,f as useForm};\n//# sourceMappingURL=index.mjs.map\n"],"names":["o","e","s","f","a","d","n","v","u","i","m","g","b","h","l","t","r","c","y","p","k","F"],"mappings":"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","x_google_ignoreList":[0]}