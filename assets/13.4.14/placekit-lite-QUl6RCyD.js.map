{"version":3,"file":"placekit-lite-QUl6RCyD.js","sources":["../../../node_modules/@placekit/client-js/dist/placekit-lite.js"],"sourcesContent":["/*! @placekit/client-js v2.3.0 | Â© placekit.io | MIT license | https://github.com/placekit/client-js#readme */\nconst extensions = new Map();\nfunction getUserAgent() {\n  const chunks = [];\n  if (typeof window !== 'undefined' && navigator.userAgent) {\n    chunks.push(navigator.userAgent);\n  }\n  chunks.push(`PlaceKit/2.3.0 (Client=JavaScript)`);\n  if (typeof process !== 'undefined' && process.version) {\n    chunks.push(`NodeJS/${process.version}`);\n  }\n  return chunks.join(' ');\n}\nfunction placekit(apiKey, options = {}) {\n  if (!['string', 'undefined'].includes(typeof apiKey)) {\n    throw Error('PlaceKit: `apiKey` argument is invalid, expected a string.');\n  } else if (!apiKey) {\n    console.warn('PlaceKit: missing or empty `apiKey` argument.');\n  }\n  let currentHost = 0;\n  const hosts = [`https://api.placekit.co`];\n  let hasGeolocation = false;\n  const globalParams = {\n    maxResults: 5,\n  };\n  if (typeof window !== 'undefined' && navigator.language) {\n    globalParams.language = navigator.language.slice(0, 2);\n  }\n  const userAgent = getUserAgent();\n  function request(method = 'POST', resource = '', opts = {}) {\n    const { timeout, forwardIP, ...params } = opts;\n    const controller = new AbortController();\n    const id =\n      typeof timeout !== 'undefined' ? setTimeout(() => controller.abort(), timeout) : undefined;\n    const url = new URL(resource.trim().replace(/^\\/+/, ''), hosts[currentHost]);\n    if (['GET', 'HEAD'].includes(method) && typeof params !== 'undefined') {\n      Object.keys(params).forEach((k) => url.searchParams.append(k, params[k]));\n    }\n    const headers = {\n      'Content-Type': 'application/json; charset=UTF-8',\n      'User-Agent': userAgent,\n      'x-placekit-api-key': apiKey,\n    };\n    if (forwardIP) {\n      headers['x-forwarded-for'] = forwardIP;\n    }\n    return fetch(url, {\n      method,\n      headers,\n      signal: controller.signal,\n      body: !['GET', 'HEAD'].includes(method) ? JSON.stringify(params) : undefined,\n    })\n      .then(async (res) => {\n        clearTimeout(id);\n        const body = await res.json();\n        if (!res.ok) {\n          throw {\n            status: res.status,\n            statusText: res.statusText,\n            ...body,\n          };\n        }\n        return body;\n      })\n      .catch((err) => {\n        if (err.name === 'AbortError' || (err.status && err.status >= 500)) {\n          currentHost++;\n          if (currentHost < hosts.length - 1) {\n            return request(method, resource, opts);\n          }\n        }\n        throw err;\n      });\n  }\n  const client = {\n    get options() {\n      return globalParams;\n    },\n    get hasGeolocation() {\n      return hasGeolocation;\n    },\n    configure(opts = {}) {\n      if (!['object', 'undefined'].includes(typeof opts) || Array.isArray(opts) || opts === null) {\n        throw Error('PlaceKit.configure: `opts` argument is invalid, expected an object.');\n      }\n      Object.assign(globalParams, opts);\n    },\n    requestGeolocation(opts = {}) {\n      if (!['object', 'undefined'].includes(typeof opts) || Array.isArray(opts) || opts === null) {\n        throw Error('PlaceKit.requestGeolocation: `opts` argument is invalid, expected an object.');\n      }\n      return new Promise((resolve, reject) => {\n        if (typeof window === 'undefined' || !navigator.geolocation) {\n          reject(\n            Error('PlaceKit.requestGeolocation: geolocation is only available in the browser.'),\n          );\n        } else {\n          navigator.geolocation.getCurrentPosition(\n            (pos) => {\n              hasGeolocation = true;\n              globalParams.coordinates = `${pos.coords.latitude},${pos.coords.longitude}`;\n              resolve(pos);\n            },\n            (err) => {\n              hasGeolocation = false;\n              delete globalParams.coordinates;\n              reject(Error(`PlaceKit.requestGeolocation: (${err.code}) ${err.message}`));\n            },\n            opts,\n          );\n        }\n      });\n    },\n    clearGeolocation() {\n      hasGeolocation = false;\n      delete globalParams.coordinates;\n    },\n  };\n  for (const [resource, init] of extensions.entries()) {\n    if (resource in client) {\n      throw Error(`PlaceKit extend: \\`client.${resource}\\` already exists.`);\n    }\n    client[resource] = init(request, client);\n  }\n  client.configure(options);\n  return client;\n}\nplacekit.extend = function (resource, init) {\n  if (!init?.call) {\n    throw Error('PlaceKit extend: `init` argument is invalid, expected a function.');\n  }\n  extensions.set(resource, init);\n};\nplacekit.extend('search', (request, client) => (query, opts = {}) => {\n  if (!['string', 'undefined'].includes(typeof query)) {\n    throw Error('PlaceKit `client.search`: `query` argument is invalid, expected a string.');\n  }\n  if (!['object', 'undefined'].includes(typeof opts) || Array.isArray(opts) || opts === null) {\n    throw Error('PlaceKit.search: `opts` argument is invalid, expected an object.');\n  }\n  return request('POST', 'search', {\n    ...client.options,\n    ...opts,\n    query,\n  });\n});\nplacekit.extend('reverse', (request, client) => (opts = {}) => {\n  if (!['object', 'undefined'].includes(typeof opts) || Array.isArray(opts) || opts === null) {\n    throw Error('PlaceKit.reverse: `opts` argument is invalid, expected an object.');\n  }\n  return request('POST', 'reverse', {\n    ...client.options,\n    ...opts,\n  });\n});\n\nexport { placekit as default };\n"],"names":["extensions","getUserAgent","chunks","placekit","apiKey","options","currentHost","hosts","hasGeolocation","globalParams","userAgent","request","method","resource","opts","timeout","forwardIP","params","controller","id","url","k","headers","res","body","err","client","resolve","reject","pos","init","query"],"mappings":"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","x_google_ignoreList":[0]}