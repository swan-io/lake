import{j as e}from"./jsx-runtime-BlAj40OV.js";import{s as W,aa as g,z as H,G as E,N as U,L as A,c as Y,p as S,F as K,H as j,B as G}from"./ScrollView-DAMcnhPN.js";import{L as I}from"./LakeCombobox-Jl_7Do6P.js";import{r as l}from"./index-Cs7sjTYM.js";import{S as J}from"./Separator-qitoqTAJ.js";import{a as B,g as D}from"./countries-CAya7Lwk.js";import{_ as Q}from"./iframe-WrWK8NBG.js";import{t as X}from"./i18n-txGMRmwr.js";import{S as Z,a as h}from"./_StoriesComponents-Bs-HXw4X.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-DJFdew98.js";import"./Pressable-8N6ahZPW.js";import"./FocusTrap-HMOsJfWh.js";import"./array-BfAlyugE.js";import"./Popover-CfCnBjuZ.js";import"./useResponsive-CzIqCC5v.js";import"./function-B3wRQvvE.js";import"./BottomPanel-DvLAyyFQ.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-DMoYUPTW.js";import"./Suspendable-Bl-Qq_g-.js";import"./index-CJghV6hQ.js";import"./extends-CF3RwP-h.js";import"./TransitionView-_995VKea.js";import"./index-Cp2lnEJT.js";import"./LakeTextInput-BV-20XEE.js";import"./Fill-l8vhgJyC.js";import"./LakeSelect-C7OR4wsp.js";import"./useDisclosure-DLkMFUa4.js";import"./index-Cyz8msWj.js";import"./string-CSzQMepT.js";import"../../sb-preview/runtime.js";import"./rifm-D9VipfZA.js";import"./utc-Bb9NEY8r.js";const N=W.create({unselectable:{userSelect:"none"}}),_=({inputRef:s,value:a,onValueChange:t,disabled:u,id:r,placeholder:c,error:v,emptyResultText:d,ListFooterComponent:o,shouldDisplaySuggestions:b=!0,loadSuggestions:p,onSuggestion:q,onLoadError:x})=>{const[f,m]=l.useState(g.NotAsked()),i=l.useRef();return e.jsx(I,{inputRef:s,id:r,placeholder:c,value:a??"",items:f,icon:p!=null?"search-filled":void 0,disabled:u,error:v,ListFooterComponent:o!=null&&e.jsxs(e.Fragment,{children:[H(f).with(g.P.Done(E.P.Ok(U.select())),n=>n.length>0?e.jsx(J,{}):null).otherwise(()=>null),o]}),onSelectItem:n=>{q(n)},onValueChange:n=>{var y;if((y=i.current)==null||y.cancel(),i.current=void 0,t(n),n.length<=3||!b)return m(g.NotAsked());if(p!=null){m(g.Loading());const T=p(n);i.current=T,x!=null&&T.tapError(x),T.onResolve(R=>m(g.Done(R)))}},keyExtractor:n=>`${n.title} ${n.subtitle}`,emptyResultText:d,renderItem:n=>e.jsxs(e.Fragment,{children:[e.jsx(A,{numberOfLines:1,style:N.unselectable,color:Y.gray[900],children:n.title}),e.jsx(A,{numberOfLines:1,style:N.unselectable,variant:"smallRegular",children:n.subtitle})]})})};_.__docgenInfo={description:"",methods:[],displayName:"AutocompleteSearchInput",props:{inputRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"unknown"}],raw:"MutableRefObject<unknown>"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},id:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},error:{required:!1,tsType:{name:"string"},description:""},emptyResultText:{required:!0,tsType:{name:"string"},description:""},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},shouldDisplaySuggestions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},loadSuggestions:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => Future<Result<Suggestion<T>[], unknown>>",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Future",elements:[{name:"Result",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  title: string;
  subtitle: string;
  value: T;
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"subtitle",value:{name:"string",required:!0}},{key:"value",value:{name:"T",required:!0}}]}}],raw:"Suggestion<T>[]"},{name:"unknown"}],raw:"Result<Suggestion<T>[], unknown>"}],raw:"Future<Result<Suggestion<T>[], unknown>>"}}},description:""},onSuggestion:{required:!0,tsType:{name:"signature",type:"function",raw:"(suggestion: Suggestion<T>) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  title: string;
  subtitle: string;
  value: T;
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"subtitle",value:{name:"string",required:!0}},{key:"value",value:{name:"T",required:!0}}]}},name:"suggestion"}],return:{name:"void"}}},description:""},onLoadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"error"}],return:{name:"void"}}},description:""}}};const O=(s,a)=>{let t;return(...u)=>(clearTimeout(t),new Promise(r=>{t=setTimeout(()=>r(s(...u)),a)}))},M=({apiKey:s,debounceInterval:a=1e3})=>{const[t,u]=l.useState();return l.useEffect(()=>{s!=null&&Q(async()=>{const{default:r}=await import("./placekit-lite-Bp5f6h80.js");return{default:r}},[]).then(({default:r})=>{u(r(s))})},[s]),l.useMemo(()=>{if(t!=null)return{...t,search:O(t.search,a),reverse:O(t.reverse,a)}},[t,a])},$=({inputRef:s,id:a,country:t,disabled:u,error:r,value:c,types:v=["street"],onValueChange:d,onSuggestion:o,language:b,placeholder:p,shouldDisplaySuggestions:q=!0,emptyResultText:x,apiKey:f})=>{const m=M({apiKey:f}),i=l.useCallback(y=>{if(m!=null){const T=S.fromNullable(t).map(w=>K.filterMap(B[w]??[w],k=>S.fromNullable(D(k)))).getOr([]),R=T.length===0?S.None():S.Some(T);return j.fromPromise(m.search(y,{types:v,language:b,countries:R.toUndefined()})).mapOk(({results:w})=>w.map(k=>({title:k.name,subtitle:`${k.city} (${k.country})`,value:k})),!0)}return j.value(E.Ok([]))},[m,t,b,v]),n=l.useCallback(y=>{o==null||o({completeAddress:y.value.name,postalCode:y.value.zipcode[0],city:y.value.city,country:y.value.country,countryCode:y.value.countrycode})},[o]);return e.jsx(_,{inputRef:s,value:c,onValueChange:d,disabled:u,id:a,placeholder:p,error:r,emptyResultText:x,shouldDisplaySuggestions:q,loadSuggestions:m!=null?i:void 0,onSuggestion:n})};$.__docgenInfo={description:"",methods:[],displayName:"PlacekitAddressSearchInput",props:{inputRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"unknown"}],raw:"MutableRefObject<unknown>"},description:""},id:{required:!1,tsType:{name:"string"},description:""},types:{required:!1,tsType:{name:'PKOptions["types"]',raw:'PKOptions["types"]'},description:"",defaultValue:{value:'["street"]',computed:!1}},country:{required:!1,tsType:{name:'Simplify["cca3"]',raw:'Country["cca3"]'},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"string"},description:""},onSuggestion:{required:!1,tsType:{name:"signature",type:"function",raw:"(suggestion: AddressDetail) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  completeAddress: string;
  city: string;
  postalCode?: string;
  country: string;
  countryCode: string;
}`,signature:{properties:[{key:"completeAddress",value:{name:"string",required:!0}},{key:"city",value:{name:"string",required:!0}},{key:"postalCode",value:{name:"string",required:!1}},{key:"country",value:{name:"string",required:!0}},{key:"countryCode",value:{name:"string",required:!0}}]}},name:"suggestion"}],return:{name:"void"}}},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},value:{required:!1,tsType:{name:"string"},description:""},language:{required:!0,tsType:{name:"union",raw:'"en" | "es" | "de" | "fi" | "fr" | "it" | "nl" | "pt"',elements:[{name:"literal",value:'"en"'},{name:"literal",value:'"es"'},{name:"literal",value:'"de"'},{name:"literal",value:'"fi"'},{name:"literal",value:'"fr"'},{name:"literal",value:'"it"'},{name:"literal",value:'"nl"'},{name:"literal",value:'"pt"'}]},description:""},placeholder:{required:!0,tsType:{name:"string"},description:""},shouldDisplaySuggestions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},emptyResultText:{required:!0,tsType:{name:"string"},description:""},apiKey:{required:!1,tsType:{name:"string"},description:""}}};const z=({value:s,onValueChange:a,country:t,disabled:u,placeholder:r,id:c,error:v,onSuggestion:d,onLoadError:o,apiKey:b})=>{const p=M({apiKey:b}),q=l.useCallback(f=>{if(p!=null){const m=S.fromNullable(t).map(i=>B[i]??[i]).map(i=>K.filterMap(i,n=>S.fromNullable(D(n)))).flatMap(i=>i.length===0?S.None():S.Some(i));return j.fromPromise(p.search(f,{types:["city"],countries:m.toUndefined()})).mapOk(({results:i})=>i.map(n=>({title:n.name,subtitle:n.city,value:n})),!0)}return j.value(E.Ok([]))},[p,t]),x=l.useCallback(f=>{d==null||d({city:f.value.city,postalCode:f.value.zipcode[0]})},[d]);return e.jsx(_,{value:s,onValueChange:a,disabled:u,id:c,placeholder:r,error:v,emptyResultText:X("common.noResult"),loadSuggestions:p!=null?q:void 0,onSuggestion:x,onLoadError:o})};z.__docgenInfo={description:"",methods:[],displayName:"PlacekitCityInput",props:{value:{required:!0,tsType:{name:"string"},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},country:{required:!1,tsType:{name:'Simplify["cca3"]',raw:'Country["cca3"]'},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},onSuggestion:{required:!1,tsType:{name:"signature",type:"function",raw:"(place: CityDetail) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  city: string;
  postalCode?: string;
}`,signature:{properties:[{key:"city",value:{name:"string",required:!0}},{key:"postalCode",value:{name:"string",required:!1}}]}},name:"place"}],return:{name:"void"}}},description:""},onLoadError:{required:!0,tsType:{name:"signature",type:"function",raw:"(error: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"error"}],return:{name:"void"}}},description:""},apiKey:{required:!1,tsType:{name:"string"},description:""}}};const ee=W.create({footer:{paddingHorizontal:12}}),Le={title:"Forms/Combobox",component:I},te=s=>{const a=fetch(`https://dummyjson.com/products/search?limit=10&q=${s}`).then(t=>t.json()).then(t=>t.products);return j.fromPromise(a)},C=s=>{const[a,t]=l.useState(null),[u,r]=l.useState(()=>g.NotAsked()),[c,v]=l.useState(""),d=a?a.title:c;return l.useEffect(()=>{if(!c){r(g.NotAsked());return}r(g.Loading());const o=te(c);return o.onResolve(b=>{r(g.Done(b))}),()=>{o.cancel()}},[c]),e.jsx(I,{value:d,items:u,onValueChange:o=>{t(null),v(o)},onSelectItem:o=>{r(g.NotAsked()),t(o)},keyExtractor:o=>o.id.toString(),renderItem:o=>e.jsx(A,{children:o.title}),emptyResultText:"No result",...s})},P=()=>{const[s,a]=l.useState(""),[t,u]=l.useState("");return e.jsxs(Z,{title:"Combobox",children:[e.jsx(h,{title:"By default",children:e.jsx(C,{})}),e.jsx(h,{title:"Is disabled",children:e.jsx(C,{disabled:!0})}),e.jsx(h,{title:"Is readOnly",children:e.jsx(C,{readOnly:!0})}),e.jsx(h,{title:"With icon",children:e.jsx(C,{icon:"add-circle-regular"})}),e.jsx(h,{title:"With placeholder",children:e.jsx(C,{placeholder:"Enter a product"})}),e.jsx(h,{title:"With error",children:e.jsx(C,{placeholder:"An error occurred"})}),e.jsx(h,{title:"With Footer Component",children:e.jsx(C,{ListFooterComponent:e.jsx(G,{direction:"row",justifyContent:"end",style:ee.footer,children:e.jsx(A,{children:"With footer component"})})})}),e.jsx(h,{title:"CityInput",children:e.jsx(z,{apiKey:void 0,country:"FRA",value:t,onValueChange:u,onSuggestion:r=>{console.log(r.city),console.log(r.postalCode)},onLoadError:()=>{}})}),e.jsx(h,{title:"AddressInput",children:e.jsx($,{apiKey:void 0,country:"FRA",value:s,onValueChange:a,onSuggestion:r=>{console.log(r.completeAddress),console.log(r.city),console.log(r.postalCode)},language:"fr",placeholder:"",emptyResultText:"Nothing"})})]})};P.__docgenInfo={description:"",methods:[],displayName:"Variations"};var L,V,F;P.parameters={...P.parameters,docs:{...(L=P.parameters)==null?void 0:L.docs,source:{originalSource:`() => {
  const [search, setSearch] = useState("");
  const [city, setCity] = useState("");
  return <StoryBlock title="Combobox">
      <StoryPart title="By default">
        <EditableCombobox />
      </StoryPart>

      <StoryPart title="Is disabled">
        <EditableCombobox disabled={true} />
      </StoryPart>

      <StoryPart title="Is readOnly">
        <EditableCombobox readOnly={true} />
      </StoryPart>

      <StoryPart title="With icon">
        <EditableCombobox icon={"add-circle-regular"} />
      </StoryPart>

      <StoryPart title="With placeholder">
        <EditableCombobox placeholder={"Enter a product"} />
      </StoryPart>

      <StoryPart title="With error">
        <EditableCombobox placeholder={"An error occurred"} />
      </StoryPart>

      <StoryPart title="With Footer Component">
        <EditableCombobox ListFooterComponent={<Box direction="row" justifyContent="end" style={styles.footer}>
              <LakeText>With footer component</LakeText>
            </Box>} />
      </StoryPart>

      <StoryPart title="CityInput">
        <PlacekitCityInput apiKey={PLACEKIT_API_KEY} country="FRA" value={city} onValueChange={setCity} onSuggestion={place => {
        console.log(place.city);
        console.log(place.postalCode);
      }} onLoadError={() => {}} />
      </StoryPart>

      <StoryPart title="AddressInput">
        <PlacekitAddressSearchInput apiKey={PLACEKIT_API_KEY} country="FRA" value={search} onValueChange={setSearch} onSuggestion={place => {
        console.log(place.completeAddress);
        console.log(place.city);
        console.log(place.postalCode);
      }} language="fr" placeholder="" emptyResultText="Nothing" />
      </StoryPart>
    </StoryBlock>;
}`,...(F=(V=P.parameters)==null?void 0:V.docs)==null?void 0:F.source}}};const Ve=["Variations"];export{P as Variations,Ve as __namedExportsOrder,Le as default};
//# sourceMappingURL=Combobox.stories-B2S8SaHr.js.map
