import{S as pe,c as N,j as I,F as ke,a as n,V as O,T as $,b as L,l as Ie,f as Oe,s as _e,i as oe}from"./Space-57107f4e.js";import{r as s}from"./index-8db94870.js";import{t as be}from"./typography-6ad07e3d.js";import{u as U}from"./useDisclosure-d57b00aa.js";import{B as ve,Q as ce,H as Z}from"./index-73e1d3ab.js";import{I as qe}from"./Icon-c740bbf8.js";import{L as ae}from"./LakeButton-1e200cd1.js";import{P as Y}from"./Popover-e14805ae.js";import{F as me}from"./index-58bb7859.js";import{P as ie}from"./index-ab60b850.js";import{d as ee}from"./dayjs.min-5232dddb.js";import{s as ge}from"./index-302a0035.js";import{R as De}from"./rifm.esm-3c96b912.js";import{a as ze}from"./useMergeRefs-2375844e.js";import{u as Be}from"./TransitionView-07b011e8.js";import{L as Le}from"./LakeCheckbox-3799e11a.js";import{L as Re}from"./LakeLabel-c92a8f20.js";import{L as je}from"./LakeRadio-6904d388.js";import{L as Ee}from"./LakeTextInput-558979a7.js";import{T as Ce}from"./Tag-5e2ccefd.js";import{W as Me}from"./WithCurrentColor-c53f695f.js";import{g as Ae}from"./rifm-bdef253e.js";import{S as We}from"./_StoriesComponents-152d52c7.js";import"./extends-98964cd2.js";import"./_commonjsHelpers-042e6b4d.js";import"./colors-298625c7.js";import"./Svg-c3c146c4.js";import"./Pressable-912f514b.js";import"./index-c1bfc883.js";import"./useResponsive-a7b20045.js";import"./BottomPanel-034798f7.js";import"./commonStyles-d52fedae.js";import"./useBodyClassName-27d97f40.js";import"./math-b9695d7b.js";import"./FocusTrap-de3fd98b.js";import"./array-b3630b94.js";import"./LoadingView-23ab85ed.js";import"./Portal-8c029158.js";import"./index-8ce4a492.js";import"./index-6e5c097a.js";import"./v4-a960c1f4.js";import"./Fill-0b777f41.js";const H=pe.create({selected:{color:N.gray[500]},list:{paddingVertical:20,marginVertical:4,minWidth:250,overflow:"hidden"},item:{display:"flex",paddingHorizontal:24,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},itemHovered:{backgroundColor:N.gray[50]},availableFiltersTitle:{...be.bodyLarge,color:N.current[500],paddingHorizontal:24},filterName:{...be.bodySmall}});function ne({filters:a,openFilters:t,label:f,title:l,availableFilters:u,large:v=!0,onAddFilter:g}){const i=s.useRef(null),[S,{close:h,toggle:w}]=U(!1);return I(ke,{children:[n(ve,{direction:"row",justifyContent:"start",alignItems:"center",children:n(ae,{size:"small",mode:"secondary",color:"gray",onPress:w,ref:i,icon:v?"chevron-down-filled":"filter-filled",iconPosition:"end",ariaLabel:f,children:v?f:null})}),n(Y,{role:"listbox",matchReferenceMinWidth:!0,onDismiss:h,referenceRef:i,returnFocus:!1,visible:S,children:I(O,{style:H.list,children:[n($,{style:H.availableFiltersTitle,children:l}),n(L,{height:8}),n(me,{role:"list",data:u,keyExtractor:(y,o)=>`filter-item-${o}`,renderItem:({item:y})=>{const o=!!a[y.name]||t.includes(y.name);return I(ie,{style:({hovered:p})=>[H.item,p&&H.itemHovered],role:"button",disabled:o,onPress:()=>{g(y.name),h()},children:[n($,{style:[H.filterName,o&&H.selected],children:y.label}),o&&n(qe,{color:N.positive[500],name:"checkmark-filled",size:14})]})}})]})})]})}try{ne.displayName="FilterChooser",ne.__docgenInfo={description:"",displayName:"FilterChooser",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<Record<FilterName, unknown>>"}},openFilters:{defaultValue:null,description:"",name:"openFilters",required:!0,type:{name:"FilterName[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},availableFilters:{defaultValue:null,description:"",name:"availableFilters",required:!0,type:{name:"{ label: string; name: FilterName; }[]"}},large:{defaultValue:{value:"true"},description:"",name:"large",required:!1,type:{name:"boolean"}},onAddFilter:{defaultValue:null,description:"",name:"onAddFilter",required:!0,type:{name:"(filterName: FilterName) => void"}}}}}catch{}function z(){return z=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var f=arguments[t];for(var l in f)Object.prototype.hasOwnProperty.call(f,l)&&(a[l]=f[l])}return a},z.apply(this,arguments)}var He=typeof window>"u"?s.useEffect:s.useLayoutEffect,Ne=function(a){return a},Fe=function(){},we=function(a){return typeof a=="function"?a():a},se=function(a){return!!a&&(typeof a=="object"||typeof a=="function")&&typeof a.then=="function"},Te=function(a,t){return t.every(function(f){return a[f]!==void 0})},Ke=function(a){var t=s.useReducer(function(){return[]},[])[1],f=s.useRef(!1),l=s.useRef(a),u=s.useRef("untouched");He(function(){l.current=a}),s.useEffect(function(){return f.current=!0,function(){f.current=!1}},[]);var v=s.useRef(),g=s.useRef(),i=s.useRef(),S=s.useRef(),h=s.useRef(),w=s.useRef(),y=s.useRef(),o=s.useMemo(function(){var C=function(e){return we(l.current[e].initialValue)},m=function(e){var r;return(r=l.current[e].sanitize)!=null?r:Ne},E=function(e){var r;return(r=l.current[e].validate)!=null?r:Fe},P=function(e){return i.current[e]},F=function(e,r){var d=v.current[e],c=typeof r=="function"?r({value:d.exposed.value,talkative:d.talkative,validity:d.validity}):r,q=c.talkative&&c.validity.tag!=="unknown"?{validating:c.validity.tag==="validating",valid:c.validity.tag==="valid",error:c.validity.tag==="invalid"?c.validity.error:void 0}:{validating:!1,valid:!E(e),error:void 0};v.current[e]={talkative:c.talkative,validity:c.validity,exposed:z({},q,{value:c.value})}},b=function(e){var r=h.current[e],d=r!==void 0;return d&&(clearTimeout(r),h.current[e]=void 0),d},K=function(e){g.current[e].forEach(function(r){return r()})},k=function(e,r){var d=function(c){var q;return(q=l.current[c].strategy)!=null?q:"onSuccessOrBlur"}(e);r&&!r.some(function(c){return d===c})||F(e,function(c){return z({},c,{talkative:!0})})},B=function(e){F(e,function(r){return z({},r,{validity:{tag:"validating"}})})},ue=function(e,r){F(e,function(d){return z({},d,{validity:r!==void 0?{tag:"invalid",error:r}:{tag:"valid"}})})},J=function(e,r){r===void 0&&(r={});var d=v.current[e].exposed;return r.sanitize?z({},d,{value:m(e)(d.value)}):d},A=function(e){var r=b(e),d=m(e),c=E(e),q=d(v.current[e].exposed.value),M=c(q,{getFieldState:J,focusField:Q});if(!se(M)){var j=M;return j===void 0&&k(e,["onSuccess","onSuccessOrBlur"]),ue(e,j),K(e),j}return r||(B(e),K(e)),M.then(function(_){var X=function(D){var W;return(W=l.current[D].equalityFn)!=null?W:Object.is}(e),T=d(v.current[e].exposed.value);if(X(q,T))return _===void 0&&k(e,["onSuccess","onSuccessOrBlur"]),ue(e,_),K(e),_}).catch(function(_){})},Q=function(e){var r=S.current[e];r.current&&typeof r.current.focus=="function"&&r.current.focus()},ye=function(e,r){r===void 0&&(r={}),b(e),F(e,function(d){return{value:r.feedbackOnly?d.value:C(e),talkative:!1,validity:{tag:"unknown"}}}),K(e)},he=function(e,r){var d=e[r.findIndex(function(c){return c!==void 0})];d!==void 0&&Q(d)},G=function(e,r){se(e)?(t(),e.finally(function(){u.current="submitted",f.current&&t()})):(u.current="submitted",r&&t())};return{getFieldState:J,setFieldValue:function(e,r,d){d===void 0&&(d={}),F(e,function(c){return z({},c,{value:r})}),d.validate&&k(e),A(e)},setFieldError:function(e,r){ue(e,r),k(e),K(e)},focusField:Q,resetField:ye,validateField:function(e){return P(e)?(k(e),Promise.resolve(A(e))):Promise.resolve(void 0)},listenFields:function(e,r){var d=function(){r(e.reduce(function(c,q){return c[q]=J(q),c},{}))};return e.forEach(function(c){return g.current[c].add(d)}),function(){e.forEach(function(c){return g.current[c].delete(d)})}},resetForm:function(e){e===void 0&&(e={}),Object.keys(l.current).forEach(function(r){return ye(r,e)}),e.feedbackOnly||(u.current="untouched"),t()},submitForm:function(e,r,d){if(r===void 0&&(r=Fe),d===void 0&&(d={}),u.current!=="submitting"){var c=u.current==="editing";u.current="submitting";var q=Object.keys(i.current).filter(function(T){return i.current[T]}),M={},j={},_=[],X=!d.avoidFocusOnError;if(q.forEach(function(T,D){k(T),M[T]=J(T,{sanitize:!0}).value,_[D]=A(T)}),function(T){return T.every(function(D){return!se(D)})}(_))return _.every(function(T){return T===void 0})?G(e(M),c):(X&&he(q,_),q.forEach(function(T,D){j[T]=_[D]}),G(r(j),c));t(),Promise.all(_.map(function(T){return Promise.resolve(T)})).then(function(T){var D=T;return D.every(function(W){return W===void 0})?G(e(M),c):(X&&he(q,D),q.forEach(function(W,Pe){j[W]=D[Pe]}),G(r(j),c))}).finally(function(){u.current="submitted",f.current&&t()})}},setState:F,getOnChange:function(e){return function(r){var d=function(c){var q;return(q=l.current[c].debounceInterval)!=null?q:0}(e);F(e,function(c){return z({},c,{value:r})}),k(e,["onChange"]),b(e),u.current!=="untouched"&&u.current!=="submitted"||(u.current="editing",t()),d!==0?(B(e),K(e),h.current[e]=setTimeout(function(){P(e)?A(e):b(e)},d)):A(e)}},getOnBlur:function(e){return function(){v.current[e].validity.tag==="unknown"||function(r){return v.current[r].talkative}(e)||(k(e,["onBlur","onSuccessOrBlur"]),A(e))}},getFocusNextField:function(e){return function(){var r=Object.keys(l.current),d=r.findIndex(function(q){return q===e});if(d!==void 0){var c=r[d+1];c!==void 0&&Q(c)}}}}},[]);if(!v.current){for(var p in v.current={},g.current={},i.current={},S.current={},h.current={},l.current)Object.prototype.hasOwnProperty.call(l.current,p)&&(o.setState(p,{value:we(l.current[p].initialValue),talkative:!1,validity:{tag:"unknown"}}),g.current[p]=new Set,i.current[p]=!1,S.current[p]={current:null},h.current[p]=void 0);var R=function(C){var m=C.name,E=C.children,P=s.useMemo(function(){return{getSnapshot:function(){return v.current[m]},subscribe:function(b){return g.current[m].add(b),function(){g.current[m].delete(b)}}}},[m]),F=P.getSnapshot;return ge.useSyncExternalStore(P.subscribe,F,F),s.useEffect(function(){var b=!i.current[m];return b&&(i.current[m]=!0),function(){b&&(i.current[m]=!1)}},[m]),E(z({},o.getFieldState(m),{ref:S.current[m],focusNextField:s.useMemo(function(){return o.getFocusNextField(m)},[m]),onBlur:s.useMemo(function(){return o.getOnBlur(m)},[m]),onChange:s.useMemo(function(){return o.getOnChange(m)},[m])}))};R.displayName="Field",w.current=R;var x=function(C){var m=C.names,E=C.children,P=s.useMemo(function(){return{getSnapshot:function(){return JSON.stringify(m.map(function(b){return v.current[b]}))},subscribe:function(b){return m.forEach(function(K){return g.current[K].add(b)}),function(){m.forEach(function(K){return g.current[K].delete(b)})}}}},[JSON.stringify(m)]),F=P.getSnapshot;return ge.useSyncExternalStore(P.subscribe,F,F),E(m.reduce(function(b,K){return b[K]=o.getFieldState(K),b},{}))};x.displayName="FieldsListener",y.current=x}return{formStatus:u.current,Field:w.current,FieldsListener:y.current,getFieldState:o.getFieldState,setFieldValue:o.setFieldValue,setFieldError:o.setFieldError,focusField:o.focusField,resetField:o.resetField,validateField:o.validateField,listenFields:o.listenFields,resetForm:o.resetForm,submitForm:o.submitForm}};const $e=pe.create({wrap:{flexWrap:"wrap"}}),de=s.forwardRef(({children:a,space:t,wrap:f=!1,...l},u)=>{const{direction:v="column"}=l,g=v==="row"||v==="rowReverse";return n(ve,{style:f&&$e.wrap,ref:u,...l,children:s.Children.map(a,(i,S)=>Ie(i)?i:I(s.Fragment,{children:[S!==0&&(g?n(L,{width:t}):n(L,{height:t})),i]}))})});try{de.displayName="Stack",de.__docgenInfo={description:"",displayName:"Stack",props:{role:{defaultValue:null,description:"",name:"role",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"grid"'},{value:'"row"'},{value:'"cell"'},{value:'"alert"'},{value:'"alertdialog"'},{value:'"application"'},{value:'"article"'},{value:'"banner"'},{value:'"button"'},{value:'"checkbox"'},{value:'"columnheader"'},{value:'"combobox"'},{value:'"complementary"'},{value:'"contentinfo"'},{value:'"definition"'},{value:'"dialog"'},{value:'"directory"'},{value:'"document"'},{value:'"feed"'},{value:'"figure"'},{value:'"form"'},{value:'"group"'},{value:'"heading"'},{value:'"img"'},{value:'"link"'},{value:'"list"'},{value:'"listitem"'},{value:'"log"'},{value:'"main"'},{value:'"marquee"'},{value:'"math"'},{value:'"menu"'},{value:'"menubar"'},{value:'"menuitem"'},{value:'"meter"'},{value:'"navigation"'},{value:'"note"'},{value:'"option"'},{value:'"presentation"'},{value:'"progressbar"'},{value:'"radio"'},{value:'"radiogroup"'},{value:'"region"'},{value:'"rowgroup"'},{value:'"rowheader"'},{value:'"scrollbar"'},{value:'"searchbox"'},{value:'"separator"'},{value:'"slider"'},{value:'"spinbutton"'},{value:'"status"'},{value:'"summary"'},{value:'"switch"'},{value:'"tab"'},{value:'"table"'},{value:'"tablist"'},{value:'"tabpanel"'},{value:'"term"'},{value:'"timer"'},{value:'"toolbar"'},{value:'"tooltip"'},{value:'"tree"'},{value:'"treegrid"'},{value:'"treeitem"'},{value:'"blockquote"'},{value:'"code"'},{value:'"deletion"'},{value:'"emphasis"'},{value:'"insertion"'},{value:'"label"'},{value:'"paragraph"'},{value:'"strong"'},{value:'"gridcell"'},{value:'"listbox"'},{value:'"menuitemcheckbox"'},{value:'"menuitemradio"'},{value:'"textbox"'}]}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyDownCapture:{defaultValue:null,description:"",name:"onKeyDownCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUp:{defaultValue:null,description:"",name:"onKeyUp",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUpCapture:{defaultValue:null,description:"",name:"onKeyUpCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},tabIndex:{defaultValue:null,description:"Additional accessibility props",name:"tabIndex",required:!1,type:{name:"enum",value:[{value:"0"},{value:"-1"}]}},"aria-activedescendant":{defaultValue:null,description:`Aria props (additional, minus existants)
@see https://necolas.github.io/react-native-web/docs/accessibility
@see https://reactnative.dev/docs/accessibility#aria-valuemax`,name:"aria-activedescendant",required:!1,type:{name:"string"}},"aria-atomic":{defaultValue:null,description:"",name:"aria-atomic",required:!1,type:{name:"boolean"}},"aria-autocomplete":{defaultValue:null,description:"",name:"aria-autocomplete",required:!1,type:{name:"string"}},"aria-colcount":{defaultValue:null,description:"",name:"aria-colcount",required:!1,type:{name:"number"}},"aria-colindex":{defaultValue:null,description:"",name:"aria-colindex",required:!1,type:{name:"number"}},"aria-colspan":{defaultValue:null,description:"",name:"aria-colspan",required:!1,type:{name:"number"}},"aria-controls":{defaultValue:null,description:"",name:"aria-controls",required:!1,type:{name:"string"}},"aria-current":{defaultValue:null,description:"",name:"aria-current",required:!1,type:{name:'boolean | "page" | "step" | "location" | "date" | "time"'}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-details":{defaultValue:null,description:"",name:"aria-details",required:!1,type:{name:"string"}},"aria-errormessage":{defaultValue:null,description:"",name:"aria-errormessage",required:!1,type:{name:"string"}},"aria-flowto":{defaultValue:null,description:"",name:"aria-flowto",required:!1,type:{name:"string"}},"aria-haspopup":{defaultValue:null,description:"",name:"aria-haspopup",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:"boolean"}},"aria-keyshortcuts":{defaultValue:null,description:"",name:"aria-keyshortcuts",required:!1,type:{name:"string"}},"aria-level":{defaultValue:null,description:"",name:"aria-level",required:!1,type:{name:"number"}},"aria-multiline":{defaultValue:null,description:"",name:"aria-multiline",required:!1,type:{name:"boolean"}},"aria-multiselectable":{defaultValue:null,description:"",name:"aria-multiselectable",required:!1,type:{name:"boolean"}},"aria-orientation":{defaultValue:null,description:"",name:"aria-orientation",required:!1,type:{name:"enum",value:[{value:'"horizontal"'},{value:'"vertical"'}]}},"aria-owns":{defaultValue:null,description:"",name:"aria-owns",required:!1,type:{name:"string"}},"aria-placeholder":{defaultValue:null,description:"",name:"aria-placeholder",required:!1,type:{name:"string"}},"aria-posinset":{defaultValue:null,description:"",name:"aria-posinset",required:!1,type:{name:"number"}},"aria-pressed":{defaultValue:null,description:"",name:"aria-pressed",required:!1,type:{name:"boolean"}},"aria-readonly":{defaultValue:null,description:"",name:"aria-readonly",required:!1,type:{name:"boolean"}},"aria-required":{defaultValue:null,description:"",name:"aria-required",required:!1,type:{name:"boolean"}},"aria-roledescription":{defaultValue:null,description:"",name:"aria-roledescription",required:!1,type:{name:"string"}},"aria-rowcount":{defaultValue:null,description:"",name:"aria-rowcount",required:!1,type:{name:"number"}},"aria-rowindex":{defaultValue:null,description:"",name:"aria-rowindex",required:!1,type:{name:"number"}},"aria-rowspan":{defaultValue:null,description:"",name:"aria-rowspan",required:!1,type:{name:"number"}},"aria-setsize":{defaultValue:null,description:"",name:"aria-setsize",required:!1,type:{name:"number"}},"aria-sort":{defaultValue:null,description:"",name:"aria-sort",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"ascending"'},{value:'"descending"'},{value:'"other"'}]}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"enum",value:[{value:'"baseline"'},{value:'"start"'},{value:'"end"'},{value:'"center"'},{value:'"stretch"'}]}},direction:{defaultValue:null,description:"",name:"direction",required:!1,type:{name:"enum",value:[{value:'"row"'},{value:'"column"'},{value:'"columnReverse"'},{value:'"rowReverse"'}]}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'},{value:'"normal"'},{value:'"spaceBetween"'},{value:'"spaceAround"'},{value:'"spaceEvenly"'}]}},space:{defaultValue:null,description:"",name:"space",required:!1,type:{name:"enum",value:[{value:"4"},{value:"8"},{value:"12"},{value:"16"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},wrap:{defaultValue:{value:"false"},description:"",name:"wrap",required:!1,type:{name:"boolean"}}}}}catch{}const V=pe.create({container:{paddingRight:12,paddingBottom:8},shadowed:{position:"absolute",opacity:0,width:"100%",height:"100%",borderRadius:4,boxShadow:Oe.tile,transitionDuration:"150ms",transitionProperty:"opacity"},hovered:{opacity:1},dropdown:{maxHeight:400,minWidth:200},itemHovered:{backgroundColor:N.gray[50]},content:{paddingVertical:12},inputContent:{padding:24},radio:{display:"flex",flexDirection:"row",alignItems:"center",height:32,paddingHorizontal:24},itemLabel:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},input:{minWidth:200},value:{maxWidth:130,whiteSpace:"nowrap"},buttonContainer:{paddingHorizontal:_e[24]}}),le=s.forwardRef(({onPress:a,onPressRemove:t,label:f,value:l="",isActive:u},v)=>{const g=s.useRef(null),i=ze(g,v);return n(ie,{ref:i,onPress:a,children:({hovered:S})=>I(ke,{children:[n(O,{style:[V.shadowed,S&&V.hovered]}),n(Ce,{label:f,color:"current",onPressRemove:t,children:I(ve,{direction:"row",alignItems:"center",children:[n($,{numberOfLines:1,style:V.value,children:l}),n(L,{width:4}),n(qe,{color:N.current.primary,name:u?"chevron-up-filled":"chevron-down-filled",size:16})]})})]})})});function Ue({label:a,items:t,width:f,value:l,onValueChange:u,onPressRemove:v,autoOpen:g=!1}){const i=s.useRef(null),[S,{close:h,toggle:w}]=U(g),y=s.useMemo(()=>t.find(o=>o.value===l),[t,l]);return I(O,{style:V.container,children:[n(le,{label:a,onPress:w,ref:i,onPressRemove:v,isActive:S,value:y==null?void 0:y.label}),n(Y,{role:"listbox",matchReferenceWidth:!1,onDismiss:h,referenceRef:i,returnFocus:!1,visible:S,children:n(O,{style:[V.dropdown,{width:f}],children:n(me,{role:"list",data:t,contentContainerStyle:V.content,keyExtractor:(o,p)=>`filter-item-${p}`,renderItem:({item:o})=>{const p=l===o.value;return I(ie,{role:"radio","aria-checked":p,style:({hovered:R})=>[V.radio,R&&V.itemHovered],onPress:()=>{u(o.value),h()},children:[n(je,{value:p}),n(L,{width:12}),n($,{style:V.itemLabel,children:o.label})]})}})})})]})}function Ye({label:a,items:t,width:f,checkAllLabel:l,value:u,onValueChange:v,applyButtonLabel:g,onPressRemove:i,autoOpen:S=!1}){const h=s.useRef(null),[w,{close:y,toggle:o}]=U(S),[p,R]=s.useState(u),x=s.useMemo(()=>new Set(p),[p]),C=s.useMemo(()=>t.filter(F=>x.has(F.value)),[t,x]),m=l!=null&&x.size===t.length,E=s.useMemo(()=>{if(l==null)return t;const F=x.size===0?!1:x.size===t.length?!0:"mixed";return[{label:l,checked:F},...t]},[t,l,x]),P=s.useCallback(()=>{v(p),y()},[v,p,y]);return s.useEffect(()=>{w||R(u)},[w,u]),I(O,{style:V.container,children:[n(le,{label:a,onPress:o,ref:h,onPressRemove:i,isActive:w,value:m?l:C.map(F=>F.label).join(", ")}),n(Y,{role:"listbox",matchReferenceWidth:!1,onDismiss:y,referenceRef:h,returnFocus:!1,visible:w,children:I(O,{style:[V.dropdown,{width:f}],children:[n(me,{role:"list",data:E,contentContainerStyle:V.content,keyExtractor:(F,b)=>`filter-item-${b}`,renderItem:({item:F})=>{const b=ce(F).with({checked:Z.any},({checked:k})=>k).with({value:Z.any},({value:k})=>x.has(k)).exhaustive(),K=ce(F).with({checked:Z.any},({checked:k})=>()=>{R(k===!0?void 0:t.map(B=>B.value))}).with({value:Z.any},({value:k})=>()=>{const B=new Set([...x]);b===!0?B.delete(k):B.add(k),B.size===0?R(void 0):R([...B])}).exhaustive();return I(ie,{role:"radio","aria-checked":b,style:({hovered:k})=>[V.radio,k&&V.itemHovered],onPress:K,children:[n(Le,{value:b}),n(L,{width:12}),n($,{style:V.itemLabel,children:F.label})]})}}),n(L,{height:8}),n(O,{style:V.buttonContainer,children:n(ae,{color:"current",onPress:P,children:g})}),n(L,{height:24})]})})]})}function Je({label:a,initialValue:t,noValueText:f,submitText:l,dateFormat:u,rifmProps:v,validate:g,onSave:i,onPressRemove:S,autoOpen:h=!1}){const w=s.useRef(null),[y,{close:o,toggle:p}]=U(h),{Field:R,submitForm:x,setFieldValue:C}=Ke({date:{initialValue:oe(t)?ee(t).format(u):"",validate:g}});s.useEffect(()=>{C("date",oe(t)?ee(t).format(u):"")},[t,u,C]);const m=()=>{x(E=>{if(Te(E,["date"])){const P=ee(E.date,u,!0).toJSON();i(P),o()}})};return I(O,{style:V.container,children:[n(le,{label:a,onPress:p,ref:w,onPressRemove:S,isActive:y,value:oe(t)?ee(t).format(u):f}),n(Y,{role:"listbox",matchReferenceWidth:!1,onDismiss:o,referenceRef:w,returnFocus:!1,visible:y,children:I(O,{style:[V.dropdown,V.inputContent],children:[n(R,{name:"date",children:({value:E,onChange:P,error:F})=>n(De,{value:E,onChange:P,...v,children:({value:b,onChange:K})=>n(Re,{label:a,render:k=>n(Ee,{nativeID:k,error:F,style:V.input,placeholder:u,value:b,onChange:K})})})}),n(ae,{color:"current",size:"small",onPress:m,children:l})]})})]})}function Qe({label:a,initialValue:t="",noValueText:f,submitText:l,autoOpen:u=!1,placeholder:v,validate:g,onSave:i,onPressRemove:S}){const h=s.useRef(null),[w,{close:y,toggle:o}]=U(u),[p,R]=s.useState(t),{Field:x,submitForm:C}=Ke({input:{initialValue:t,validate:g}}),m=()=>{C(E=>{Te(E,["input"])&&(R(E.input),i(E.input),y())})};return I(O,{style:V.container,children:[n(le,{label:a,onPress:o,ref:h,onPressRemove:S,isActive:w,value:p===""?f:p}),n(Y,{role:"listbox",matchReferenceWidth:!1,onDismiss:y,referenceRef:h,returnFocus:!1,visible:w,children:I(O,{style:[V.dropdown,V.inputContent],children:[n(x,{name:"input",children:({error:E,value:P,onChange:F})=>n(Re,{label:a,render:b=>n(Ee,{nativeID:b,error:E,style:V.input,placeholder:v,value:P,onChangeText:F})})}),n(ae,{size:"small",color:"current",onPress:m,children:l})]})})]})}function Ge({children:a,onAdd:t,onPressRemove:f}){return s.useEffect(t,[]),n(Ce,{color:"current",onPressRemove:f,children:a})}const te=(a,t,f)=>t[f],fe=({filters:a,openedFilters:t,definition:f,onChangeOpened:l,onChangeFilters:u})=>{const v=Be(t),g=t.length>v.length?t[t.length-1]:void 0;return t.length===0?null:n(de,{direction:"row",wrap:!0,children:t.map(i=>{const S=f[i];return typeof i!="string"||S==null?null:n(O,{children:ce(S).with({type:"radio"},({type:h,label:w,items:y,width:o})=>n(Ue,{label:w,items:y,width:o,autoOpen:g===i,onPressRemove:()=>{u({...a,[i]:void 0}),l(t.filter(p=>p!==i))},value:te(h,a,i),onValueChange:p=>u({...a,[i]:p})})).with({type:"checkbox"},({type:h,label:w,items:y,width:o,checkAllLabel:p,submitText:R})=>n(Ye,{label:w,items:y,width:o,checkAllLabel:p,autoOpen:g===i,applyButtonLabel:R,value:te(h,a,i),onValueChange:x=>u({...a,[i]:x}),onPressRemove:()=>{u({...a,[i]:void 0}),l(t.filter(x=>x!==i))}})).with({type:"date"},({type:h,label:w,noValueText:y,submitText:o,dateFormat:p,rifmProps:R,validate:x})=>n(Je,{label:w,noValueText:y,submitText:o,autoOpen:g===i,dateFormat:p,rifmProps:R,validate:x,initialValue:te(h,a,i),onSave:C=>u({...a,[i]:C}),onPressRemove:()=>{u({...a,[i]:void 0}),l(t.filter(C=>C!==i))}})).with({type:"input"},({type:h,label:w,placeholder:y,noValueText:o,submitText:p,validate:R})=>n(Qe,{label:w,placeholder:y,noValueText:o,submitText:p,autoOpen:g===i,validate:R,initialValue:te(h,a,i),onSave:x=>u({...a,[i]:x}),onPressRemove:()=>{u({...a,[i]:void 0}),l(t.filter(x=>x!==i))}})).with({type:"boolean"},({label:h})=>n(Ge,{onAdd:()=>{u({...a,[i]:!0})},onPressRemove:()=>{u({...a,[i]:void 0}),l(t.filter(w=>w!==i))},children:h})).exhaustive()},i)})})};try{fe.displayName="FiltersStack",fe.__docgenInfo={description:"",displayName:"FiltersStack",props:{definition:{defaultValue:null,description:"",name:"definition",required:!0,type:{name:"FiltersDefinition"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"{ [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }"}},openedFilters:{defaultValue:null,description:"",name:"openedFilters",required:!0,type:{name:"(keyof T)[]"}},onChangeOpened:{defaultValue:null,description:"",name:"onChangeOpened",required:!0,type:{name:"(value: (keyof T)[]) => void"}},onChangeFilters:{defaultValue:null,description:"",name:"onChangeFilters",required:!0,type:{name:"(value: { [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }) => void"}}}}}catch{}const Xe=Ae({accept:"numeric",charMap:{2:"/",4:"/"},maxLength:8}),Ze={type:"radio",label:"Mode",items:[{label:"QES",value:"QES"},{label:"Expert",value:"Expert"}]},et={type:"checkbox",label:"Status",submitText:"Apply",items:[{label:"Accepted",value:"Accepted"},{label:"Canceled",value:"Canceled"},{label:"Failed",value:"Failed"},{label:"Expired",value:"Expired"},{label:"CustomerRefused",value:"CustomerRefused"}]},tt={type:"date",label:"Start Date",submitText:"Save",noValueText:"None",dateFormat:"DD/MM/YYYY",rifmProps:Xe},rt={type:"input",label:"Resource ID",noValueText:"None",submitText:"Save",placeholder:"Placeholder..."},nt={mode:Ze,status:et,startDate:tt,resourceId:rt},at=[{name:"mode",label:"Mode"},{name:"status",label:"Status"},{name:"startDate",label:"Start date"},{name:"resourceId",label:"Ressource ID"}],Ut={title:"Forms/Filter",component:ne},re=()=>{const[a,t]=s.useState([]),[f,l]=s.useState({mode:void 0,status:void 0,resourceId:void 0,startDate:void 0});return n(We,{title:"Filter",children:n(Me,{variant:"live",children:I(O,{children:[n(ne,{filters:f,label:"Choose filters",title:"Filters",onAddFilter:u=>t(v=>[...v,u]),availableFilters:at,openFilters:a}),n(L,{height:8}),n(fe,{definition:nt,filters:f,openedFilters:a,onChangeFilters:l,onChangeOpened:t})]})})})};var xe,Ve,Se;re.parameters={...re.parameters,docs:{...(xe=re.parameters)==null?void 0:xe.docs,source:{originalSource:`() => {
  const [openFilters, setOpenFilters] = useState<(keyof State)[]>([]);
  const [filters, setFilters] = useState<State>({
    mode: undefined,
    status: undefined,
    resourceId: undefined,
    startDate: undefined
  });
  return <StoryBlock title="Filter">
      <WithCurrentColor variant="live">
        <View>
          <FilterChooser filters={filters} label="Choose filters" title="Filters" onAddFilter={filter => setOpenFilters(filters => [...filters, filter])} availableFilters={availableFilters} openFilters={openFilters} />

          <Space height={8} />

          <FiltersStack definition={definition} filters={filters} openedFilters={openFilters} onChangeFilters={setFilters} onChangeOpened={setOpenFilters} />
        </View>
      </WithCurrentColor>
    </StoryBlock>;
}`,...(Se=(Ve=re.parameters)==null?void 0:Ve.docs)==null?void 0:Se.source}}};const Yt=["All"];export{re as All,Yt as __namedExportsOrder,Ut as default};
//# sourceMappingURL=Filter.stories-a857eae8.js.map
