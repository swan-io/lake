import{S as de,c as H,j as O,F as ke,a as i,V as I,T as N,b as j,h as Ke,e as Oe,s as Pe,i as le}from"./Space-65f9bfa9.js";import{r as o}from"./index-8db94870.js";import{t as be}from"./typography-6ad07e3d.js";import{u as J,P as re}from"./Popover-c2e3d2c8.js";import{B as fe,K as oe,S as G}from"./index-5dcf0b89.js";import{I as qe}from"./Icon-4e86e06c.js";import{L as pe}from"./LakeButton-bed23784.js";import{F as ve}from"./index-2379b1a9.js";import{P as ne}from"./index-da7d3046.js";import{d as X}from"./dayjs.min-49185a9c.js";import{s as ge}from"./index-302a0035.js";import{a as Ie}from"./useMergeRefs-5d4c6491.js";import{u as _e}from"./TransitionView-e9c85895.js";import{b as De}from"./DatePicker-3258b1fc.js";import{L as Be}from"./LakeCheckbox-848c664c.js";import{L as je}from"./LakeLabel-6151c738.js";import{L as ze}from"./LakeRadio-751a77c0.js";import{L as Me}from"./LakeTextInput-494abc41.js";import{T as Ee}from"./Tag-9937c443.js";import{W as Le}from"./WithCurrentColor-41bea5ae.js";import{S as Ae}from"./_StoriesComponents-9f567819.js";import"./extends-98964cd2.js";import"./_commonjsHelpers-042e6b4d.js";import"./colors-298625c7.js";import"./useResponsive-57a84c0b.js";import"./BottomPanel-78f9e8ed.js";import"./commonStyles-d52fedae.js";import"./useBodyClassName-27d97f40.js";import"./math-e2f11545.js";import"./FocusTrap-269094b2.js";import"./array-b3630b94.js";import"./LoadingView-a1303365.js";import"./index-2930334e.js";import"./Portal-e966a77e.js";import"./index-8ce4a492.js";import"./index-186348e9.js";import"./Svg-7871e2fb.js";import"./Pressable-2163c0dc.js";import"./Boxed-b55f7b9d.js";import"./function-841632b4.js";import"./rifm-8dee749e.js";import"./Fill-24da9952.js";import"./LakeModal-32dccbca.js";import"./LakeHeading-627b7829.js";import"./ResponsiveContainer-eb20e0c2.js";import"./LakeSelect-bafb4765.js";import"./v4-a960c1f4.js";const W=de.create({selected:{color:H.gray[500]},list:{paddingVertical:20,marginVertical:4,minWidth:250,overflow:"hidden"},item:{display:"flex",paddingHorizontal:24,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},itemHovered:{backgroundColor:H.gray[50]},availableFiltersTitle:{...be.bodyLarge,color:H.current[500],paddingHorizontal:24},filterName:{...be.bodySmall}});function te({filters:r,openFilters:a,label:s,title:l,availableFilters:d,large:v=!0,onAddFilter:h}){const n=o.useRef(null),[x,{close:m,toggle:g}]=J(!1);return O(ke,{children:[i(fe,{direction:"row",justifyContent:"start",alignItems:"center",children:i(pe,{size:"small",mode:"secondary",color:"gray",onPress:g,ref:n,icon:v?"chevron-down-filled":"filter-filled",iconPosition:"end",ariaLabel:s,children:v?s:null})}),i(re,{role:"listbox",matchReferenceMinWidth:!0,onDismiss:m,referenceRef:n,returnFocus:!1,visible:x,children:O(I,{style:W.list,children:[i(N,{style:W.availableFiltersTitle,children:l}),i(j,{height:8}),i(ve,{role:"list",data:d,keyExtractor:(y,u)=>`filter-item-${u}`,renderItem:({item:y})=>{const u=!!r[y.name]||a.includes(y.name);return O(ne,{style:({hovered:b})=>[W.item,b&&W.itemHovered],role:"button",disabled:u,onPress:()=>{h(y.name),m()},children:[i(N,{style:[W.filterName,u&&W.selected],children:y.label}),u&&i(qe,{color:H.positive[500],name:"checkmark-filled",size:14})]})}})]})})]})}try{te.displayName="FilterChooser",te.__docgenInfo={description:"",displayName:"FilterChooser",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<Record<FilterName, unknown>>"}},openFilters:{defaultValue:null,description:"",name:"openFilters",required:!0,type:{name:"FilterName[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},availableFilters:{defaultValue:null,description:"",name:"availableFilters",required:!0,type:{name:"{ label: string; name: FilterName; }[]"}},large:{defaultValue:{value:"true"},description:"",name:"large",required:!1,type:{name:"boolean"}},onAddFilter:{defaultValue:null,description:"",name:"onAddFilter",required:!0,type:{name:"(filterName: FilterName) => void"}}}}}catch{}function B(){return B=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])}return r},B.apply(this,arguments)}var We=typeof window>"u"?o.useEffect:o.useLayoutEffect,He=function(r){return r},Fe=function(){},we=function(r){return typeof r=="function"?r():r},ue=function(r){return!!r&&(typeof r=="object"||typeof r=="function")&&typeof r.then=="function"},Re=function(r,a){return a.every(function(s){return r[s]!==void 0})},Te=function(r){var a=o.useReducer(function(){return[]},[])[1],s=o.useRef(!1),l=o.useRef(r),d=o.useRef("untouched");We(function(){l.current=r}),o.useEffect(function(){return s.current=!0,function(){s.current=!1}},[]);var v=o.useRef(),h=o.useRef(),n=o.useRef(),x=o.useRef(),m=o.useRef(),g=o.useRef(),y=o.useRef(),u=o.useMemo(function(){var K=function(e){return we(l.current[e].initialValue)},p=function(e){var t;return(t=l.current[e].sanitize)!=null?t:He},q=function(e){var t;return(t=l.current[e].validate)!=null?t:Fe},k=function(e){return n.current[e]},F=function(e,t){var f=v.current[e],c=typeof t=="function"?t({value:f.exposed.value,talkative:f.talkative,validity:f.validity}):t,E=c.talkative&&c.validity.tag!=="unknown"?{validating:c.validity.tag==="validating",valid:c.validity.tag==="valid",error:c.validity.tag==="invalid"?c.validity.error:void 0}:{validating:!1,valid:!q(e),error:void 0};v.current[e]={talkative:c.talkative,validity:c.validity,exposed:B({},E,{value:c.value})}},w=function(e){var t=m.current[e],f=t!==void 0;return f&&(clearTimeout(t),m.current[e]=void 0),f},S=function(e){h.current[e].forEach(function(t){return t()})},C=function(e,t){var f=function(c){var E;return(E=l.current[c].strategy)!=null?E:"onSuccessOrBlur"}(e);t&&!t.some(function(c){return f===c})||F(e,function(c){return B({},c,{talkative:!0})})},me=function(e){F(e,function(t){return B({},t,{validity:{tag:"validating"}})})},ie=function(e,t){F(e,function(f){return B({},f,{validity:t!==void 0?{tag:"invalid",error:t}:{tag:"valid"}})})},$=function(e,t){t===void 0&&(t={});var f=v.current[e].exposed;return t.sanitize?B({},f,{value:p(e)(f.value)}):f},L=function(e){var t=w(e),f=p(e),c=q(e),E=f(v.current[e].exposed.value),M=c(E,{getFieldState:$,focusField:U});if(!ue(M)){var z=M;return z===void 0&&C(e,["onSuccess","onSuccessOrBlur"]),ie(e,z),S(e),z}return t||(me(e),S(e)),M.then(function(_){var Q=function(D){var A;return(A=l.current[D].equalityFn)!=null?A:Object.is}(e),T=f(v.current[e].exposed.value);if(Q(E,T))return _===void 0&&C(e,["onSuccess","onSuccessOrBlur"]),ie(e,_),S(e),_}).catch(function(_){})},U=function(e){var t=x.current[e];t.current&&typeof t.current.focus=="function"&&t.current.focus()},ye=function(e,t){t===void 0&&(t={}),w(e),F(e,function(f){return{value:t.feedbackOnly?f.value:K(e),talkative:!1,validity:{tag:"unknown"}}}),S(e)},he=function(e,t){var f=e[t.findIndex(function(c){return c!==void 0})];f!==void 0&&U(f)},Y=function(e,t){ue(e)?(a(),e.finally(function(){d.current="submitted",s.current&&a()})):(d.current="submitted",t&&a())};return{getFieldState:$,setFieldValue:function(e,t,f){f===void 0&&(f={}),F(e,function(c){return B({},c,{value:t})}),f.validate&&C(e),L(e)},setFieldError:function(e,t){ie(e,t),C(e),S(e)},focusField:U,resetField:ye,validateField:function(e){return k(e)?(C(e),Promise.resolve(L(e))):Promise.resolve(void 0)},listenFields:function(e,t){var f=function(){t(e.reduce(function(c,E){return c[E]=$(E),c},{}))};return e.forEach(function(c){return h.current[c].add(f)}),function(){e.forEach(function(c){return h.current[c].delete(f)})}},resetForm:function(e){e===void 0&&(e={}),Object.keys(l.current).forEach(function(t){return ye(t,e)}),e.feedbackOnly||(d.current="untouched"),a()},submitForm:function(e,t,f){if(t===void 0&&(t=Fe),f===void 0&&(f={}),d.current!=="submitting"){var c=d.current==="editing";d.current="submitting";var E=Object.keys(n.current).filter(function(T){return n.current[T]}),M={},z={},_=[],Q=!f.avoidFocusOnError;if(E.forEach(function(T,D){C(T),M[T]=$(T,{sanitize:!0}).value,_[D]=L(T)}),function(T){return T.every(function(D){return!ue(D)})}(_))return _.every(function(T){return T===void 0})?Y(e(M),c):(Q&&he(E,_),E.forEach(function(T,D){z[T]=_[D]}),Y(t(z),c));a(),Promise.all(_.map(function(T){return Promise.resolve(T)})).then(function(T){var D=T;return D.every(function(A){return A===void 0})?Y(e(M),c):(Q&&he(E,D),E.forEach(function(A,Ce){z[A]=D[Ce]}),Y(t(z),c))}).finally(function(){d.current="submitted",s.current&&a()})}},setState:F,getOnChange:function(e){return function(t){var f=function(c){var E;return(E=l.current[c].debounceInterval)!=null?E:0}(e);F(e,function(c){return B({},c,{value:t})}),C(e,["onChange"]),w(e),d.current!=="untouched"&&d.current!=="submitted"||(d.current="editing",a()),f!==0?(me(e),S(e),m.current[e]=setTimeout(function(){k(e)?L(e):w(e)},f)):L(e)}},getOnBlur:function(e){return function(){v.current[e].validity.tag==="unknown"||function(t){return v.current[t].talkative}(e)||(C(e,["onBlur","onSuccessOrBlur"]),L(e))}},getFocusNextField:function(e){return function(){var t=Object.keys(l.current),f=t.findIndex(function(E){return E===e});if(f!==void 0){var c=t[f+1];c!==void 0&&U(c)}}}}},[]);if(!v.current){for(var b in v.current={},h.current={},n.current={},x.current={},m.current={},l.current)Object.prototype.hasOwnProperty.call(l.current,b)&&(u.setState(b,{value:we(l.current[b].initialValue),talkative:!1,validity:{tag:"unknown"}}),h.current[b]=new Set,n.current[b]=!1,x.current[b]={current:null},m.current[b]=void 0);var V=function(K){var p=K.name,q=K.children,k=o.useMemo(function(){return{getSnapshot:function(){return v.current[p]},subscribe:function(w){return h.current[p].add(w),function(){h.current[p].delete(w)}}}},[p]),F=k.getSnapshot;return ge.useSyncExternalStore(k.subscribe,F,F),o.useEffect(function(){var w=!n.current[p];return w&&(n.current[p]=!0),function(){w&&(n.current[p]=!1)}},[p]),q(B({},u.getFieldState(p),{ref:x.current[p],focusNextField:o.useMemo(function(){return u.getFocusNextField(p)},[p]),onBlur:o.useMemo(function(){return u.getOnBlur(p)},[p]),onChange:o.useMemo(function(){return u.getOnChange(p)},[p])}))};V.displayName="Field",g.current=V;var P=function(K){var p=K.names,q=K.children,k=o.useMemo(function(){return{getSnapshot:function(){return JSON.stringify(p.map(function(w){return v.current[w]}))},subscribe:function(w){return p.forEach(function(S){return h.current[S].add(w)}),function(){p.forEach(function(S){return h.current[S].delete(w)})}}}},[JSON.stringify(p)]),F=k.getSnapshot;return ge.useSyncExternalStore(k.subscribe,F,F),q(p.reduce(function(w,S){return w[S]=u.getFieldState(S),w},{}))};P.displayName="FieldsListener",y.current=P}return{formStatus:d.current,Field:g.current,FieldsListener:y.current,getFieldState:u.getFieldState,setFieldValue:u.setFieldValue,setFieldError:u.setFieldError,focusField:u.focusField,resetField:u.resetField,validateField:u.validateField,listenFields:u.listenFields,resetForm:u.resetForm,submitForm:u.submitForm}};const Ne=de.create({wrap:{flexWrap:"wrap"}}),se=o.forwardRef(({children:r,space:a,wrap:s=!1,...l},d)=>{const{direction:v="column"}=l,h=v==="row"||v==="rowReverse";return i(fe,{style:s&&Ne.wrap,ref:d,...l,children:o.Children.map(r,(n,x)=>Ke(n)?n:O(o.Fragment,{children:[x!==0&&(h?i(j,{width:a}):i(j,{height:a})),n]}))})});try{se.displayName="Stack",se.__docgenInfo={description:"",displayName:"Stack",props:{role:{defaultValue:null,description:"",name:"role",required:!1,type:{name:"enum",value:[{value:'"row"'},{value:'"label"'},{value:'"form"'},{value:'"none"'},{value:'"grid"'},{value:'"cell"'},{value:'"alert"'},{value:'"alertdialog"'},{value:'"application"'},{value:'"article"'},{value:'"banner"'},{value:'"button"'},{value:'"checkbox"'},{value:'"columnheader"'},{value:'"combobox"'},{value:'"complementary"'},{value:'"contentinfo"'},{value:'"definition"'},{value:'"dialog"'},{value:'"directory"'},{value:'"document"'},{value:'"feed"'},{value:'"figure"'},{value:'"group"'},{value:'"heading"'},{value:'"img"'},{value:'"link"'},{value:'"list"'},{value:'"listitem"'},{value:'"log"'},{value:'"main"'},{value:'"marquee"'},{value:'"math"'},{value:'"menu"'},{value:'"menubar"'},{value:'"menuitem"'},{value:'"meter"'},{value:'"navigation"'},{value:'"note"'},{value:'"option"'},{value:'"presentation"'},{value:'"progressbar"'},{value:'"radio"'},{value:'"radiogroup"'},{value:'"region"'},{value:'"rowgroup"'},{value:'"rowheader"'},{value:'"scrollbar"'},{value:'"searchbox"'},{value:'"separator"'},{value:'"slider"'},{value:'"spinbutton"'},{value:'"status"'},{value:'"summary"'},{value:'"switch"'},{value:'"tab"'},{value:'"table"'},{value:'"tablist"'},{value:'"tabpanel"'},{value:'"term"'},{value:'"timer"'},{value:'"toolbar"'},{value:'"tooltip"'},{value:'"tree"'},{value:'"treegrid"'},{value:'"treeitem"'},{value:'"blockquote"'},{value:'"code"'},{value:'"deletion"'},{value:'"emphasis"'},{value:'"insertion"'},{value:'"paragraph"'},{value:'"strong"'},{value:'"gridcell"'},{value:'"listbox"'},{value:'"menuitemcheckbox"'},{value:'"menuitemradio"'},{value:'"textbox"'}]}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyDownCapture:{defaultValue:null,description:"",name:"onKeyDownCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUp:{defaultValue:null,description:"",name:"onKeyUp",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUpCapture:{defaultValue:null,description:"",name:"onKeyUpCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},tabIndex:{defaultValue:null,description:"Additional accessibility props",name:"tabIndex",required:!1,type:{name:"enum",value:[{value:"0"},{value:"-1"}]}},"aria-activedescendant":{defaultValue:null,description:`Aria props (additional, minus existants)
@see https://necolas.github.io/react-native-web/docs/accessibility
@see https://reactnative.dev/docs/accessibility#aria-valuemax`,name:"aria-activedescendant",required:!1,type:{name:"string"}},"aria-atomic":{defaultValue:null,description:"",name:"aria-atomic",required:!1,type:{name:"boolean"}},"aria-autocomplete":{defaultValue:null,description:"",name:"aria-autocomplete",required:!1,type:{name:"string"}},"aria-colcount":{defaultValue:null,description:"",name:"aria-colcount",required:!1,type:{name:"number"}},"aria-colindex":{defaultValue:null,description:"",name:"aria-colindex",required:!1,type:{name:"number"}},"aria-colspan":{defaultValue:null,description:"",name:"aria-colspan",required:!1,type:{name:"number"}},"aria-controls":{defaultValue:null,description:"",name:"aria-controls",required:!1,type:{name:"string"}},"aria-current":{defaultValue:null,description:"",name:"aria-current",required:!1,type:{name:'boolean | "page" | "step" | "location" | "date" | "time"'}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-details":{defaultValue:null,description:"",name:"aria-details",required:!1,type:{name:"string"}},"aria-errormessage":{defaultValue:null,description:"",name:"aria-errormessage",required:!1,type:{name:"string"}},"aria-flowto":{defaultValue:null,description:"",name:"aria-flowto",required:!1,type:{name:"string"}},"aria-haspopup":{defaultValue:null,description:"",name:"aria-haspopup",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:"boolean"}},"aria-keyshortcuts":{defaultValue:null,description:"",name:"aria-keyshortcuts",required:!1,type:{name:"string"}},"aria-level":{defaultValue:null,description:"",name:"aria-level",required:!1,type:{name:"number"}},"aria-multiline":{defaultValue:null,description:"",name:"aria-multiline",required:!1,type:{name:"boolean"}},"aria-multiselectable":{defaultValue:null,description:"",name:"aria-multiselectable",required:!1,type:{name:"boolean"}},"aria-orientation":{defaultValue:null,description:"",name:"aria-orientation",required:!1,type:{name:"enum",value:[{value:'"horizontal"'},{value:'"vertical"'}]}},"aria-owns":{defaultValue:null,description:"",name:"aria-owns",required:!1,type:{name:"string"}},"aria-placeholder":{defaultValue:null,description:"",name:"aria-placeholder",required:!1,type:{name:"string"}},"aria-posinset":{defaultValue:null,description:"",name:"aria-posinset",required:!1,type:{name:"number"}},"aria-pressed":{defaultValue:null,description:"",name:"aria-pressed",required:!1,type:{name:"boolean"}},"aria-readonly":{defaultValue:null,description:"",name:"aria-readonly",required:!1,type:{name:"boolean"}},"aria-required":{defaultValue:null,description:"",name:"aria-required",required:!1,type:{name:"boolean"}},"aria-roledescription":{defaultValue:null,description:"",name:"aria-roledescription",required:!1,type:{name:"string"}},"aria-rowcount":{defaultValue:null,description:"",name:"aria-rowcount",required:!1,type:{name:"number"}},"aria-rowindex":{defaultValue:null,description:"",name:"aria-rowindex",required:!1,type:{name:"number"}},"aria-rowspan":{defaultValue:null,description:"",name:"aria-rowspan",required:!1,type:{name:"number"}},"aria-setsize":{defaultValue:null,description:"",name:"aria-setsize",required:!1,type:{name:"number"}},"aria-sort":{defaultValue:null,description:"",name:"aria-sort",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"ascending"'},{value:'"descending"'},{value:'"other"'}]}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"stretch"'},{value:'"baseline"'}]}},direction:{defaultValue:null,description:"",name:"direction",required:!1,type:{name:"enum",value:[{value:'"column"'},{value:'"row"'},{value:'"columnReverse"'},{value:'"rowReverse"'}]}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"normal"'},{value:'"spaceBetween"'},{value:'"spaceAround"'},{value:'"spaceEvenly"'}]}},space:{defaultValue:null,description:"",name:"space",required:!1,type:{name:"enum",value:[{value:"16"},{value:"4"},{value:"8"},{value:"12"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},wrap:{defaultValue:{value:"false"},description:"",name:"wrap",required:!1,type:{name:"boolean"}}}}}catch{}const R=de.create({container:{paddingRight:12,paddingBottom:8},shadowed:{position:"absolute",opacity:0,width:"100%",height:"100%",borderRadius:4,boxShadow:Oe.tile,transitionDuration:"150ms",transitionProperty:"opacity"},hovered:{opacity:1},dropdown:{maxHeight:400,minWidth:200},itemHovered:{backgroundColor:H.gray[50]},content:{paddingVertical:12},inputContent:{padding:24},radio:{display:"flex",flexDirection:"row",alignItems:"center",height:32,paddingHorizontal:24},input:{minWidth:200},value:{maxWidth:130,whiteSpace:"nowrap"},buttonContainer:{paddingHorizontal:Pe[24]}}),ae=o.forwardRef(({onPress:r,onPressRemove:a,label:s,value:l="",isActive:d},v)=>{const h=o.useRef(null),n=Ie(h,v);return i(ne,{ref:n,onPress:r,children:({hovered:x})=>O(ke,{children:[i(I,{style:[R.shadowed,x&&R.hovered]}),i(Ee,{label:s,color:"current",onPressRemove:a,children:O(fe,{direction:"row",alignItems:"center",children:[i(N,{numberOfLines:1,style:R.value,children:l}),i(j,{width:4}),i(qe,{color:H.current.primary,name:d?"chevron-up-filled":"chevron-down-filled",size:16})]})})]})})});function Je({label:r,items:a,value:s,onValueChange:l,onPressRemove:d,autoOpen:v=!1}){const h=o.useRef(null),[n,{close:x,toggle:m}]=J(v),g=o.useMemo(()=>a.find(y=>y.value===s),[a,s]);return O(I,{style:R.container,children:[i(ae,{label:r,onPress:m,ref:h,onPressRemove:d,isActive:n,value:g==null?void 0:g.label}),i(re,{role:"listbox",matchReferenceWidth:!1,onDismiss:x,referenceRef:h,returnFocus:!1,visible:n,children:i(I,{style:R.dropdown,children:i(ve,{role:"list",data:a,contentContainerStyle:R.content,keyExtractor:(y,u)=>`filter-item-${u}`,renderItem:({item:y})=>{const u=s===y.value;return O(ne,{role:"radio","aria-checked":u,style:({hovered:b})=>[R.radio,b&&R.itemHovered],onPress:()=>{l(y.value),x()},children:[i(ze,{value:u}),i(j,{width:12}),i(N,{children:y.label})]})}})})})]})}function $e({label:r,items:a,checkAllLabel:s,value:l,onValueChange:d,applyButtonLabel:v,onPressRemove:h,autoOpen:n=!1}){const x=o.useRef(null),[m,{close:g,toggle:y}]=J(n),[u,b]=o.useState(l),V=o.useMemo(()=>new Set(u),[u]),P=o.useMemo(()=>a.filter(k=>V.has(k.value)),[a,V]),K=s!=null&&V.size===a.length,p=o.useMemo(()=>{if(s==null)return a;const k=V.size===0?!1:V.size===a.length?!0:"mixed";return[{label:s,checked:k},...a]},[a,s,V]),q=o.useCallback(()=>{d(u),g()},[d,u,g]);return o.useEffect(()=>{m||b(l)},[m,l]),O(I,{style:R.container,children:[i(ae,{label:r,onPress:y,ref:x,onPressRemove:h,isActive:m,value:K?s:P.map(k=>k.label).join(", ")}),i(re,{role:"listbox",matchReferenceWidth:!1,onDismiss:g,referenceRef:x,returnFocus:!1,visible:m,children:O(I,{style:R.dropdown,children:[i(ve,{role:"list",data:p,contentContainerStyle:R.content,keyExtractor:(k,F)=>`filter-item-${F}`,renderItem:({item:k})=>{const F=oe(k).with({checked:G.any},({checked:S})=>S).with({value:G.any},({value:S})=>V.has(S)).exhaustive(),w=oe(k).with({checked:G.any},({checked:S})=>()=>{b(S===!0?void 0:a.map(C=>C.value))}).with({value:G.any},({value:S})=>()=>{const C=new Set([...V]);F===!0?C.delete(S):C.add(S),C.size===0?b(void 0):b([...C])}).exhaustive();return O(ne,{role:"radio","aria-checked":F,style:({hovered:S})=>[R.radio,S&&R.itemHovered],onPress:w,children:[i(Be,{value:F}),i(j,{width:12}),i(N,{children:k.label})]})}}),i(j,{height:8}),i(I,{style:R.buttonContainer,children:i(pe,{color:"current",onPress:q,children:v})}),i(j,{height:24})]})})]})}function Ue({label:r,monthNames:a,dayNames:s,initialValue:l,noValueText:d,cancelText:v,submitText:h,dateFormat:n,validate:x,onSave:m,onPressRemove:g,autoOpen:y=!1}){const u=o.useRef(null),[b,{close:V,toggle:P}]=J(y),{Field:K,submitForm:p,setFieldValue:q}=Te({date:{initialValue:le(l)?X(l).format(n):"",validate:x}});o.useEffect(()=>{q("date",le(l)?X(l).format(n):"")},[l,n,q]);const k=()=>{p(F=>{if(Re(F,["date"])){const w=X(F.date,n,!0).toJSON();m(w),V()}})};return O(I,{style:R.container,children:[i(ae,{label:r,onPress:P,ref:u,onPressRemove:g,isActive:b,value:le(l)?X(l).format(n):d}),i(K,{name:"date",children:({value:F,onChange:w,error:S})=>i(De,{visible:b,referenceRef:u,monthNames:a,weekDayNames:s,format:n,firstWeekDay:"monday",label:r,cancelLabel:v,confirmLabel:h,value:F,error:S,onChange:C=>{w(C),k()},onDissmiss:V})})]})}function Ye({label:r,initialValue:a="",noValueText:s,submitText:l,autoOpen:d=!1,placeholder:v,validate:h,onSave:n,onPressRemove:x}){const m=o.useRef(null),[g,{close:y,toggle:u}]=J(d),[b,V]=o.useState(a),{Field:P,submitForm:K}=Te({input:{initialValue:a,validate:h}}),p=()=>{K(q=>{Re(q,["input"])&&(V(q.input),n(q.input),y())})};return O(I,{style:R.container,children:[i(ae,{label:r,onPress:u,ref:m,onPressRemove:x,isActive:g,value:b===""?s:b}),i(re,{role:"listbox",matchReferenceWidth:!1,onDismiss:y,referenceRef:m,returnFocus:!1,visible:g,children:O(I,{style:[R.dropdown,R.inputContent],children:[i(P,{name:"input",children:({error:q,value:k,onChange:F})=>i(je,{label:r,render:w=>i(Me,{nativeID:w,error:q,style:R.input,placeholder:v,value:k,onChangeText:F})})}),i(pe,{size:"small",color:"current",onPress:p,children:l})]})})]})}function Qe({children:r,onAdd:a,onPressRemove:s}){return o.useEffect(a,[]),i(Ee,{color:"current",onPressRemove:s,children:r})}const Z=(r,a,s)=>a[s],ce=({filters:r,openedFilters:a,definition:s,onChangeOpened:l,onChangeFilters:d})=>{const v=_e(a),h=a.length>v.length?a[a.length-1]:void 0;return a.length===0?null:i(se,{direction:"row",wrap:!0,children:a.map(n=>{const x=s[n];return typeof n!="string"||x==null?null:i(I,{children:oe(x).with({type:"radio"},({type:m,label:g,items:y})=>i(Je,{label:g,items:y,autoOpen:h===n,onPressRemove:()=>{d({...r,[n]:void 0}),l(a.filter(u=>u!==n))},value:Z(m,r,n),onValueChange:u=>d({...r,[n]:u})})).with({type:"checkbox"},({type:m,label:g,items:y,checkAllLabel:u,submitText:b})=>i($e,{label:g,items:y,checkAllLabel:u,autoOpen:h===n,applyButtonLabel:b,value:Z(m,r,n),onValueChange:V=>d({...r,[n]:V}),onPressRemove:()=>{d({...r,[n]:void 0}),l(a.filter(V=>V!==n))}})).with({type:"date"},({type:m,label:g,monthNames:y,dayNames:u,noValueText:b,cancelText:V,submitText:P,dateFormat:K,validate:p})=>i(Ue,{label:g,monthNames:y,dayNames:u,noValueText:b,cancelText:V,submitText:P,dateFormat:K,autoOpen:h===n,validate:p,initialValue:Z(m,r,n),onSave:q=>d({...r,[n]:q}),onPressRemove:()=>{d({...r,[n]:void 0}),l(a.filter(q=>q!==n))}})).with({type:"input"},({type:m,label:g,placeholder:y,noValueText:u,submitText:b,validate:V})=>i(Ye,{label:g,placeholder:y,noValueText:u,submitText:b,autoOpen:h===n,validate:V,initialValue:Z(m,r,n),onSave:P=>d({...r,[n]:P}),onPressRemove:()=>{d({...r,[n]:void 0}),l(a.filter(P=>P!==n))}})).with({type:"boolean"},({label:m})=>i(Qe,{onAdd:()=>{d({...r,[n]:!0})},onPressRemove:()=>{d({...r,[n]:void 0}),l(a.filter(g=>g!==n))},children:m})).exhaustive()},n)})})};try{ce.displayName="FiltersStack",ce.__docgenInfo={description:"",displayName:"FiltersStack",props:{definition:{defaultValue:null,description:"",name:"definition",required:!0,type:{name:"FiltersDefinition"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"{ [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }"}},openedFilters:{defaultValue:null,description:"",name:"openedFilters",required:!0,type:{name:"(keyof T)[]"}},onChangeOpened:{defaultValue:null,description:"",name:"onChangeOpened",required:!0,type:{name:"(value: (keyof T)[]) => void"}},onChangeFilters:{defaultValue:null,description:"",name:"onChangeFilters",required:!0,type:{name:"(value: { [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }) => void"}}}}}catch{}const Ge=["January","February","March","April","May","June","July","August","September","October","November","December"],Xe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ze={type:"radio",label:"Mode",items:[{label:"QES",value:"QES"},{label:"Expert",value:"Expert"}]},et={type:"checkbox",label:"Status",submitText:"Apply",items:[{label:"Accepted",value:"Accepted"},{label:"Canceled",value:"Canceled"},{label:"Failed",value:"Failed"},{label:"Expired",value:"Expired"},{label:"CustomerRefused",value:"CustomerRefused"}]},tt={type:"date",label:"Start Date",cancelText:"Cancel",submitText:"Save",noValueText:"None",dateFormat:"DD/MM/YYYY",dayNames:Xe,monthNames:Ge},rt={type:"input",label:"Resource ID",noValueText:"None",submitText:"Save",placeholder:"Placeholder..."},nt={mode:Ze,status:et,startDate:tt,resourceId:rt},at=[{name:"mode",label:"Mode"},{name:"status",label:"Status"},{name:"startDate",label:"Start date"},{name:"resourceId",label:"Ressource ID"}],Xt={title:"Forms/Filter",component:te},ee=()=>{const[r,a]=o.useState([]),[s,l]=o.useState({mode:void 0,status:void 0,resourceId:void 0,startDate:void 0});return i(Ae,{title:"Filter",children:i(Le,{variant:"live",children:O(I,{children:[i(te,{filters:s,label:"Choose filters",title:"Filters",onAddFilter:d=>a(v=>[...v,d]),availableFilters:at,openFilters:r}),i(j,{height:8}),i(ce,{definition:nt,filters:s,openedFilters:r,onChangeFilters:l,onChangeOpened:a})]})})})};var Se,Ve,xe;ee.parameters={...ee.parameters,docs:{...(Se=ee.parameters)==null?void 0:Se.docs,source:{originalSource:`() => {
  const [openFilters, setOpenFilters] = useState<(keyof State)[]>([]);
  const [filters, setFilters] = useState<State>({
    mode: undefined,
    status: undefined,
    resourceId: undefined,
    startDate: undefined
  });
  return <StoryBlock title="Filter">
      <WithCurrentColor variant="live">
        <View>
          <FilterChooser filters={filters} label="Choose filters" title="Filters" onAddFilter={filter => setOpenFilters(filters => [...filters, filter])} availableFilters={availableFilters} openFilters={openFilters} />

          <Space height={8} />

          <FiltersStack definition={definition} filters={filters} openedFilters={openFilters} onChangeFilters={setFilters} onChangeOpened={setOpenFilters} />
        </View>
      </WithCurrentColor>
    </StoryBlock>;
}`,...(xe=(Ve=ee.parameters)==null?void 0:Ve.docs)==null?void 0:xe.source}}};const Zt=["All"];export{ee as All,Zt as __namedExportsOrder,Xt as default};
//# sourceMappingURL=Filter.stories-de8afd9a.js.map
