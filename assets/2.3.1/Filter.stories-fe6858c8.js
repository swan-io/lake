import{S as ve,c as U,j as D,F as ke,a,V as I,T as Y,b as j,g as De,h as Ke,d as Ie,i as oe}from"./Space-40db50f8.js";import{r as o}from"./index-ebeaab24.js";import{t as ge}from"./typography-6ad07e3d.js";import{u as J}from"./useDisclosure-f840d913.js";import{B as pe,Q as ce,H as ee}from"./index-ba19cc6d.js";import{I as Ee}from"./Icon-c462f19b.js";import{L as ie}from"./LakeButton-323b3f10.js";import{P as Q}from"./Popover-bcccb7c0.js";import{F as me}from"./index-8daa3a7a.js";import{P as le}from"./index-a1126e38.js";import{d as te,g as _e}from"./rifm-fbb75443.js";import{s as be}from"./index-1cb3eff1.js";import{a as Le}from"./useMergeRefs-419c3822.js";import{u as Be}from"./TransitionView-35cdf7b1.js";import{L as ze}from"./LakeCheckbox-82323284.js";import{L as Re}from"./LakeLabel-e47a3c41.js";import{L as je}from"./LakeRadio-3ca25fe4.js";import{L as qe}from"./LakeTextInput-5b79d518.js";import{T as Ce}from"./Tag-93cb587c.js";import{W as Ae}from"./WithCurrentColor-8892ee00.js";import{S as Me}from"./_StoriesComponents-bdf01449.js";import"./extends-98964cd2.js";import"./colors-298625c7.js";import"./Svg-a73958cb.js";import"./Pressable-8fde3226.js";import"./index-e2deb62e.js";import"./useResponsive-036a054c.js";import"./BottomPanel-76f1aade.js";import"./commonStyles-d52fedae.js";import"./useBodyClassName-9a26f8eb.js";import"./math-7ea1285d.js";import"./FocusTrap-5b455df8.js";import"./array-b3630b94.js";import"./LoadingView-adbe4538.js";import"./Portal-9f89f151.js";import"./index-9c09ad76.js";import"./index-77225494.js";import"./v4-a960c1f4.js";import"./Fill-b317333b.js";const $=ve.create({selected:{color:U.gray[500]},list:{paddingVertical:20,marginVertical:4,minWidth:250,overflow:"hidden"},item:{display:"flex",paddingHorizontal:24,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},itemHovered:{backgroundColor:U.gray[50]},availableFiltersTitle:{...ge.bodyLarge,color:U.current[500],paddingHorizontal:24},filterName:{...ge.bodySmall}});function ae({filters:t,openFilters:r,label:d,title:l,availableFilters:u,large:y=!0,onAddFilter:S}){const i=o.useRef(null),[f,{close:c,toggle:b}]=J(!1);return D(ke,{children:[a(pe,{direction:"row",justifyContent:"start",alignItems:"center",children:a(ie,{size:"small",mode:"secondary",color:"gray",onPress:b,ref:i,icon:y?"chevron-down-filled":"filter-filled",iconPosition:"end",ariaLabel:d,children:y?d:null})}),a(Q,{role:"listbox",matchReferenceMinWidth:!0,onDismiss:c,referenceRef:i,returnFocus:!1,visible:f,children:D(I,{style:$.list,children:[a(Y,{style:$.availableFiltersTitle,children:l}),a(j,{height:8}),a(me,{role:"list",data:u,keyExtractor:(F,s)=>`filter-item-${s}`,renderItem:({item:F})=>{const s=!!t[F.name]||r.includes(F.name);return D(le,{style:({hovered:h})=>[$.item,h&&$.itemHovered],role:"button",disabled:s,onPress:()=>{S(F.name),c()},children:[a(Y,{style:[$.filterName,s&&$.selected],children:F.label}),s&&a(Ee,{color:U.positive[500],name:"checkmark-filled",size:14})]})}})]})})]})}try{ae.displayName="FilterChooser",ae.__docgenInfo={description:"",displayName:"FilterChooser",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<Record<FilterName, unknown>>"}},openFilters:{defaultValue:null,description:"",name:"openFilters",required:!0,type:{name:"FilterName[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},availableFilters:{defaultValue:null,description:"",name:"availableFilters",required:!0,type:{name:"{ label: string; name: FilterName; }[]"}},large:{defaultValue:{value:"true"},description:"",name:"large",required:!1,type:{name:"boolean"}},onAddFilter:{defaultValue:null,description:"",name:"onAddFilter",required:!0,type:{name:"(filterName: FilterName) => void"}}}}}catch{}function z(){return z=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var d=arguments[r];for(var l in d)Object.prototype.hasOwnProperty.call(d,l)&&(t[l]=d[l])}return t},z.apply(this,arguments)}var We=typeof window>"u"?o.useEffect:o.useLayoutEffect,He=function(t){return t},Fe=function(){},we=function(t){return typeof t=="function"?t():t},se=function(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"},Te=function(t,r){return r.every(function(d){return t[d]!==void 0})},Pe=function(t){var r=o.useReducer(function(){return[]},[])[1],d=o.useRef(!1),l=o.useRef(t),u=o.useRef("untouched");We(function(){l.current=t}),o.useEffect(function(){return d.current=!0,function(){d.current=!1}},[]);var y=o.useRef(),S=o.useRef(),i=o.useRef(),f=o.useRef(),c=o.useRef(),b=o.useRef(),F=o.useRef(),s=o.useMemo(function(){var T=function(e){return we(l.current[e].initialValue)},g=function(e){var n;return(n=l.current[e].sanitize)!=null?n:He},R=function(e){var n;return(n=l.current[e].validate)!=null?n:Fe},P=function(e){return i.current[e]},p=function(e,n){var m=y.current[e],v=typeof n=="function"?n({value:m.exposed.value,talkative:m.talkative,validity:m.validity}):n,C=v.talkative&&v.validity.tag!=="unknown"?{validating:v.validity.tag==="validating",valid:v.validity.tag==="valid",error:v.validity.tag==="invalid"?v.validity.error:void 0}:{validating:!1,valid:!R(e),error:void 0};y.current[e]={talkative:v.talkative,validity:v.validity,exposed:z({},C,{value:v.value})}},x=function(e){var n=c.current[e],m=n!==void 0;return m&&(clearTimeout(n),c.current[e]=void 0),m},w=function(e){S.current[e].forEach(function(n){return n()})},V=function(e,n){var m=function(v){var C;return(C=l.current[v].strategy)!=null?C:"onSuccessOrBlur"}(e);n&&!n.some(function(v){return m===v})||p(e,function(v){return z({},v,{talkative:!0})})},K=function(e){p(e,function(n){return z({},n,{validity:{tag:"validating"}})})},A=function(e,n){p(e,function(m){return z({},m,{validity:n!==void 0?{tag:"invalid",error:n}:{tag:"valid"}})})},W=function(e,n){n===void 0&&(n={});var m=y.current[e].exposed;return n.sanitize?z({},m,{value:g(e)(m.value)}):m},B=function(e){var n=x(e),m=g(e),v=R(e),C=m(y.current[e].exposed.value),H=v(C,{getFieldState:W,focusField:G});if(!se(H)){var M=H;return M===void 0&&V(e,["onSuccess","onSuccessOrBlur"]),A(e,M),w(e),M}return n||(K(e),w(e)),H.then(function(_){var Z=function(L){var N;return(N=l.current[L].equalityFn)!=null?N:Object.is}(e),O=m(y.current[e].exposed.value);if(Z(C,O))return _===void 0&&V(e,["onSuccess","onSuccessOrBlur"]),A(e,_),w(e),_}).catch(function(_){})},G=function(e){var n=f.current[e];n.current&&typeof n.current.focus=="function"&&n.current.focus()},ye=function(e,n){n===void 0&&(n={}),x(e),p(e,function(m){return{value:n.feedbackOnly?m.value:T(e),talkative:!1,validity:{tag:"unknown"}}}),w(e)},he=function(e,n){var m=e[n.findIndex(function(v){return v!==void 0})];m!==void 0&&G(m)},X=function(e,n){se(e)?(r(),e.finally(function(){u.current="submitted",d.current&&r()})):(u.current="submitted",n&&r())};return{getFieldState:W,setFieldValue:function(e,n,m){m===void 0&&(m={}),p(e,function(v){return z({},v,{value:n})}),m.validate&&V(e),B(e)},setFieldError:function(e,n){A(e,n),V(e),w(e)},focusField:G,resetField:ye,validateField:function(e){return P(e)?(V(e),Promise.resolve(B(e))):Promise.resolve(void 0)},listenFields:function(e,n){var m=function(){n(e.reduce(function(v,C){return v[C]=W(C),v},{}))};return e.forEach(function(v){return S.current[v].add(m)}),function(){e.forEach(function(v){return S.current[v].delete(m)})}},resetForm:function(e){e===void 0&&(e={}),Object.keys(l.current).forEach(function(n){return ye(n,e)}),e.feedbackOnly||(u.current="untouched"),r()},submitForm:function(e,n,m){if(n===void 0&&(n=Fe),m===void 0&&(m={}),u.current!=="submitting"){var v=u.current==="editing";u.current="submitting";var C=Object.keys(i.current).filter(function(O){return i.current[O]}),H={},M={},_=[],Z=!m.avoidFocusOnError;if(C.forEach(function(O,L){V(O),H[O]=W(O,{sanitize:!0}).value,_[L]=B(O)}),function(O){return O.every(function(L){return!se(L)})}(_))return _.every(function(O){return O===void 0})?X(e(H),v):(Z&&he(C,_),C.forEach(function(O,L){M[O]=_[L]}),X(n(M),v));r(),Promise.all(_.map(function(O){return Promise.resolve(O)})).then(function(O){var L=O;return L.every(function(N){return N===void 0})?X(e(H),v):(Z&&he(C,L),C.forEach(function(N,Oe){M[N]=L[Oe]}),X(n(M),v))}).finally(function(){u.current="submitted",d.current&&r()})}},setState:p,getOnChange:function(e){return function(n){var m=function(v){var C;return(C=l.current[v].debounceInterval)!=null?C:0}(e);p(e,function(v){return z({},v,{value:n})}),V(e,["onChange"]),x(e),u.current!=="untouched"&&u.current!=="submitted"||(u.current="editing",r()),m!==0?(K(e),w(e),c.current[e]=setTimeout(function(){P(e)?B(e):x(e)},m)):B(e)}},getOnBlur:function(e){return function(){y.current[e].validity.tag==="unknown"||function(n){return y.current[n].talkative}(e)||(V(e,["onBlur","onSuccessOrBlur"]),B(e))}},getFocusNextField:function(e){return function(){var n=Object.keys(l.current),m=n.findIndex(function(C){return C===e});if(m!==void 0){var v=n[m+1];v!==void 0&&G(v)}}}}},[]);if(!y.current){for(var h in y.current={},S.current={},i.current={},f.current={},c.current={},l.current)Object.prototype.hasOwnProperty.call(l.current,h)&&(s.setState(h,{value:we(l.current[h].initialValue),talkative:!1,validity:{tag:"unknown"}}),S.current[h]=new Set,i.current[h]=!1,f.current[h]={current:null},c.current[h]=void 0);var q=function(T){var g=T.name,R=T.children,P=o.useMemo(function(){return{getSnapshot:function(){return y.current[g]},subscribe:function(x){return S.current[g].add(x),function(){S.current[g].delete(x)}}}},[g]),p=P.getSnapshot;return be.useSyncExternalStore(P.subscribe,p,p),o.useEffect(function(){var x=!i.current[g];return x&&(i.current[g]=!0),function(){x&&(i.current[g]=!1)}},[g]),R(z({},s.getFieldState(g),{ref:f.current[g],focusNextField:o.useMemo(function(){return s.getFocusNextField(g)},[g]),onBlur:o.useMemo(function(){return s.getOnBlur(g)},[g]),onChange:o.useMemo(function(){return s.getOnChange(g)},[g])}))};q.displayName="Field",b.current=q;var k=function(T){var g=T.names,R=T.children,P=o.useMemo(function(){return{getSnapshot:function(){return JSON.stringify(g.map(function(x){return y.current[x]}))},subscribe:function(x){return g.forEach(function(w){return S.current[w].add(x)}),function(){g.forEach(function(w){return S.current[w].delete(x)})}}}},[JSON.stringify(g)]),p=P.getSnapshot;return be.useSyncExternalStore(P.subscribe,p,p),R(g.reduce(function(x,w){return x[w]=s.getFieldState(w),x},{}))};k.displayName="FieldsListener",F.current=k}return{formStatus:u.current,Field:b.current,FieldsListener:F.current,getFieldState:s.getFieldState,setFieldValue:s.setFieldValue,setFieldError:s.setFieldError,focusField:s.focusField,resetField:s.resetField,validateField:s.validateField,listenFields:s.listenFields,resetForm:s.resetForm,submitForm:s.submitForm}};const Ne=t=>{const[,r]=o.useReducer(f=>f+1,0),d=o.useRef(null),{replace:l,append:u}=t,y=l?l(t.format(t.value)):t.format(t.value),S=o.useRef(!1),i=f=>{const c=f.target.value;d.current=[c,f.target,c.length>y.length,S.current,y===t.format(c)],r()};return o.useLayoutEffect(()=>{if(d.current==null)return;let[f,c,b,F,s]=d.current;d.current=null;const h=F&&s,k=f.slice(c.selectionStart).search(t.accept||/\d/g),T=k!==-1?k:0,g=w=>(w.match(t.accept||/\d/g)||[]).join(""),R=g(f.substr(0,c.selectionStart)),P=w=>{let V=0,K=0;for(let A=0;A!==R.length;++A){let W=w.indexOf(R[A],V)+1,B=g(w).indexOf(R[A],K)+1;B-K>1&&(W=V,B=K),K=Math.max(B,K),V=Math.max(V,W)}return V};if(t.mask===!0&&b&&!s){let w=P(f);const V=g(f.substr(w))[0];w=f.indexOf(V,w),f=`${f.substr(0,w)}${f.substr(w+1)}`}let p=t.format(f);u!=null&&c.selectionStart===f.length&&!s&&(b?p=u(p):g(p.slice(-1))===""&&(p=p.slice(0,-1)));const x=l?l(p):p;return y===x?r():t.onChange(x),()=>{let w=P(p);if(t.mask!=null&&(b||F&&!h))for(;p[w]&&g(p[w])==="";)w+=1;c.selectionStart=c.selectionEnd=w+(h?1+T:0)}}),o.useEffect(()=>{const f=b=>{b.code==="Delete"&&(S.current=!0)},c=b=>{b.code==="Delete"&&(S.current=!1)};return document.addEventListener("keydown",f),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",c)}},[]),{value:d.current!=null?d.current[0]:y,onChange:i}},$e=t=>{const r=Ne(t);return t.children(r)},Ue=ve.create({wrap:{flexWrap:"wrap"}}),de=o.forwardRef(({children:t,space:r,wrap:d=!1,...l},u)=>{const{direction:y="column"}=l,S=y==="row"||y==="rowReverse";return a(pe,{style:d&&Ue.wrap,ref:u,...l,children:o.Children.map(t,(i,f)=>De(i)?i:D(o.Fragment,{children:[f!==0&&(S?a(j,{width:r}):a(j,{height:r})),i]}))})});try{de.displayName="Stack",de.__docgenInfo={description:"",displayName:"Stack",props:{role:{defaultValue:null,description:"",name:"role",required:!1,type:{name:"enum",value:[{value:'"label"'},{value:'"form"'},{value:'"none"'},{value:'"grid"'},{value:'"row"'},{value:'"cell"'},{value:'"alert"'},{value:'"alertdialog"'},{value:'"application"'},{value:'"article"'},{value:'"banner"'},{value:'"button"'},{value:'"checkbox"'},{value:'"columnheader"'},{value:'"combobox"'},{value:'"complementary"'},{value:'"contentinfo"'},{value:'"definition"'},{value:'"dialog"'},{value:'"directory"'},{value:'"document"'},{value:'"feed"'},{value:'"figure"'},{value:'"group"'},{value:'"heading"'},{value:'"img"'},{value:'"link"'},{value:'"list"'},{value:'"listitem"'},{value:'"log"'},{value:'"main"'},{value:'"marquee"'},{value:'"math"'},{value:'"menu"'},{value:'"menubar"'},{value:'"menuitem"'},{value:'"meter"'},{value:'"navigation"'},{value:'"note"'},{value:'"option"'},{value:'"presentation"'},{value:'"progressbar"'},{value:'"radio"'},{value:'"radiogroup"'},{value:'"region"'},{value:'"rowgroup"'},{value:'"rowheader"'},{value:'"scrollbar"'},{value:'"searchbox"'},{value:'"separator"'},{value:'"slider"'},{value:'"spinbutton"'},{value:'"status"'},{value:'"summary"'},{value:'"switch"'},{value:'"tab"'},{value:'"table"'},{value:'"tablist"'},{value:'"tabpanel"'},{value:'"term"'},{value:'"timer"'},{value:'"toolbar"'},{value:'"tooltip"'},{value:'"tree"'},{value:'"treegrid"'},{value:'"treeitem"'},{value:'"blockquote"'},{value:'"code"'},{value:'"deletion"'},{value:'"emphasis"'},{value:'"insertion"'},{value:'"paragraph"'},{value:'"strong"'},{value:'"gridcell"'},{value:'"listbox"'},{value:'"menuitemcheckbox"'},{value:'"menuitemradio"'},{value:'"textbox"'}]}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyDownCapture:{defaultValue:null,description:"",name:"onKeyDownCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUp:{defaultValue:null,description:"",name:"onKeyUp",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUpCapture:{defaultValue:null,description:"",name:"onKeyUpCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},tabIndex:{defaultValue:null,description:"Additional accessibility props",name:"tabIndex",required:!1,type:{name:"enum",value:[{value:"0"},{value:"-1"}]}},"aria-activedescendant":{defaultValue:null,description:`Aria props (additional, minus existants)
@see https://necolas.github.io/react-native-web/docs/accessibility
@see https://reactnative.dev/docs/accessibility#aria-valuemax`,name:"aria-activedescendant",required:!1,type:{name:"string"}},"aria-atomic":{defaultValue:null,description:"",name:"aria-atomic",required:!1,type:{name:"boolean"}},"aria-autocomplete":{defaultValue:null,description:"",name:"aria-autocomplete",required:!1,type:{name:"string"}},"aria-colcount":{defaultValue:null,description:"",name:"aria-colcount",required:!1,type:{name:"number"}},"aria-colindex":{defaultValue:null,description:"",name:"aria-colindex",required:!1,type:{name:"number"}},"aria-colspan":{defaultValue:null,description:"",name:"aria-colspan",required:!1,type:{name:"number"}},"aria-controls":{defaultValue:null,description:"",name:"aria-controls",required:!1,type:{name:"string"}},"aria-current":{defaultValue:null,description:"",name:"aria-current",required:!1,type:{name:'boolean | "page" | "step" | "location" | "date" | "time"'}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-details":{defaultValue:null,description:"",name:"aria-details",required:!1,type:{name:"string"}},"aria-errormessage":{defaultValue:null,description:"",name:"aria-errormessage",required:!1,type:{name:"string"}},"aria-flowto":{defaultValue:null,description:"",name:"aria-flowto",required:!1,type:{name:"string"}},"aria-haspopup":{defaultValue:null,description:"",name:"aria-haspopup",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:"boolean"}},"aria-keyshortcuts":{defaultValue:null,description:"",name:"aria-keyshortcuts",required:!1,type:{name:"string"}},"aria-level":{defaultValue:null,description:"",name:"aria-level",required:!1,type:{name:"number"}},"aria-multiline":{defaultValue:null,description:"",name:"aria-multiline",required:!1,type:{name:"boolean"}},"aria-multiselectable":{defaultValue:null,description:"",name:"aria-multiselectable",required:!1,type:{name:"boolean"}},"aria-orientation":{defaultValue:null,description:"",name:"aria-orientation",required:!1,type:{name:"enum",value:[{value:'"horizontal"'},{value:'"vertical"'}]}},"aria-owns":{defaultValue:null,description:"",name:"aria-owns",required:!1,type:{name:"string"}},"aria-placeholder":{defaultValue:null,description:"",name:"aria-placeholder",required:!1,type:{name:"string"}},"aria-posinset":{defaultValue:null,description:"",name:"aria-posinset",required:!1,type:{name:"number"}},"aria-pressed":{defaultValue:null,description:"",name:"aria-pressed",required:!1,type:{name:"boolean"}},"aria-readonly":{defaultValue:null,description:"",name:"aria-readonly",required:!1,type:{name:"boolean"}},"aria-required":{defaultValue:null,description:"",name:"aria-required",required:!1,type:{name:"boolean"}},"aria-roledescription":{defaultValue:null,description:"",name:"aria-roledescription",required:!1,type:{name:"string"}},"aria-rowcount":{defaultValue:null,description:"",name:"aria-rowcount",required:!1,type:{name:"number"}},"aria-rowindex":{defaultValue:null,description:"",name:"aria-rowindex",required:!1,type:{name:"number"}},"aria-rowspan":{defaultValue:null,description:"",name:"aria-rowspan",required:!1,type:{name:"number"}},"aria-setsize":{defaultValue:null,description:"",name:"aria-setsize",required:!1,type:{name:"number"}},"aria-sort":{defaultValue:null,description:"",name:"aria-sort",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"ascending"'},{value:'"descending"'},{value:'"other"'}]}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"stretch"'},{value:'"baseline"'}]}},direction:{defaultValue:null,description:"",name:"direction",required:!1,type:{name:"enum",value:[{value:'"row"'},{value:'"column"'},{value:'"columnReverse"'},{value:'"rowReverse"'}]}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"normal"'},{value:'"spaceBetween"'},{value:'"spaceAround"'},{value:'"spaceEvenly"'}]}},space:{defaultValue:null,description:"",name:"space",required:!1,type:{name:"enum",value:[{value:"16"},{value:"4"},{value:"8"},{value:"12"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},wrap:{defaultValue:{value:"false"},description:"",name:"wrap",required:!1,type:{name:"boolean"}}}}}catch{}const E=ve.create({container:{paddingRight:12,paddingBottom:8},shadowed:{position:"absolute",opacity:0,width:"100%",height:"100%",borderRadius:4,boxShadow:Ke.tile,transitionDuration:"150ms",transitionProperty:"opacity"},hovered:{opacity:1},dropdown:{maxHeight:400,minWidth:200},itemHovered:{backgroundColor:U.gray[50]},content:{paddingVertical:12},inputContent:{padding:24},radio:{display:"flex",flexDirection:"row",alignItems:"center",height:32,paddingHorizontal:24},itemLabel:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},input:{minWidth:200},value:{maxWidth:130,whiteSpace:"nowrap"},buttonContainer:{paddingHorizontal:Ie[24]}}),ue=o.forwardRef(({onPress:t,onPressRemove:r,label:d,value:l="",isActive:u},y)=>{const S=o.useRef(null),i=Le(S,y);return a(le,{ref:i,onPress:t,children:({hovered:f})=>D(ke,{children:[a(I,{style:[E.shadowed,f&&E.hovered]}),a(Ce,{label:d,color:"current",onPressRemove:r,children:D(pe,{direction:"row",alignItems:"center",children:[a(Y,{numberOfLines:1,style:E.value,children:l}),a(j,{width:4}),a(Ee,{color:U.current.primary,name:u?"chevron-up-filled":"chevron-down-filled",size:16})]})})]})})});function Ye({label:t,items:r,width:d,value:l,onValueChange:u,onPressRemove:y,autoOpen:S=!1}){const i=o.useRef(null),[f,{close:c,toggle:b}]=J(S),F=o.useMemo(()=>r.find(s=>s.value===l),[r,l]);return D(I,{style:E.container,children:[a(ue,{label:t,onPress:b,ref:i,onPressRemove:y,isActive:f,value:F==null?void 0:F.label}),a(Q,{role:"listbox",matchReferenceWidth:!1,onDismiss:c,referenceRef:i,returnFocus:!1,visible:f,children:a(I,{style:[E.dropdown,{width:d}],children:a(me,{role:"list",data:r,contentContainerStyle:E.content,keyExtractor:(s,h)=>`filter-item-${h}`,renderItem:({item:s})=>{const h=l===s.value;return D(le,{role:"radio","aria-checked":h,style:({hovered:q})=>[E.radio,q&&E.itemHovered],onPress:()=>{u(s.value),c()},children:[a(je,{value:h}),a(j,{width:12}),a(Y,{style:E.itemLabel,children:s.label})]})}})})})]})}function Je({label:t,items:r,width:d,checkAllLabel:l,value:u,onValueChange:y,applyButtonLabel:S,onPressRemove:i,autoOpen:f=!1}){const c=o.useRef(null),[b,{close:F,toggle:s}]=J(f),[h,q]=o.useState(u),k=o.useMemo(()=>new Set(h),[h]),T=o.useMemo(()=>r.filter(p=>k.has(p.value)),[r,k]),g=l!=null&&k.size===r.length,R=o.useMemo(()=>{if(l==null)return r;const p=k.size===0?!1:k.size===r.length?!0:"mixed";return[{label:l,checked:p},...r]},[r,l,k]),P=o.useCallback(()=>{y(h),F()},[y,h,F]);return o.useEffect(()=>{b||q(u)},[b,u]),D(I,{style:E.container,children:[a(ue,{label:t,onPress:s,ref:c,onPressRemove:i,isActive:b,value:g?l:T.map(p=>p.label).join(", ")}),a(Q,{role:"listbox",matchReferenceWidth:!1,onDismiss:F,referenceRef:c,returnFocus:!1,visible:b,children:D(I,{style:[E.dropdown,{width:d}],children:[a(me,{role:"list",data:R,contentContainerStyle:E.content,keyExtractor:(p,x)=>`filter-item-${x}`,renderItem:({item:p})=>{const x=ce(p).with({checked:ee.any},({checked:V})=>V).with({value:ee.any},({value:V})=>k.has(V)).exhaustive(),w=ce(p).with({checked:ee.any},({checked:V})=>()=>{q(V===!0?void 0:r.map(K=>K.value))}).with({value:ee.any},({value:V})=>()=>{const K=new Set([...k]);x===!0?K.delete(V):K.add(V),K.size===0?q(void 0):q([...K])}).exhaustive();return D(le,{role:"radio","aria-checked":x,style:({hovered:V})=>[E.radio,V&&E.itemHovered],onPress:w,children:[a(ze,{value:x}),a(j,{width:12}),a(Y,{style:E.itemLabel,children:p.label})]})}}),a(j,{height:8}),a(I,{style:E.buttonContainer,children:a(ie,{color:"current",onPress:P,children:S})}),a(j,{height:24})]})})]})}function Qe({label:t,initialValue:r,noValueText:d,submitText:l,dateFormat:u,rifmProps:y,validate:S,onSave:i,onPressRemove:f,autoOpen:c=!1}){const b=o.useRef(null),[F,{close:s,toggle:h}]=J(c),{Field:q,submitForm:k,setFieldValue:T}=Pe({date:{initialValue:oe(r)?te(r).format(u):"",validate:S}});o.useEffect(()=>{T("date",oe(r)?te(r).format(u):"")},[r,u,T]);const g=()=>{k(R=>{if(Te(R,["date"])){const P=te(R.date,u,!0).toJSON();i(P),s()}})};return D(I,{style:E.container,children:[a(ue,{label:t,onPress:h,ref:b,onPressRemove:f,isActive:F,value:oe(r)?te(r).format(u):d}),a(Q,{role:"listbox",matchReferenceWidth:!1,onDismiss:s,referenceRef:b,returnFocus:!1,visible:F,children:D(I,{style:[E.dropdown,E.inputContent],children:[a(q,{name:"date",children:({value:R,onChange:P,error:p})=>a($e,{value:R,onChange:P,...y,children:({value:x,onChange:w})=>a(Re,{label:t,render:V=>a(qe,{nativeID:V,error:p,style:E.input,placeholder:u,value:x,onChange:w})})})}),a(ie,{color:"current",size:"small",onPress:g,children:l})]})})]})}function Ge({label:t,initialValue:r="",noValueText:d,submitText:l,autoOpen:u=!1,placeholder:y,validate:S,onSave:i,onPressRemove:f}){const c=o.useRef(null),[b,{close:F,toggle:s}]=J(u),[h,q]=o.useState(r),{Field:k,submitForm:T}=Pe({input:{initialValue:r,validate:S}}),g=()=>{T(R=>{Te(R,["input"])&&(q(R.input),i(R.input),F())})};return D(I,{style:E.container,children:[a(ue,{label:t,onPress:s,ref:c,onPressRemove:f,isActive:b,value:h===""?d:h}),a(Q,{role:"listbox",matchReferenceWidth:!1,onDismiss:F,referenceRef:c,returnFocus:!1,visible:b,children:D(I,{style:[E.dropdown,E.inputContent],children:[a(k,{name:"input",children:({error:R,value:P,onChange:p})=>a(Re,{label:t,render:x=>a(qe,{nativeID:x,error:R,style:E.input,placeholder:y,value:P,onChangeText:p})})}),a(ie,{size:"small",color:"current",onPress:g,children:l})]})})]})}function Xe({children:t,onAdd:r,onPressRemove:d}){return o.useEffect(r,[]),a(Ce,{color:"current",onPressRemove:d,children:t})}const re=(t,r,d)=>r[d],fe=({filters:t,openedFilters:r,definition:d,onChangeOpened:l,onChangeFilters:u})=>{const y=Be(r),S=r.length>y.length?r[r.length-1]:void 0;return r.length===0?null:a(de,{direction:"row",wrap:!0,children:r.map(i=>{const f=d[i];return typeof i!="string"||f==null?null:a(I,{children:ce(f).with({type:"radio"},({type:c,label:b,items:F,width:s})=>a(Ye,{label:b,items:F,width:s,autoOpen:S===i,onPressRemove:()=>{u({...t,[i]:void 0}),l(r.filter(h=>h!==i))},value:re(c,t,i),onValueChange:h=>u({...t,[i]:h})})).with({type:"checkbox"},({type:c,label:b,items:F,width:s,checkAllLabel:h,submitText:q})=>a(Je,{label:b,items:F,width:s,checkAllLabel:h,autoOpen:S===i,applyButtonLabel:q,value:re(c,t,i),onValueChange:k=>u({...t,[i]:k}),onPressRemove:()=>{u({...t,[i]:void 0}),l(r.filter(k=>k!==i))}})).with({type:"date"},({type:c,label:b,noValueText:F,submitText:s,dateFormat:h,rifmProps:q,validate:k})=>a(Qe,{label:b,noValueText:F,submitText:s,autoOpen:S===i,dateFormat:h,rifmProps:q,validate:k,initialValue:re(c,t,i),onSave:T=>u({...t,[i]:T}),onPressRemove:()=>{u({...t,[i]:void 0}),l(r.filter(T=>T!==i))}})).with({type:"input"},({type:c,label:b,placeholder:F,noValueText:s,submitText:h,validate:q})=>a(Ge,{label:b,placeholder:F,noValueText:s,submitText:h,autoOpen:S===i,validate:q,initialValue:re(c,t,i),onSave:k=>u({...t,[i]:k}),onPressRemove:()=>{u({...t,[i]:void 0}),l(r.filter(k=>k!==i))}})).with({type:"boolean"},({label:c})=>a(Xe,{onAdd:()=>{u({...t,[i]:!0})},onPressRemove:()=>{u({...t,[i]:void 0}),l(r.filter(b=>b!==i))},children:c})).exhaustive()},i)})})};try{fe.displayName="FiltersStack",fe.__docgenInfo={description:"",displayName:"FiltersStack",props:{definition:{defaultValue:null,description:"",name:"definition",required:!0,type:{name:"FiltersDefinition"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"{ [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }"}},openedFilters:{defaultValue:null,description:"",name:"openedFilters",required:!0,type:{name:"(keyof T)[]"}},onChangeOpened:{defaultValue:null,description:"",name:"onChangeOpened",required:!0,type:{name:"(value: (keyof T)[]) => void"}},onChangeFilters:{defaultValue:null,description:"",name:"onChangeFilters",required:!0,type:{name:"(value: { [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }) => void"}}}}}catch{}const Ze=_e({accept:"numeric",charMap:{2:"/",4:"/"},maxLength:8}),et={type:"radio",label:"Mode",items:[{label:"QES",value:"QES"},{label:"Expert",value:"Expert"}]},tt={type:"checkbox",label:"Status",submitText:"Apply",items:[{label:"Accepted",value:"Accepted"},{label:"Canceled",value:"Canceled"},{label:"Failed",value:"Failed"},{label:"Expired",value:"Expired"},{label:"CustomerRefused",value:"CustomerRefused"}]},rt={type:"date",label:"Start Date",submitText:"Save",noValueText:"None",dateFormat:"DD/MM/YYYY",rifmProps:Ze},nt={type:"input",label:"Resource ID",noValueText:"None",submitText:"Save",placeholder:"Placeholder..."},at={mode:et,status:tt,startDate:rt,resourceId:nt},it=[{name:"mode",label:"Mode"},{name:"status",label:"Status"},{name:"startDate",label:"Start date"},{name:"resourceId",label:"Ressource ID"}],Nt={title:"Forms/Filter",component:ae},ne=()=>{const[t,r]=o.useState([]),[d,l]=o.useState({mode:void 0,status:void 0,resourceId:void 0,startDate:void 0});return a(Me,{title:"Filter",children:a(Ae,{variant:"live",children:D(I,{children:[a(ae,{filters:d,label:"Choose filters",title:"Filters",onAddFilter:u=>r(y=>[...y,u]),availableFilters:it,openFilters:t}),a(j,{height:8}),a(fe,{definition:at,filters:d,openedFilters:t,onChangeFilters:l,onChangeOpened:r})]})})})};var Se,xe,Ve;ne.parameters={...ne.parameters,docs:{...(Se=ne.parameters)==null?void 0:Se.docs,source:{originalSource:`() => {
  const [openFilters, setOpenFilters] = useState<(keyof State)[]>([]);
  const [filters, setFilters] = useState<State>({
    mode: undefined,
    status: undefined,
    resourceId: undefined,
    startDate: undefined
  });
  return <StoryBlock title="Filter">
      <WithCurrentColor variant="live">
        <View>
          <FilterChooser filters={filters} label="Choose filters" title="Filters" onAddFilter={filter => setOpenFilters(filters => [...filters, filter])} availableFilters={availableFilters} openFilters={openFilters} />

          <Space height={8} />

          <FiltersStack definition={definition} filters={filters} openedFilters={openFilters} onChangeFilters={setFilters} onChangeOpened={setOpenFilters} />
        </View>
      </WithCurrentColor>
    </StoryBlock>;
}`,...(Ve=(xe=ne.parameters)==null?void 0:xe.docs)==null?void 0:Ve.source}}};const $t=["All"];export{ne as All,$t as __namedExportsOrder,Nt as default};
//# sourceMappingURL=Filter.stories-fe6858c8.js.map
