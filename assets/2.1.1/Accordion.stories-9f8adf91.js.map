{"version":3,"file":"Accordion.stories-9f8adf91.js","sources":["../../../packages/lake/src/hooks/useFirstMountState.ts","../../../packages/lake/src/components/Accordion.tsx"],"sourcesContent":["import { useRef } from \"react\";\n\nexport const useFirstMountState = (): boolean => {\n  const isFirstMount = useRef(true);\n\n  if (isFirstMount.current) {\n    isFirstMount.current = false;\n    return true;\n  }\n\n  return isFirstMount.current;\n};\n","import { ReactNode, useEffect, useId, useRef } from \"react\";\nimport { Pressable, StyleSheet, View } from \"react-native\";\nimport { backgroundColor, colors, spacings } from \"../constants/design\";\nimport { useDisclosure } from \"../hooks/useDisclosure\";\nimport { useFirstMountState } from \"../hooks/useFirstMountState\";\nimport { Icon } from \"./Icon\";\nimport { LakeText } from \"./LakeText\";\nimport { Space } from \"./Space\";\n\nconst styles = StyleSheet.create({\n  trigger: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    backgroundColor: backgroundColor.accented,\n    paddingVertical: spacings[12],\n    paddingHorizontal: spacings[20],\n  },\n  arrow: {\n    transitionProperty: \"transform\",\n    transitionDuration: \"200ms\",\n  },\n  arrowOpen: {\n    transform: \"rotate(90deg)\",\n  },\n  contentContainer: {\n    display: \"none\",\n    overflow: \"hidden\",\n    transitionDuration: \"300ms\",\n  },\n  contentContainerDisplayed: {\n    display: \"flex\",\n  },\n  content: {\n    paddingVertical: spacings[12],\n    paddingHorizontal: spacings[20],\n  },\n});\n\ntype Props = {\n  trigger: ReactNode;\n  children: ReactNode;\n};\n\nexport const Accordion = ({ trigger, children }: Props) => {\n  const id = useId();\n  const isFirstMount = useFirstMountState();\n  const content = useRef<View | null>(null);\n  const [isOpen, { toggle }] = useDisclosure(false);\n\n  useEffect(() => {\n    const contentElement = content.current;\n\n    if (!isFirstMount && contentElement instanceof HTMLElement) {\n      const handleTransitionEnd = () => {\n        contentElement.removeAttribute(\"style\"); // remove inline styles after transition\n        contentElement.removeEventListener(\"transitionend\", handleTransitionEnd);\n      };\n\n      contentElement.addEventListener(\"transitionend\", handleTransitionEnd);\n\n      if (isOpen) {\n        const contentHeight = contentElement.clientHeight;\n        contentElement.style.height = \"0px\";\n\n        requestAnimationFrame(() => {\n          // wait for rerender to set height and enable css transition\n          contentElement.style.height = `${contentHeight}px`;\n        });\n      } else {\n        // we must set display to flex before we can get the height\n        contentElement.style.display = \"flex\";\n\n        requestAnimationFrame(() => {\n          // wait for rerender to get height\n          const contentHeight = contentElement.clientHeight;\n          contentElement.style.height = `${contentHeight}px`;\n\n          requestAnimationFrame(() => {\n            // wait rerender to set height to 0 and enable css transition\n            contentElement.style.height = \"0px\";\n          });\n        });\n\n        return () => {\n          contentElement.removeEventListener(\"transitionend\", handleTransitionEnd);\n        };\n      }\n    }\n  }, [isFirstMount, isOpen]);\n\n  return (\n    <View>\n      <Pressable aria-expanded={isOpen} aria-controls={id} style={styles.trigger} onPress={toggle}>\n        <Icon\n          name=\"chevron-right-filled\"\n          size={12}\n          color={colors.gray[500]}\n          style={[styles.arrow, isOpen && styles.arrowOpen]}\n        />\n\n        <Space width={20} />\n\n        {typeof trigger === \"string\" ? (\n          <LakeText variant=\"smallMedium\" color={colors.gray[900]}>\n            {trigger}\n          </LakeText>\n        ) : (\n          trigger\n        )}\n      </Pressable>\n\n      <View\n        ref={content}\n        aria-labelledby={id}\n        aria-hidden={!isOpen}\n        role=\"region\"\n        style={[styles.contentContainer, isOpen && styles.contentContainerDisplayed]}\n      >\n        <View style={styles.content}>{children}</View>\n      </View>\n    </View>\n  );\n};\n"],"names":["useFirstMountState","isFirstMount","useRef","styles","StyleSheet","backgroundColor","spacings","Accordion","trigger","children","id","useId","content","isOpen","toggle","useDisclosure","useEffect","contentElement","handleTransitionEnd","contentHeight","jsxs","View","Pressable","jsx","Icon","colors","Space","LakeText"],"mappings":"0qBAEO,MAAMA,EAAqB,IAAe,CACzC,MAAAC,EAAeC,SAAO,EAAI,EAEhC,OAAID,EAAa,SACfA,EAAa,QAAU,GAChB,IAGFA,EAAa,OACtB,ECFAE,EAAAC,EAAA,OAAA,CAAiC,QAAA,CACtB,cAAA,MACQ,WAAA,SACH,gBAAAC,EAAA,SACqB,gBAAAC,EAAA,EAAA,EACL,kBAAAA,EAAA,EAAA,CACE,EAChC,MAAA,CACO,mBAAA,YACe,mBAAA,OACA,EACtB,UAAA,CACW,UAAA,eACE,EACb,iBAAA,CACkB,QAAA,OACP,SAAA,SACC,mBAAA,OACU,EACtB,0BAAA,CAC2B,QAAA,MAChB,EACX,QAAA,CACS,gBAAAA,EAAA,EAAA,EACqB,kBAAAA,EAAA,EAAA,CACE,CAElC,CAAA,EAOOC,EAAA,CAAA,CAAA,QAAAC,EAAA,SAAAC,KAAA,CACL,MAAAC,EAAAC,EAAAA,QACAV,EAAAD,IACAY,EAAAV,SAAA,IAAA,EACA,CAAAW,EAAA,CAAA,OAAAC,CAAA,CAAA,EAAAC,EAAA,EAAA,EAEAC,OAAAA,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAAL,EAAA,QAEA,GAAA,CAAAX,GAAAgB,aAAA,YAAA,CACE,MAAAC,EAAA,IAAA,CACED,EAAA,gBAAA,OAAA,EACAA,EAAA,oBAAA,gBAAAC,CAAA,CAAuE,EAKzE,GAFAD,EAAA,iBAAA,gBAAAC,CAAA,EAEAL,EAAA,CACE,MAAAM,EAAAF,EAAA,aACAA,EAAA,MAAA,OAAA,MAEA,sBAAA,IAAA,CAEEA,EAAA,MAAA,OAAA,GAAAE,KAAiC,CAAA,MAInC,QAAAF,EAAA,MAAA,QAAA,OAEA,sBAAA,IAAA,CAEE,MAAAE,EAAAF,EAAA,aACAA,EAAA,MAAA,OAAA,GAAAE,MAEA,sBAAA,IAAA,CAEEF,EAAA,MAAA,OAAA,KAA8B,CAAA,CAC/B,CAAA,EAGH,IAAA,CACEA,EAAA,oBAAA,gBAAAC,CAAA,CAAuE,EAG7E,EAAA,CAAAjB,EAAAY,CAAA,CAAA,EAGFO,EAAAC,EAAA,CAAA,SAAA,CAEID,EAAAE,EAAA,CAAA,gBAAAT,EAAA,gBAAAH,EAAA,MAAAP,EAAA,QAAA,QAAAW,EAAA,SAAA,CACES,EAAAC,EAAC,CAAA,KAAA,uBACM,KAAA,GACC,MAAAC,EAAA,KAAA,GAAA,EACgB,MAAA,CAAAtB,EAAA,MAAAU,GAAAV,EAAA,SAAA,CAC0B,CAAA,EAClDoB,EAAAG,EAAA,CAAA,MAAA,EAAA,CAAA,EAEkB,OAAAlB,GAAA,SAAAe,EAAAI,EAAA,CAAA,QAAA,cAAA,MAAAF,EAAA,KAAA,GAAA,EAAA,SAAAjB,CAAA,CAAA,EAAAA,CAOhB,EAAA,EAEJe,EAEAF,EAAC,CAAA,IAAAT,EACM,kBAAAF,EACY,cAAA,CAAAG,EACH,KAAA,SACT,MAAA,CAAAV,EAAA,iBAAAU,GAAAV,EAAA,yBAAA,EACsE,SAAAoB,EAAAF,EAAA,CAAA,MAAAlB,EAAA,QAAA,SAAAM,EAAA,CAEpC,CAAA,CACzC,CAAA,CAAA,CAGN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}