import{s as F,R as y,j as e,$ as z,v as R,g as U,L as w,c as Y,G as W,e as S,N as P,B as G}from"./ScrollView-CnkSV7w6.js";import{r as l}from"./index-Cs7sjTYM.js";import{L as E}from"./LakeCombobox-CaXF-V4d.js";import{b as H,S as J,a as g}from"./_StoriesComponents-BdGCWCNA.js";import{b as B,g as D,t as Q}from"./i18n-PICbwUyg.js";import{_ as X}from"./iframe-BUgH9z-N.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BU4L-DQy.js";import"./Pressable-BGOPdkuK.js";import"./a11y-DXvpDVrG.js";import"./Popover-j6IN-vPI.js";import"./useResponsive-CzIqCC5v.js";import"./function-D_aCpe7c.js";import"./BottomPanel-C0i52C2n.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-DMoYUPTW.js";import"./FocusTrap-fPGTEZsC.js";import"./array-rjEBP2Ry.js";import"./Suspendable-BPrtu9_T.js";import"./index-Ckk5_94c.js";import"./extends-CF3RwP-h.js";import"./TransitionView-CCVDrWcn.js";import"./index-tMLA6eGL.js";import"./LakeTextInput-BooRKEW-.js";import"./Fill-DFbCnG2s.js";import"./LakeSelect-CZ-mOKvi.js";import"./useDisclosure-DLkMFUa4.js";import"./rifm-CYIyesWt.js";import"./utc-DJvBpWoA.js";import"./string-CfGb_hXU.js";import"../../sb-preview/runtime.js";const _=F.create({unselectable:{userSelect:"none"}}),I=({inputRef:a,value:o,onValueChange:t,disabled:u,id:n,placeholder:p,error:f,emptyResultText:c,ListFooterComponent:s,shouldDisplaySuggestions:h=!0,loadSuggestions:m,onSuggestion:x,onLoadError:C})=>{const[d,b]=l.useState(y.NotAsked()),i=l.useRef();return e.jsx(E,{inputRef:a,id:n,placeholder:p,value:o??"",items:d,icon:m!=null?"search-filled":void 0,disabled:u,error:f,ListFooterComponent:s!=null&&e.jsxs(e.Fragment,{children:[z(d).with(y.P.Done(R.P.Ok(U.select())),r=>r.length>0?e.jsx(H,{}):null).otherwise(()=>null),s]}),onSelectItem:r=>{x(r)},onValueChange:r=>{var T;if((T=i.current)==null||T.cancel(),i.current=void 0,t(r),r.length<=3||!h)return b(y.NotAsked());if(m!=null){b(y.Loading());const k=m(r);i.current=k,C!=null&&k.tapError(C),k.onResolve(q=>b(y.Done(q)))}},keyExtractor:r=>`${r.title} ${r.subtitle}`,emptyResultText:c,renderItem:r=>e.jsxs(e.Fragment,{children:[e.jsx(w,{numberOfLines:1,style:_.unselectable,color:Y.gray[900],children:r.title}),e.jsx(w,{numberOfLines:1,style:_.unselectable,variant:"smallRegular",children:r.subtitle})]})})};I.__docgenInfo={description:"",methods:[],displayName:"AutocompleteSearchInput",props:{inputRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"unknown"}],raw:"MutableRefObject<unknown>"},description:""},value:{required:!1,tsType:{name:"string"},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},id:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},error:{required:!1,tsType:{name:"string"},description:""},emptyResultText:{required:!0,tsType:{name:"string"},description:""},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},shouldDisplaySuggestions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},loadSuggestions:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => Future<Result<Suggestion<T>[], unknown>>",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Future",elements:[{name:"Result",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  title: string;
  subtitle: string;
  value: T;
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"subtitle",value:{name:"string",required:!0}},{key:"value",value:{name:"T",required:!0}}]}}],raw:"Suggestion<T>[]"},{name:"unknown"}],raw:"Result<Suggestion<T>[], unknown>"}],raw:"Future<Result<Suggestion<T>[], unknown>>"}}},description:""},onSuggestion:{required:!0,tsType:{name:"signature",type:"function",raw:"(suggestion: Suggestion<T>) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  title: string;
  subtitle: string;
  value: T;
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"subtitle",value:{name:"string",required:!0}},{key:"value",value:{name:"T",required:!0}}]}},name:"suggestion"}],return:{name:"void"}}},description:""},onLoadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"error"}],return:{name:"void"}}},description:""}}};const N=(a,o)=>{let t;return(...u)=>(clearTimeout(t),new Promise(n=>{t=setTimeout(()=>n(a(...u)),o)}))},M=({apiKey:a,debounceInterval:o=1e3})=>{const[t,u]=l.useState();return l.useEffect(()=>{a!=null&&X(async()=>{const{default:n}=await import("./placekit-lite-Bp5f6h80.js");return{default:n}},[]).then(({default:n})=>{u(n(a))})},[a]),l.useMemo(()=>{if(t!=null)return{...t,search:N(t.search,o),reverse:N(t.reverse,o)}},[t,o])},K=({inputRef:a,id:o,country:t,disabled:u,error:n,value:p,onValueChange:f,onSuggestion:c,language:s,placeholder:h,shouldDisplaySuggestions:m=!0,emptyResultText:x,apiKey:C})=>{const d=M({apiKey:C}),b=l.useCallback(r=>{if(d!=null){const T=W.filterMap(B[t]??[t],q=>S.fromNullable(D(q))),k=T.length===0?S.None():S.Some(T);return P.fromPromise(d.search(r,{types:["street"],language:s,countries:k.toUndefined()})).mapOk(({results:q})=>q.map(A=>({title:A.name,subtitle:A.city,value:A})),!0)}return P.value(R.Ok([]))},[d,t,s]),i=l.useCallback(r=>{c==null||c({completeAddress:r.value.name,postalCode:r.value.zipcode[0],city:r.value.city})},[c]);return e.jsx(I,{inputRef:a,value:p,onValueChange:f,disabled:u,id:o,placeholder:h,error:n,emptyResultText:x,shouldDisplaySuggestions:m,loadSuggestions:d!=null?b:void 0,onSuggestion:i})};K.__docgenInfo={description:"",methods:[],displayName:"PlacekitAddressSearchInput",props:{inputRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"unknown"}],raw:"MutableRefObject<unknown>"},description:""},id:{required:!1,tsType:{name:"string"},description:""},country:{required:!0,tsType:{name:'Simplify["cca3"]',raw:'Country["cca3"]'},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"string"},description:""},onSuggestion:{required:!1,tsType:{name:"signature",type:"function",raw:"(suggestion: AddressDetail) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  completeAddress: string;
  city: string;
  postalCode?: string;
}`,signature:{properties:[{key:"completeAddress",value:{name:"string",required:!0}},{key:"city",value:{name:"string",required:!0}},{key:"postalCode",value:{name:"string",required:!1}}]}},name:"suggestion"}],return:{name:"void"}}},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},value:{required:!1,tsType:{name:"string"},description:""},language:{required:!0,tsType:{name:"union",raw:'"en" | "es" | "de" | "fi" | "fr" | "it" | "nl" | "pt"',elements:[{name:"literal",value:'"en"'},{name:"literal",value:'"es"'},{name:"literal",value:'"de"'},{name:"literal",value:'"fi"'},{name:"literal",value:'"fr"'},{name:"literal",value:'"it"'},{name:"literal",value:'"nl"'},{name:"literal",value:'"pt"'}]},description:""},placeholder:{required:!0,tsType:{name:"string"},description:""},shouldDisplaySuggestions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},emptyResultText:{required:!0,tsType:{name:"string"},description:""},apiKey:{required:!1,tsType:{name:"string"},description:""}}};const $=({value:a,onValueChange:o,country:t,disabled:u,placeholder:n,id:p,error:f,onSuggestion:c,onLoadError:s,apiKey:h})=>{const m=M({apiKey:h}),x=l.useCallback(d=>{if(m!=null){const b=S.fromNullable(t).map(i=>B[i]??[i]).map(i=>W.filterMap(i,r=>S.fromNullable(D(r)))).flatMap(i=>i.length===0?S.None():S.Some(i));return P.fromPromise(m.search(d,{types:["city"],countries:b.toUndefined()})).mapOk(({results:i})=>i.map(r=>({title:r.name,subtitle:r.city,value:r})),!0)}return P.value(R.Ok([]))},[m,t]),C=l.useCallback(d=>{c==null||c({city:d.value.city,postalCode:d.value.zipcode[0]})},[c]);return e.jsx(I,{value:a,onValueChange:o,disabled:u,id:p,placeholder:n,error:f,emptyResultText:Q("common.noResult"),loadSuggestions:m!=null?x:void 0,onSuggestion:C,onLoadError:s})};$.__docgenInfo={description:"",methods:[],displayName:"PlacekitCityInput",props:{value:{required:!0,tsType:{name:"string"},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},country:{required:!1,tsType:{name:'Simplify["cca3"]',raw:'Country["cca3"]'},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"string"},description:""},id:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},onSuggestion:{required:!1,tsType:{name:"signature",type:"function",raw:"(place: CityDetail) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  city: string;
  postalCode?: string;
}`,signature:{properties:[{key:"city",value:{name:"string",required:!0}},{key:"postalCode",value:{name:"string",required:!1}}]}},name:"place"}],return:{name:"void"}}},description:""},onLoadError:{required:!0,tsType:{name:"signature",type:"function",raw:"(error: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"error"}],return:{name:"void"}}},description:""},apiKey:{required:!1,tsType:{name:"string"},description:""}}};const Z=F.create({footer:{paddingHorizontal:12}}),Ie={title:"Forms/Combobox",component:E},ee=a=>{const o=fetch(`https://dummyjson.com/products/search?limit=10&q=${a}`).then(t=>t.json()).then(t=>t.products);return P.fromPromise(o)},v=a=>{const[o,t]=l.useState(null),[u,n]=l.useState(()=>y.NotAsked()),[p,f]=l.useState(""),c=o?o.title:p;return l.useEffect(()=>{if(!p){n(y.NotAsked());return}n(y.Loading());const s=ee(p);return s.onResolve(h=>{n(y.Done(h))}),()=>{s.cancel()}},[p]),e.jsx(E,{value:c,items:u,onValueChange:s=>{t(null),f(s)},onSelectItem:s=>{n(y.NotAsked()),t(s)},keyExtractor:s=>s.id.toString(),renderItem:s=>e.jsx(w,{children:s.title}),emptyResultText:"No result",...a})},j=()=>{const[a,o]=l.useState(""),[t,u]=l.useState("");return e.jsxs(J,{title:"Combobox",children:[e.jsx(g,{title:"By default",children:e.jsx(v,{})}),e.jsx(g,{title:"Is disabled",children:e.jsx(v,{disabled:!0})}),e.jsx(g,{title:"Is readOnly",children:e.jsx(v,{readOnly:!0})}),e.jsx(g,{title:"With icon",children:e.jsx(v,{icon:"add-circle-regular"})}),e.jsx(g,{title:"With placeholder",children:e.jsx(v,{placeholder:"Enter a product"})}),e.jsx(g,{title:"With error",children:e.jsx(v,{placeholder:"An error occurred"})}),e.jsx(g,{title:"With Footer Component",children:e.jsx(v,{ListFooterComponent:e.jsx(G,{direction:"row",justifyContent:"end",style:Z.footer,children:e.jsx(w,{children:"With footer component"})})})}),e.jsx(g,{title:"CityInput",children:e.jsx($,{apiKey:void 0,country:"FRA",value:t,onValueChange:u,onSuggestion:n=>{console.log(n.city),console.log(n.postalCode)},onLoadError:()=>{}})}),e.jsx(g,{title:"AddressInput",children:e.jsx(K,{apiKey:void 0,country:"FRA",value:a,onValueChange:o,onSuggestion:n=>{console.log(n.completeAddress),console.log(n.city),console.log(n.postalCode)},language:"fr",placeholder:"",emptyResultText:"Nothing"})})]})};j.__docgenInfo={description:"",methods:[],displayName:"Variations"};var L,V,O;j.parameters={...j.parameters,docs:{...(L=j.parameters)==null?void 0:L.docs,source:{originalSource:`() => {
  const [search, setSearch] = useState("");
  const [city, setCity] = useState("");
  return <StoryBlock title="Combobox">
      <StoryPart title="By default">
        <EditableCombobox />
      </StoryPart>

      <StoryPart title="Is disabled">
        <EditableCombobox disabled={true} />
      </StoryPart>

      <StoryPart title="Is readOnly">
        <EditableCombobox readOnly={true} />
      </StoryPart>

      <StoryPart title="With icon">
        <EditableCombobox icon={"add-circle-regular"} />
      </StoryPart>

      <StoryPart title="With placeholder">
        <EditableCombobox placeholder={"Enter a product"} />
      </StoryPart>

      <StoryPart title="With error">
        <EditableCombobox placeholder={"An error occurred"} />
      </StoryPart>

      <StoryPart title="With Footer Component">
        <EditableCombobox ListFooterComponent={<Box direction="row" justifyContent="end" style={styles.footer}>
              <LakeText>With footer component</LakeText>
            </Box>} />
      </StoryPart>

      <StoryPart title="CityInput">
        <PlacekitCityInput apiKey={PLACEKIT_API_KEY} country="FRA" value={city} onValueChange={setCity} onSuggestion={place => {
        console.log(place.city);
        console.log(place.postalCode);
      }} onLoadError={() => {}} />
      </StoryPart>

      <StoryPart title="AddressInput">
        <PlacekitAddressSearchInput apiKey={PLACEKIT_API_KEY} country="FRA" value={search} onValueChange={setSearch} onSuggestion={place => {
        console.log(place.completeAddress);
        console.log(place.city);
        console.log(place.postalCode);
      }} language="fr" placeholder="" emptyResultText="Nothing" />
      </StoryPart>
    </StoryBlock>;
}`,...(O=(V=j.parameters)==null?void 0:V.docs)==null?void 0:O.source}}};const _e=["Variations"];export{j as Variations,_e as __namedExportsOrder,Ie as default};
//# sourceMappingURL=Combobox.stories-8-XHyTiO.js.map
