{"version":3,"file":"SupportingDocumentCollection.stories-4Lwtgcwm.js","sources":["../../../node_modules/@swan-io/request/dist/Request.mjs","../../../packages/lake/src/components/Form.tsx","../../../packages/shared-business/src/components/SupportingDocumentCollection.tsx","../../../packages/shared-business/__stories__/SupportingDocumentCollection.stories.tsx"],"sourcesContent":["import{Result as t,Future as e,Dict as r,Option as n}from\"@swan-io/boxed\";function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(o=function(){return!!t})()}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,s(t,e)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=\"function\"==typeof Map?new Map:void 0;return a=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf(\"[native code]\")}catch(e){return\"function\"==typeof t}}(t))return t;if(\"function\"!=typeof t)throw new TypeError(\"Super expression must either be null or a function\");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(o())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var u=new(t.bind.apply(t,n));return r&&s(u,r.prototype),u}(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,t)},a(t)}function c(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}var l=/*#__PURE__*/function(t){function e(r){var n;return(n=t.call(this,\"Request to \"+r+\" failed\")||this).url=void 0,Object.setPrototypeOf(c(n),e.prototype),n.name=\"NetworkError\",n.url=r,n}return u(e,t),e}(/*#__PURE__*/a(Error)),p=/*#__PURE__*/function(t){function e(r,n){var o;return null==n?((o=t.call(this,\"Request to \"+r+\" timed out\")||this).url=void 0,o.timeout=void 0):((o=t.call(this,\"Request to \"+r+\" timed out (> \"+n+\"ms)\")||this).url=void 0,o.timeout=void 0),Object.setPrototypeOf(c(o),e.prototype),o.name=\"TimeoutError\",o.url=r,o.timeout=n,c(o)}return u(e,t),e}(/*#__PURE__*/a(Error)),f=/*#__PURE__*/function(t){function e(r,n,o){var u;return(u=t.call(this,\"Request to \"+r+\" gave status \"+n)||this).url=void 0,u.status=void 0,u.response=void 0,Object.setPrototypeOf(c(u),e.prototype),u.name=\"BadStatusError\",u.url=r,u.status=n,u.response=o,u}return u(e,t),e}(/*#__PURE__*/a(Error)),d=function(e){return e.ok?t.Ok(e):t.Error(new f(e.url,e.status,e.response.toUndefined()))},v=/*#__PURE__*/function(t){function e(r){var n;return(n=t.call(this,\"Request to \"+r+\" gave an empty response\")||this).url=void 0,Object.setPrototypeOf(c(n),e.prototype),n.name=\"EmptyResponseError\",n.url=r,n}return u(e,t),e}(/*#__PURE__*/a(Error)),y=function(t){return t.response.toResult(new v(t.url))},m={make:function(o){var u=o.url,i=o.method,s=void 0===i?\"GET\":i,a=o.responseType,c=o.body,f=o.headers,d=o.withCredentials,v=void 0!==d&&d,y=o.onLoadStart,m=o.onProgress,h=o.timeout;return e.make(function(e){var o=new XMLHttpRequest;o.withCredentials=v,o.open(s,u,!0),null!=a&&(o.responseType=a),null!=h&&(o.timeout=h),null!=f&&r.entries(f).forEach(function(t){return o.setRequestHeader(t[0],t[1])});var i=function(){b(),e(t.Error(new l(u)))},d=function(){b(),e(t.Error(new p(u,h)))},E=function(){b();var r=o.status,i=n.fromNullable(o.response);e(t.Ok({url:u,status:r,ok:r>=200&&r<300,response:i,xhr:o}))},b=function(){o.removeEventListener(\"error\",i),o.removeEventListener(\"load\",E),o.removeEventListener(\"timeout\",d),null!=y&&o.removeEventListener(\"loadstart\",y),null!=m&&o.removeEventListener(\"progress\",m)};return o.addEventListener(\"error\",i),o.addEventListener(\"load\",E),o.addEventListener(\"timeout\",d),null!=y&&o.addEventListener(\"loadstart\",y),null!=m&&o.addEventListener(\"progress\",m),o.send(c),function(){b(),o.abort()}})}};export{f as BadStatusError,v as EmptyResponseError,l as NetworkError,m as Request,p as TimeoutError,d as badStatusToError,y as emptyToError};\n//# sourceMappingURL=Request.mjs.map\n","import { forwardRef, memo, ReactNode } from \"react\";\nimport { unstable_createElement as createElement, View, ViewProps } from \"react-native\";\nimport { Except } from \"type-fest\";\nimport { commonStyles } from \"../constants/commonStyles\";\n\ntype Props = Except<ViewProps, \"role\"> & {\n  children?: ReactNode;\n  onReset?: (event: React.FormEvent<HTMLElement>) => void;\n  onSubmit?: (event: React.FormEvent<HTMLElement>) => void;\n};\n\nexport const Form = memo(\n  forwardRef<View, Props>(({ style, onReset, onSubmit, ...props }, forwardedRef) =>\n    createElement(\"form\", {\n      ...props,\n      ref: forwardedRef,\n      onReset: (event: React.FormEvent<HTMLElement>) => {\n        event.preventDefault();\n        onReset?.(event);\n      },\n      onSubmit: (event: React.FormEvent<HTMLElement>) => {\n        event.preventDefault();\n        onSubmit?.(event);\n      },\n      style: [commonStyles.view, style],\n    }),\n  ),\n);\n\nForm.displayName = \"Form\";\n","import { Array, Future, Option, Result } from \"@swan-io/boxed\";\nimport { Form } from \"@swan-io/lake/src/components/Form\";\nimport { IconName } from \"@swan-io/lake/src/components/Icon\";\nimport { LakeButton, LakeButtonGroup } from \"@swan-io/lake/src/components/LakeButton\";\nimport { LakeCopyButton } from \"@swan-io/lake/src/components/LakeCopyButton\";\nimport { LakeLabel } from \"@swan-io/lake/src/components/LakeLabel\";\nimport { LakeText } from \"@swan-io/lake/src/components/LakeText\";\nimport { LakeTooltip } from \"@swan-io/lake/src/components/LakeTooltip\";\nimport { ReadOnlyFieldList } from \"@swan-io/lake/src/components/ReadOnlyFieldList\";\nimport { Space } from \"@swan-io/lake/src/components/Space\";\nimport { colors } from \"@swan-io/lake/src/constants/design\";\nimport { isNotNullish } from \"@swan-io/lake/src/utils/nullish\";\nimport { NetworkError, Request, Response, TimeoutError, badStatusToError } from \"@swan-io/request\";\nimport {\n  ForwardedRef,\n  Fragment,\n  Ref,\n  forwardRef,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { match } from \"ts-pattern\";\nimport { UploadFileInput, UploadOutputWithId } from \"../hooks/useFilesUploader\";\nimport { SwanFile } from \"../utils/SwanFile\";\nimport { isTranslationKey, locale, t } from \"../utils/i18n\";\nimport { FilesUploader, FilesUploaderRef } from \"./FilesUploader\";\nimport { LakeModal } from \"./LakeModal\";\n\nconst ACCEPTED_FORMATS = [\"application/pdf\", \"image/png\", \"image/jpeg\", \"image/heic\"];\n\nexport type Document<Purpose extends string> = {\n  purpose: Purpose;\n  file: SwanFile;\n};\n\ntype UploadInput<Purpose extends string> = { fileName: string; purpose: Purpose };\nexport type UploadOutput = { url: string; fields: { key: string; value: string }[] };\n\ntype SupportingDocumentCollectionStatus =\n  | \"WaitingForDocument\"\n  | \"PendingReview\"\n  | \"Approved\"\n  | \"Canceled\"\n  | \"Rejected\";\n\ntype PurposeMetadata = {\n  title: string;\n  values: {\n    type?: \"text\" | \"copy\";\n    title: string;\n    value: string;\n  }[];\n};\n\ntype Props<Purpose extends string> = {\n  status: SupportingDocumentCollectionStatus;\n  generateUpload: (\n    input: UploadInput<Purpose>,\n  ) => Future<Result<UploadOutputWithId<UploadOutput>, unknown>>;\n  documents: Document<Purpose>[];\n  requiredDocumentPurposes: Purpose[];\n  uploadFile?: (\n    config: UploadFileInput<UploadOutput>,\n  ) => Future<Result<Response<string>, NetworkError | TimeoutError>>;\n  onChange?: (documents: Document<Purpose>[]) => void;\n  onRemoveFile?: (file: SwanFile) => Future<Result<unknown, unknown>>;\n  templateLanguage?: string;\n  showIds?: boolean;\n  readOnly?: boolean;\n  getPurposeMetadata?: (purose: Purpose) => PurposeMetadata | undefined;\n  readonlyDocumentPurposes?: Purpose[];\n};\n\nconst styles = StyleSheet.create({\n  button: {\n    opacity: 1,\n  },\n  buttonWithDefaultCursor: {\n    opacity: 1,\n    cursor: \"default\",\n  },\n});\n\ntype HelpProps =\n  | {\n      type: \"tooltip\";\n      text: string;\n      icon?: IconName;\n      width?: number;\n    }\n  | {\n      type: \"button\";\n      label: string;\n      icon?: IconName;\n      onPress: () => void;\n    };\n\nconst Help = (props: HelpProps) => {\n  return match(props)\n    .with({ type: \"tooltip\" }, ({ text, width }) => (\n      <LakeTooltip\n        content={text}\n        width={width}\n        togglableOnFocus={true}\n        placement=\"right\"\n        maxWidth={400}\n      >\n        <LakeButton\n          mode=\"tertiary\"\n          size=\"small\"\n          color=\"gray\"\n          icon={props.icon ?? \"question-circle-regular\"}\n          disabled={true}\n          style={[styles.button, styles.buttonWithDefaultCursor]}\n          ariaLabel={t(\"supportingDocuments.help.whatIsThis\")}\n        />\n      </LakeTooltip>\n    ))\n    .with({ type: \"button\" }, ({ label, onPress }) => (\n      <LakeButton\n        mode=\"tertiary\"\n        size=\"small\"\n        color=\"gray\"\n        icon={props.icon ?? \"question-circle-regular\"}\n        onPress={onPress}\n        style={styles.button}\n        ariaLabel={t(\"supportingDocuments.help.whatIsThis\")}\n      >\n        {label}\n      </LakeButton>\n    ))\n    .exhaustive();\n};\n\nexport const getSupportingDocumentPurposeLabel = (purpose: string) => {\n  const key = `supportingDocuments.purpose.${purpose}`;\n  if (isTranslationKey(key)) {\n    return t(key);\n  } else {\n    return purpose;\n  }\n};\n\nexport const getSupportingDocumentPurposeDescriptionLabel = (purpose: string) => {\n  const key = `supportingDocuments.purpose.${purpose}.description`;\n  if (isTranslationKey(key)) {\n    return t(key);\n  } else {\n    return \"\";\n  }\n};\n\nexport type SupportingDocumentCollectionRef<Purpose extends string> = {\n  areAllRequiredDocumentsFilled: () => boolean;\n  addDocument: (document: Document<Purpose>) => void;\n};\n\nexport const SupportingDocumentCollectionWithRef = <Purpose extends string>(\n  {\n    documents,\n    generateUpload,\n    uploadFile,\n    requiredDocumentPurposes,\n    templateLanguage = locale.language,\n    status,\n    onRemoveFile,\n    showIds = false,\n    readOnly = false,\n    getPurposeMetadata,\n    readonlyDocumentPurposes = [],\n  }: Props<Purpose>,\n  ref: Ref<SupportingDocumentCollectionRef<Purpose>>,\n) => {\n  const [showPowerOfAttorneyModal, setShowPowerOfAttorneyModal] = useState(false);\n  const [showSwornStatementModal, setShowSwornStatementModal] = useState(false);\n  const [currentMetadata, setCurrentMetadata] = useState<PurposeMetadata | undefined>(undefined);\n\n  const [addedDocuments, setAddedDocuments] = useState<Document<Purpose>[]>([]);\n\n  const orderedDocumentPurposes = useMemo(() => {\n    // Get all purposes to display: the required ones and the ones that have at least a document\n    const allPurposes = new Set(requiredDocumentPurposes);\n    const allDocuments = [...addedDocuments, ...documents];\n    allDocuments.forEach(document => allPurposes.add(document.purpose));\n\n    const documentsByPurpose = new Map(\n      [...allPurposes].map(purpose => {\n        const purposeDocuments = allDocuments.filter(document => document.purpose === purpose);\n        return [purpose, purposeDocuments];\n      }),\n    );\n\n    // Map purposes to their priorities (lower priority comes first)\n    // We precompute it to avoid running on each `sort` callback call\n    const allRequiredPurposes = new Set(requiredDocumentPurposes);\n    // Indices:\n    // -> 0: documents aren't empty and all validated\n    // -> 1: purpose is required\n    // -> 2: purpose isn't required\n    const priorityByPurpose = new Map(\n      [...allPurposes].map(purpose => {\n        const purposeDocuments = documentsByPurpose.get(purpose) ?? [];\n        const areAllPurposeDocumentsValidated =\n          purposeDocuments.length > 0 &&\n          purposeDocuments.every(document => document.file.statusInfo.status === \"Validated\");\n\n        const priority = areAllPurposeDocumentsValidated\n          ? 0\n          : allRequiredPurposes.has(purpose)\n            ? 1\n            : 2;\n\n        return [purpose, priority];\n      }),\n    );\n\n    return [...allPurposes]\n      .sort((purposeA, purposeB) => {\n        const purposeAPriority = priorityByPurpose.get(purposeA) ?? 2;\n        const purposeBPriority = priorityByPurpose.get(purposeB) ?? 2;\n\n        return purposeBPriority > purposeAPriority ? -1 : 1;\n      })\n      .map(purpose => {\n        const documents = documentsByPurpose.get(purpose) ?? [];\n        return {\n          purpose,\n          files: documents.map(item => item.file),\n          isRequired: allRequiredPurposes.has(purpose),\n          areAllDocumentsValidated: priorityByPurpose.get(purpose) === 0,\n        };\n      });\n  }, [requiredDocumentPurposes, documents, addedDocuments]);\n\n  const filesByRequiredPurpose = useRef(\n    new Map(\n      Array.filterMap(orderedDocumentPurposes, ({ isRequired, purpose, files }) =>\n        isRequired ? Option.Some([purpose, files]) : Option.None(),\n      ),\n    ),\n  );\n\n  const filesUploaderRefByPurpose = useRef<Partial<Record<Purpose, FilesUploaderRef | null>>>({});\n\n  useImperativeHandle(ref, () => ({\n    areAllRequiredDocumentsFilled: () => {\n      const filesByPurposes = [...filesByRequiredPurpose.current.values()];\n      return filesByPurposes.every(files => files.length > 0);\n    },\n    addDocument: document => {\n      setAddedDocuments(documents => [...documents, document]);\n    },\n  }));\n\n  useEffect(() => {\n    const lastAddedDocument = addedDocuments[addedDocuments.length - 1];\n    if (lastAddedDocument != null) {\n      const ref = filesUploaderRefByPurpose.current[lastAddedDocument?.purpose];\n      if (ref != null) {\n        ref.add(lastAddedDocument.file);\n      }\n    }\n  }, [addedDocuments]);\n\n  const showableDocumentPurposes = orderedDocumentPurposes.filter(({ files }) => {\n    // Completely hide the purpose section if empty and no action is available\n    if (readOnly && files.length === 0) {\n      return false;\n    }\n    return true;\n  });\n\n  return (\n    <Form>\n      {showableDocumentPurposes.map(({ purpose, files, areAllDocumentsValidated, isRequired }) => {\n        const metadata = getPurposeMetadata?.(purpose);\n\n        const label = getSupportingDocumentPurposeDescriptionLabel(purpose);\n\n        return (\n          <Fragment key={purpose}>\n            <LakeLabel\n              label={getSupportingDocumentPurposeLabel(purpose)}\n              description={label}\n              help={\n                isNotNullish(metadata) ? (\n                  <Help\n                    type=\"button\"\n                    label={metadata.title}\n                    onPress={() => setCurrentMetadata(metadata)}\n                  />\n                ) : (\n                  match(purpose as string)\n                    .with(\"PowerOfAttorney\", () => (\n                      <Help\n                        type=\"button\"\n                        icon=\"arrow-down-filled\"\n                        label={t(\"supportingDocuments.help.downloadTemplate\")}\n                        onPress={() => setShowPowerOfAttorneyModal(true)}\n                      />\n                    ))\n                    .with(\"SwornStatement\", () => (\n                      <Help\n                        type=\"button\"\n                        icon=\"arrow-down-filled\"\n                        label={t(\"supportingDocuments.help.downloadTemplate\")}\n                        onPress={() => setShowSwornStatementModal(true)}\n                      />\n                    ))\n                    .otherwise(() => null)\n                )\n              }\n              render={() => (\n                <FilesUploader\n                  ref={ref => (filesUploaderRefByPurpose.current[purpose] = ref)}\n                  // Only allow uploading is the Supporting Document Collection awaits for docs\n                  // and that the specific purpose isn't already fully validated\n                  canUpload={\n                    !readonlyDocumentPurposes.includes(purpose) &&\n                    !readOnly &&\n                    status === \"WaitingForDocument\" &&\n                    !areAllDocumentsValidated\n                  }\n                  accept={ACCEPTED_FORMATS}\n                  maxSize={20_000_000}\n                  icon=\"document-regular\"\n                  initialFiles={files}\n                  generateUpload={generateUpload}\n                  getUploadConfig={file => ({ fileName: file.name, purpose })}\n                  uploadFile={\n                    isNotNullish(uploadFile)\n                      ? uploadFile\n                      : ({ upload, file, onLoadStart, onProgress }) => {\n                          const body = new FormData();\n                          upload.fields.forEach(({ key, value }) => body.append(key, value));\n                          body.append(\"file\", file);\n                          return Request.make({\n                            url: upload.url,\n                            method: \"POST\",\n                            onLoadStart,\n                            onProgress,\n                            body,\n                          }).mapOkToResult(badStatusToError);\n                        }\n                  }\n                  formatAndSizeDescription={t(\"supportingDocuments.documentTypes\", {\n                    maxSizeMB: 20_000_000 / 1_000_000,\n                  })}\n                  onRemoveFile={readOnly ? undefined : onRemoveFile}\n                  onChange={files => {\n                    if (isRequired) {\n                      filesByRequiredPurpose.current.set(purpose, files);\n                    }\n                  }}\n                  showIds={showIds}\n                />\n              )}\n            />\n\n            <Space height={24} />\n          </Fragment>\n        );\n      })}\n\n      {showableDocumentPurposes.length === 0 ? (\n        <>\n          <Space height={24} />\n          <LakeText align=\"center\">{t(\"supportingDocuments.noDocuments\")}</LakeText>\n          <Space height={24} />\n        </>\n      ) : null}\n\n      <LakeModal\n        visible={showPowerOfAttorneyModal}\n        title={t(\"supportingDocuments.powerOfAttorneyModal.title\")}\n        icon=\"document-regular\"\n        onPressClose={() => setShowPowerOfAttorneyModal(false)}\n      >\n        <LakeText>{t(\"supportingDocuments.powerOfAttorneyModal.description\")}</LakeText>\n        <Space height={16} />\n\n        <LakeButtonGroup paddingBottom={0}>\n          <LakeButton\n            grow={true}\n            color=\"current\"\n            onPress={() =>\n              window.open(\n                `/power-of-attorney-template/${match(templateLanguage)\n                  .with(\"fr\", () => \"fr\")\n                  .with(\"de\", () => \"de\")\n                  .with(\"es\", () => \"es\")\n                  .otherwise(() => \"en\")}.pdf`,\n              )\n            }\n          >\n            {t(\"supportingDocuments.downloadTemplate\")}\n          </LakeButton>\n        </LakeButtonGroup>\n      </LakeModal>\n\n      <LakeModal\n        visible={showSwornStatementModal}\n        title={t(\"supportingDocuments.purpose.SwornStatement\")}\n        icon=\"document-regular\"\n        onPressClose={() => setShowSwornStatementModal(false)}\n      >\n        <LakeText>{t(\"supportingDocuments.purpose.SwornStatement.description\")}</LakeText>\n        <Space height={16} />\n\n        <LakeButtonGroup paddingBottom={0}>\n          <LakeButton\n            grow={true}\n            color=\"current\"\n            onPress={() => window.open(\"/sworn-statement-template/es.pdf\")}\n          >\n            {t(\"supportingDocuments.downloadTemplate\")}\n          </LakeButton>\n        </LakeButtonGroup>\n      </LakeModal>\n\n      <LakeModal\n        visible={isNotNullish(currentMetadata)}\n        title={t(\"supportingDocuments.informations\")}\n        icon=\"document-regular\"\n        onPressClose={() => setCurrentMetadata(undefined)}\n      >\n        <ReadOnlyFieldList>\n          {currentMetadata?.values.map(({ title, value, type }) => (\n            <LakeLabel\n              type=\"viewSmall\"\n              label={title}\n              actions={\n                type === \"copy\" && (\n                  <LakeCopyButton\n                    valueToCopy={value}\n                    copiedText={t(\"copyButton.copiedTooltip\")}\n                    copyText={t(\"copyButton.copyTooltip\")}\n                  />\n                )\n              }\n              render={() => (\n                <LakeText variant=\"regular\" color={colors.gray[900]}>\n                  {value}\n                </LakeText>\n              )}\n            />\n          ))}\n        </ReadOnlyFieldList>\n      </LakeModal>\n    </Form>\n  );\n};\n\nexport const SupportingDocumentCollection = forwardRef(SupportingDocumentCollectionWithRef) as <\n  I extends string,\n>(\n  props: Props<I> & { ref?: ForwardedRef<SupportingDocumentCollectionRef<I>> },\n) => ReturnType<typeof SupportingDocumentCollectionWithRef>;\n","import { Meta } from \"@storybook/react\";\nimport { Future, Result } from \"@swan-io/boxed\";\nimport { LakeButton } from \"@swan-io/lake/src/components/LakeButton\";\nimport { useRef, useState } from \"react\";\nimport {\n  Document,\n  SupportingDocumentCollection,\n  SupportingDocumentCollectionRef,\n  UploadOutput,\n} from \"../src/components/SupportingDocumentCollection\";\nimport { UploadOutputWithId } from \"../src/hooks/useFilesUploader\";\nimport { StoryBlock, StoryPart } from \"./_StoriesComponents\";\n\nexport default {\n  title: \"Onboarding/SupportingDocumentCollection\",\n  component: SupportingDocumentCollection,\n} as Meta<typeof SupportingDocumentCollection>;\n\nconst generateUpload = () =>\n  Future.make<Result<UploadOutputWithId<UploadOutput>, unknown>>(resolve => {\n    setTimeout(() => {\n      resolve(\n        Result.Ok({\n          id: crypto.randomUUID(),\n          upload: {\n            url: window.location.href,\n            fields: [],\n          },\n        }),\n      );\n    }, 500);\n  });\n\nexport const WaitingForDocument = () => {\n  const [documents, setDocuments] = useState<Document<string>[]>([]);\n  const ref = useRef<SupportingDocumentCollectionRef<string>>(null);\n\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          ref={ref}\n          status=\"WaitingForDocument\"\n          generateUpload={generateUpload}\n          documents={documents}\n          onChange={setDocuments}\n          requiredDocumentPurposes={[\n            \"ProofOfIdentity\",\n            \"SwornStatement\",\n            \"PowerOfAttorney\",\n            \"UnknownDocumentType\",\n          ]}\n          getPurposeMetadata={purpose => ({\n            title: \"Show metadata\",\n            values: [\n              {\n                title: \"Purpose\",\n                value: purpose,\n              },\n              {\n                title: \"ID\",\n                value: \"666\",\n                type: \"copy\",\n              },\n              {\n                title: \"Lorem ipsum\",\n                value: \"dolor sit amet\",\n              },\n            ],\n          })}\n        />\n\n        <LakeButton\n          onPress={() => {\n            if (ref.current != null) {\n              ref.current.addDocument({\n                purpose: \"UltimateBeneficialOwnerProofOfAddress\",\n                file: {\n                  id: crypto.randomUUID(),\n                  name: \"toto.jpg\",\n                  statusInfo: { status: \"Uploaded\" },\n                },\n              });\n            }\n          }}\n        >\n          Add other document from outside\n        </LakeButton>\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const WaitingForDocumentShowIds = () => {\n  const [documents, setDocuments] = useState<Document<string>[]>([]);\n  return (\n    <StoryBlock title=\"WaitingForDocumentShowIds\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"WaitingForDocument\"\n          generateUpload={generateUpload}\n          documents={documents}\n          onChange={setDocuments}\n          requiredDocumentPurposes={[\n            \"ProofOfIdentity\",\n            \"SwornStatement\",\n            \"PowerOfAttorney\",\n            \"UnknownDocumentType\",\n          ]}\n          showIds={true}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const WaitingForDocumentWithApprovedAndRejected = () => {\n  const [documents, setDocuments] = useState<Document<string>[]>([\n    {\n      purpose: \"ProofOfIdentity\",\n      file: {\n        id: \"id\",\n        name: \"IdCard.pdf\",\n        statusInfo: { status: \"Validated\" },\n      },\n    },\n    {\n      purpose: \"SwornStatement\",\n      file: {\n        id: \"sworn\",\n        name: \"SwornStatement.pdf\",\n        statusInfo: { status: \"Uploaded\" },\n      },\n    },\n    {\n      purpose: \"PowerOfAttorney\",\n      file: {\n        id: \"power\",\n        name: \"power.pdf\",\n        url: \"https://swan.io\",\n        statusInfo: { status: \"Refused\", reason: \"Invalid document\" },\n      },\n    },\n  ]);\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"WaitingForDocument\"\n          generateUpload={generateUpload}\n          documents={documents}\n          onChange={setDocuments}\n          requiredDocumentPurposes={[\n            \"ProofOfIdentity\",\n            \"SwornStatement\",\n            \"PowerOfAttorney\",\n            \"UnknownDocumentType\",\n          ]}\n          onRemoveFile={() =>\n            Future.make(resolve => {\n              setTimeout(() => {\n                resolve(Result.Ok(undefined));\n              }, 1_000);\n            })\n          }\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const Pending = () => {\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"PendingReview\"\n          generateUpload={generateUpload}\n          documents={[\n            {\n              purpose: \"ProofOfIdentity\",\n              file: {\n                id: \"id\",\n                name: \"IdCard.pdf\",\n                url: \"https://swan.io\",\n                statusInfo: { status: \"Pending\" },\n              },\n            },\n          ]}\n          requiredDocumentPurposes={[\"ProofOfIdentity\"]}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const Approved = () => {\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"Approved\"\n          generateUpload={generateUpload}\n          documents={[\n            {\n              purpose: \"ProofOfIdentity\",\n              file: {\n                id: \"id\",\n                name: \"IdCard.pdf\",\n                url: \"https://swan.io\",\n                statusInfo: { status: \"Validated\" },\n              },\n            },\n          ]}\n          requiredDocumentPurposes={[\"ProofOfIdentity\"]}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const ApprovedWithoutDownload = () => {\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"Approved\"\n          generateUpload={generateUpload}\n          documents={[\n            {\n              purpose: \"ProofOfIdentity\",\n              file: {\n                id: \"id\",\n                name: \"IdCard.pdf\",\n                statusInfo: { status: \"Validated\" },\n              },\n            },\n          ]}\n          requiredDocumentPurposes={[\"ProofOfIdentity\"]}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const Rejected = () => {\n  return (\n    <StoryBlock title=\"SupportingDocument\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"Rejected\"\n          generateUpload={generateUpload}\n          documents={[\n            {\n              purpose: \"ProofOfIdentity\",\n              file: {\n                id: \"id\",\n                name: \"IdCard.pdf\",\n                url: \"https://swan.io\",\n                statusInfo: { status: \"Refused\", reason: \"Invalid document\" },\n              },\n            },\n          ]}\n          requiredDocumentPurposes={[\"ProofOfIdentity\"]}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const ReadOnlyEmpty = () => {\n  const [documents, setDocuments] = useState<Document<string>[]>([]);\n  return (\n    <StoryBlock title=\"WaitingForDocumentShowIds\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"WaitingForDocument\"\n          generateUpload={generateUpload}\n          documents={documents}\n          onChange={setDocuments}\n          requiredDocumentPurposes={[]}\n          showIds={true}\n          readOnly={true}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n\nexport const ReadOnlyWithDocs = () => {\n  return (\n    <StoryBlock title=\"WaitingForDocumentShowIds\" description=\"Supporting document collection\">\n      <StoryPart title=\"Default\">\n        <SupportingDocumentCollection\n          status=\"WaitingForDocument\"\n          generateUpload={generateUpload}\n          documents={[\n            {\n              purpose: \"ProofOfIdentity\",\n              file: {\n                id: \"id\",\n                name: \"IdCard.pdf\",\n                url: \"https://swan.io\",\n                statusInfo: { status: \"Refused\", reason: \"Invalid document\" },\n              },\n            },\n          ]}\n          onChange={() => {}}\n          requiredDocumentPurposes={[]}\n          showIds={true}\n          readOnly={true}\n        />\n      </StoryPart>\n    </StoryBlock>\n  );\n};\n"],"names":["o","t","u","e","s","i","a","r","n","c","l","p","f","d","m","v","y","h","b","E","Form","memo","forwardRef","style","onReset","onSubmit","props","forwardedRef","createElement","event","commonStyles","ACCEPTED_FORMATS","styles","StyleSheet","Help","match","text","width","jsx","LakeTooltip","LakeButton","label","onPress","getSupportingDocumentPurposeLabel","purpose","key","isTranslationKey","getSupportingDocumentPurposeDescriptionLabel","SupportingDocumentCollectionWithRef","documents","generateUpload","uploadFile","requiredDocumentPurposes","templateLanguage","locale","status","onRemoveFile","showIds","readOnly","getPurposeMetadata","readonlyDocumentPurposes","ref","showPowerOfAttorneyModal","setShowPowerOfAttorneyModal","useState","showSwornStatementModal","setShowSwornStatementModal","currentMetadata","setCurrentMetadata","addedDocuments","setAddedDocuments","orderedDocumentPurposes","useMemo","allPurposes","allDocuments","document","documentsByPurpose","purposeDocuments","allRequiredPurposes","priorityByPurpose","priority","purposeA","purposeB","purposeAPriority","item","filesByRequiredPurpose","useRef","Array","isRequired","files","Option","filesUploaderRefByPurpose","useImperativeHandle","useEffect","lastAddedDocument","showableDocumentPurposes","areAllDocumentsValidated","metadata","jsxs","Fragment","LakeLabel","isNotNullish","FilesUploader","file","upload","onLoadStart","onProgress","body","value","Request","badStatusToError","Space","LakeText","LakeModal","LakeButtonGroup","ReadOnlyFieldList","title","type","LakeCopyButton","colors","SupportingDocumentCollection","SupportingDocumentCollection_stories","component","Future","make","resolve","setTimeout","Result","Ok","id","crypto","randomUUID","url","window","location","href","fields","WaitingForDocument","setDocuments","StoryBlock","StoryPart","values","current","addDocument","name","statusInfo","WaitingForDocumentShowIds","WaitingForDocumentWithApprovedAndRejected","reason","undefined","Pending","Approved","ApprovedWithoutDownload","Rejected","ReadOnlyEmpty","ReadOnlyWithDocs"],"mappings":"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","x_google_ignoreList":[0]}