import{j as e,V as S,s as U,n as re,L as Q,S as C,I as X,c as T,m as D,f as Z,y as se,p as J,i as A,z as O,T as W,N as L,d as oe,B as ee,W as ne}from"./ScrollView-C2rbZF6W.js";import{r as v,b as M}from"./iframe-CS-HVAR2.js";import{u as I}from"./useDisclosure-CktWiTYD.js";import{P as E,F as B}from"./Popover-COzLGyI3.js";import{L as ie}from"./LakeButton-D-lbXro6.js";import{M as _}from"./index-gGsn9vcM.js";import{L as ae}from"./LakeCheckbox-BmwaM70C.js";import{L as le}from"./LakeLabel-xZaRmACh.js";import{L as ce}from"./LakeRadio-wfhQaCbz.js";import{L as de}from"./LakeTextInput-C4-_NnWI.js";import{S as ue}from"./Stack--iKtItVc.js";import{T as me}from"./Tag-CUh1pqWL.js";import{u as pe}from"./TransitionView-1DDsVynN.js";import{t as F,l as he}from"./i18n-CrTCizAa.js";import{b as xe}from"./DatePicker-DWHBnzPT.js";import{S as fe}from"./_StoriesComponents-CskGafiH.js";import"./index-blfurcWX.js";import"./useResponsive-IOaDykJp.js";import"./function-B-I9W-1W.js";import"./BottomPanel-jcbCt7pR.js";import"./commonStyles-BBEkV6IC.js";import"./useBodyClassName-DEtqO6i0.js";import"./FocusTrap-DjqBNqnb.js";import"./array-BfAlyugE.js";import"./Suspendable-BdCZimp1.js";import"./index-CsLzfULY.js";import"./extends-CF3RwP-h.js";import"./Pressable-BviaC-N7.js";import"./v4-C6aID195.js";import"./Fill-BdlHnN9R.js";import"./LakeSelect-BmLuinat.js";import"./Separator-CA24R0S9.js";import"./index-BZqM_b-8.js";import"./rifm-BlpElahA.js";import"./rifm.esm-CiPvW0rM.js";import"./LakeModal-Cgk9PAAp.js";import"./LakeHeading-D4vQrExP.js";import"./ResponsiveContainer-Wg5jCYkC.js";const R=U.create({selected:{color:T.gray[500]},list:{paddingVertical:20,marginVertical:4,minWidth:250,overflow:"hidden"},item:{display:"flex",paddingHorizontal:24,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},itemHovered:{backgroundColor:T.gray[50]},availableFiltersTitle:{paddingHorizontal:24}}),H=({filters:t,openFilters:s,label:l,title:a,availableFilters:c,large:n=!0,onAddFilter:x})=>{const r=v.useRef(null),[u,{close:d,toggle:p}]=I(!1);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:"small",mode:"secondary",color:"gray",onPress:p,ref:r,icon:n?"chevron-down-filled":"filter-filled",iconPosition:"end",ariaLabel:l,children:n?l:null}),e.jsx(E,{role:"listbox",matchReferenceMinWidth:!0,onDismiss:d,referenceRef:r,returnFocus:!1,visible:u,children:e.jsxs(S,{style:R.list,children:[re(a)?e.jsxs(e.Fragment,{children:[e.jsx(Q,{style:R.availableFiltersTitle,children:a}),e.jsx(C,{height:8})]}):null,e.jsx(B,{role:"list",data:c,keyExtractor:(i,o)=>`filter-item-${o}`,renderItem:({item:i})=>{const o=!!t[i.name]||s.includes(i.name);return e.jsxs(_,{style:({hovered:m})=>[R.item,m&&R.itemHovered],role:"button",disabled:o,onPress:()=>{x(i.name),d()},children:[e.jsx(Q,{variant:"smallRegular",style:o&&R.selected,children:i.label}),o&&e.jsx(X,{color:T.positive[500],name:"checkmark-filled",size:14})]})}})]})})]})};H.__docgenInfo={description:"@deprecated",methods:[],displayName:"FilterChooser",props:{filters:{required:!0,tsType:{name:"Partial",elements:[{name:"Record",elements:[{name:"FilterName"},{name:"unknown"}],raw:"Record<FilterName, unknown>"}],raw:"Partial<Record<FilterName, unknown>>"},description:""},openFilters:{required:!0,tsType:{name:"Array",elements:[{name:"FilterName"}],raw:"FilterName[]"},description:""},label:{required:!0,tsType:{name:"string"},description:""},title:{required:!1,tsType:{name:"string"},description:""},availableFilters:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ label: string; name: FilterName }",signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"name",value:{name:"FilterName",required:!0}}]}}],raw:"{ label: string; name: FilterName }[]"},description:""},large:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},onAddFilter:{required:!0,tsType:{name:"signature",type:"function",raw:"(filterName: FilterName) => void",signature:{arguments:[{type:{name:"FilterName"},name:"filterName"}],return:{name:"void"}}},description:""}}};const h=U.create({container:{paddingRight:12,paddingBottom:8},shadowed:{position:"absolute",opacity:0,width:"100%",height:"100%",borderRadius:4,boxShadow:oe.tile,transitionDuration:"150ms",transitionProperty:"opacity"},hovered:{opacity:1},dropdown:{maxHeight:400,minWidth:200},itemHovered:{backgroundColor:T.gray[50]},content:{paddingVertical:12},inputContent:{paddingHorizontal:24,paddingTop:24,paddingBottom:16},radio:{display:"flex",flexDirection:"row",alignItems:"center",height:32,paddingHorizontal:24},itemLabel:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},input:{width:250},value:{maxWidth:130,whiteSpace:"nowrap"}}),z=({ref:t,onPress:s,onPressRemove:l,label:a,value:c="",isActive:n})=>e.jsx(_,{ref:t,onPress:s,children:({hovered:x})=>e.jsxs(e.Fragment,{children:[e.jsx(S,{style:[h.shadowed,x&&h.hovered]}),e.jsx(me,{label:a,color:"current",onPressRemove:l,children:e.jsxs(ee,{direction:"row",alignItems:"center",children:[e.jsx(W,{numberOfLines:1,style:h.value,children:c}),e.jsx(C,{width:4}),e.jsx(X,{color:T.current.primary,name:n?"chevron-up-filled":"chevron-down-filled",size:16})]})})]})}),ve=({label:t,items:s,width:l,value:a,onValueChange:c,onPressRemove:n,autoOpen:x=!1})=>{const r=v.useRef(null),[u,{close:d,toggle:p}]=I(x),i=v.useMemo(()=>s.find(o=>o.value===a),[s,a]);return e.jsxs(S,{style:h.container,children:[e.jsx(z,{label:t,onPress:p,ref:r,onPressRemove:n,isActive:u,value:i==null?void 0:i.label}),e.jsx(E,{role:"listbox",matchReferenceWidth:!1,onDismiss:d,referenceRef:r,returnFocus:!1,visible:u,children:e.jsx(B,{role:"list",data:s,style:[h.dropdown,{width:l}],contentContainerStyle:h.content,keyExtractor:(o,m)=>`filter-item-${m}`,renderItem:({item:o})=>{const m=a===o.value;return e.jsxs(_,{role:"radio","aria-checked":m,style:({hovered:y})=>[h.radio,y&&h.itemHovered],onPress:()=>{c(o.value),d()},children:[e.jsx(ce,{value:m}),e.jsx(C,{width:12}),e.jsx(W,{style:h.itemLabel,children:o.label})]})}})})]})},ye=({label:t,items:s,width:l,checkAllLabel:a,value:c,onValueChange:n,onPressRemove:x,autoOpen:r=!1})=>{const u=v.useRef(null),[d,{close:p,toggle:i}]=I(r),o=v.useMemo(()=>new Set(c),[c]),m=v.useMemo(()=>s.filter(g=>o.has(g.value)),[s,o]),y=a!=null&&o.size===s.length,w=v.useMemo(()=>{if(a==null)return s;const g=o.size===0?!1:o.size===s.length?!0:"mixed";return[{label:a,checked:g},...s]},[s,a,o]);return e.jsxs(S,{style:h.container,children:[e.jsx(z,{label:t,onPress:i,ref:u,onPressRemove:x,isActive:d,value:y?a:m.map(g=>g.label).join(", ")}),e.jsx(E,{role:"listbox",matchReferenceWidth:!1,onDismiss:p,referenceRef:u,returnFocus:!1,visible:d,children:e.jsx(B,{role:"list",data:w,style:[h.dropdown,{width:l}],contentContainerStyle:h.content,keyExtractor:(g,f)=>`filter-item-${f}`,renderItem:({item:g})=>{const f=O(g).with({checked:L.any},({checked:b})=>b).with({value:L.any},({value:b})=>o.has(b)).exhaustive(),k=O(g).with({checked:L.any},({checked:b})=>()=>{n(b===!0?void 0:s.map(j=>j.value))}).with({value:L.any},({value:b})=>()=>{const j=new Set([...o]);f===!0?j.delete(b):j.add(b),j.size===0?n(void 0):n([...j])}).exhaustive();return e.jsxs(_,{role:"radio","aria-checked":f,style:({hovered:b})=>[h.radio,b&&h.itemHovered],onPress:k,children:[e.jsx(ae,{value:f}),e.jsx(C,{width:12}),e.jsx(W,{style:h.itemLabel,children:g.label})]})}})})]})},ge=({label:t,initialValue:s,noValueText:l,cancelText:a,submitText:c,dateFormat:n,isSelectable:x,validate:r,onValueChange:u,onPressRemove:d,autoOpen:p=!1})=>{const i=v.useRef(null),[o,{close:m,toggle:y}]=I(p),w=v.useMemo(()=>A(s)?M(s).format(n):"",[s,n]);return e.jsxs(S,{style:h.container,children:[e.jsx(z,{label:t,onPress:y,ref:i,onPressRemove:d,isActive:o,value:A(s)?M(s).format(n):l}),e.jsx(xe,{visible:o,format:n,firstWeekDay:"monday",label:t,cancelLabel:a,confirmLabel:c,value:w,isSelectable:x,validate:r,onChange:g=>{const f=M(g,n,!0).toJSON();u(f)},onDismiss:m})]})},be=({label:t,initialValue:s="",noValueText:l,autoOpen:a=!1,placeholder:c,validate:n,onValueChange:x,onPressRemove:r})=>{const[u,{close:d,toggle:p}]=I(a),i=v.useRef(null),o=v.useCallback((k,b)=>{const j=k.trim(),$=(n==null?void 0:n(j))??void 0,N=Z($)?j:void 0;return b||x(N),{inputValue:k,validValue:N,error:b?void 0:$}},[n,x]),[{inputValue:m,validValue:y,error:w},g]=v.useState(()=>o(s,!0)),f=v.useCallback(k=>g(o(k,!1)),[o]);return e.jsxs(S,{style:h.container,children:[e.jsx(z,{label:t,onPress:p,ref:i,onPressRemove:r,isActive:u,value:y??l}),e.jsx(E,{role:"listbox",matchReferenceWidth:!1,onDismiss:d,referenceRef:i,returnFocus:!1,visible:u,children:e.jsx(S,{style:[h.dropdown,h.inputContent],children:e.jsx(le,{label:t,render:k=>e.jsx(de,{id:k,value:m,error:w,style:h.input,placeholder:c,onChangeText:f})})})})]})},V=(t,s,l)=>s[l],te=({filters:t,openedFilters:s,definition:l,onChangeOpened:a,onChangeFilters:c})=>{const n=pe(s),x=s.length>n.length?s[s.length-1]:void 0;return s.length===0?null:e.jsx(ue,{direction:"row",wrap:"wrap",children:s.map(r=>{const u=l[r];return typeof r!="string"||u==null?null:e.jsx(S,{children:O(u).with({type:"radio"},({type:d,label:p,items:i,width:o})=>e.jsx(ve,{label:p,items:i,width:o,autoOpen:x===r,onPressRemove:()=>{c({...t,[r]:void 0}),a(s.filter(m=>m!==r))},value:V(d,t,r),onValueChange:m=>c({...t,[r]:m})})).with({type:"checkbox"},({type:d,label:p,items:i,width:o,checkAllLabel:m})=>e.jsx(ye,{label:p,items:i,width:o,checkAllLabel:m,autoOpen:x===r,value:V(d,t,r),onValueChange:y=>c({...t,[r]:y}),onPressRemove:()=>{c({...t,[r]:void 0}),a(s.filter(y=>y!==r))}})).with({type:"date"},({type:d,label:p,noValueText:i,cancelText:o,submitText:m,dateFormat:y,isSelectable:w,validate:g})=>e.jsx(ge,{label:p,noValueText:i,cancelText:o,submitText:m,dateFormat:y,autoOpen:x===r,isSelectable:w?f=>w(f,t):void 0,validate:g?f=>g(f,t):void 0,initialValue:V(d,t,r),onValueChange:f=>c({...t,[r]:f}),onPressRemove:()=>{c({...t,[r]:void 0}),a(s.filter(f=>f!==r))}})).with({type:"input"},({type:d,label:p,placeholder:i,noValueText:o,validate:m})=>e.jsx(be,{label:p,placeholder:i,noValueText:o,autoOpen:x===r,validate:m,initialValue:V(d,t,r),onValueChange:y=>c({...t,[r]:y}),onPressRemove:()=>{c({...t,[r]:void 0}),a(s.filter(y=>y!==r))}})).exhaustive()},r)})})},q={checkbox:t=>({type:"checkbox",label:t.label,items:t.items,checkAllLabel:F("common.filters.all")}),date:t=>({type:"date",label:t.label,cancelText:F("common.filters.cancel"),submitText:F("common.filters.apply"),noValueText:F("common.filters.none"),dateFormat:he.dateFormat,isSelectable:t.isSelectable,validate:t.validate}),input:t=>({type:"input",label:t.label,noValueText:F("common.filters.none"),placeholder:t.placeholder,validate:t.validate}),radio:t=>({type:"radio",label:t.label,items:t.items})},je=({available:t,filters:s,filtersDefinition:l})=>{const a=v.useMemo(()=>{const r=new Set(Z(t)?D.keys(l):t);return se.filterMap(D.entries(l),([u,{label:d}])=>r.has(u)?J.Some({name:u,label:d}):J.None())},[t,l]),[c,n]=v.useState(()=>D.entries(s).filter(([,r])=>A(r)).map(([r])=>r));v.useEffect(()=>{n(r=>{const u=new Set(r),d=D.entries(s).filter(([p,i])=>A(i)&&!u.has(p)).map(([p])=>p);return[...r,...d]})},[s]);const x=v.useCallback(r=>{n(u=>[...u,r])},[]);return{chooser:{availableFilters:a,filters:s,label:F("common.filters"),onAddFilter:x,openFilters:c},stack:{definition:l,filters:s,openedFilters:c,onChangeOpened:n}}};te.__docgenInfo={description:"@deprecated",methods:[],displayName:"FiltersStack",props:{definition:{required:!0,tsType:{name:"Definition"},description:""},filters:{required:!0,tsType:{name:"State"},description:""},openedFilters:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(keyof Definition)[]"},description:""},onChangeOpened:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: (keyof Definition)[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"unknown"}],raw:"(keyof Definition)[]"},name:"value"}],return:{name:"void"}}},description:""},onChangeFilters:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: State) => void",signature:{arguments:[{type:{name:"State"},name:"value"}],return:{name:"void"}}},description:""}}};const we={mode:q.radio({label:"Mode",items:[{label:"QES",value:"QES"},{label:"Expert",value:"Expert"}]}),status:q.checkbox({label:"Status",items:[{label:"Accepted",value:"Accepted"},{label:"Canceled",value:"Canceled"},{label:"Failed",value:"Failed"},{label:"Expired",value:"Expired"},{label:"CustomerRefused",value:"CustomerRefused"}]}),startDate:q.date({label:"Start Date"}),resourceId:q.input({label:"Resource ID",placeholder:"Placeholder...",validate:t=>{if(t.length<3)return"Not long enough"}})},at={title:"Forms/Filters",component:H},P=()=>{const[t,s]=v.useState({mode:void 0,status:void 0,resourceId:void 0,startDate:void 0}),l=je({filtersDefinition:we,filters:t});return e.jsx(fe,{title:"Filters",children:e.jsx(ne,{variant:"live",children:e.jsxs(ee,{alignItems:"start",children:[e.jsx(H,{...l.chooser}),e.jsx(C,{height:8}),e.jsx(te,{...l.stack,onChangeFilters:s})]})})})};P.__docgenInfo={description:"",methods:[],displayName:"All"};var Y,G,K;P.parameters={...P.parameters,docs:{...(Y=P.parameters)==null?void 0:Y.docs,source:{originalSource:`() => {
  const [filters, setFilters] = useState<State>({
    mode: undefined,
    status: undefined,
    resourceId: undefined,
    startDate: undefined
  });
  const filtersProps = useFiltersProps({
    filtersDefinition,
    filters
  });
  return <StoryBlock title="Filters">
      <WithCurrentColor variant="live">
        <Box alignItems="start">
          <FilterChooser {...filtersProps.chooser} />
          <Space height={8} />
          <FiltersStack {...filtersProps.stack} onChangeFilters={setFilters} />
        </Box>
      </WithCurrentColor>
    </StoryBlock>;
}`,...(K=(G=P.parameters)==null?void 0:G.docs)==null?void 0:K.source}}};const lt=["All"];export{P as All,lt as __namedExportsOrder,at as default};
//# sourceMappingURL=Filters.stories-Dl2rmsUH.js.map
