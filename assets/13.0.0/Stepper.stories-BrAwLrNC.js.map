{"version":3,"file":"Stepper.stories-BrAwLrNC.js","sources":["../../../packages/lake/src/components/LakeStepper.tsx","../../../packages/lake/__stories__/Stepper.stories.tsx"],"sourcesContent":["import { Option } from \"@swan-io/boxed\";\nimport { Link } from \"@swan-io/chicane\";\nimport { CSSProperties, ReactNode } from \"react\";\nimport { StyleProp, StyleSheet, View, ViewStyle } from \"react-native\";\nimport { P, match } from \"ts-pattern\";\nimport { colors } from \"../constants/design\";\nimport { Box } from \"./Box\";\nimport { Grid } from \"./Grid\";\nimport { LakeHeading } from \"./LakeHeading\";\nimport { LakeText } from \"./LakeText\";\nimport { Space } from \"./Space\";\n\nconst linkStyle: CSSProperties = {\n  textDecoration: \"none\",\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: \"flex-end\",\n  },\n  bar: {\n    width: \"100%\",\n    height: 4,\n    borderRadius: 2,\n    backgroundColor: colors.gray[100],\n    overflow: \"hidden\",\n    transformOrigin: \"bottom\",\n    transform: \"scaleY(0.5)\",\n    transitionDuration: \"300ms\",\n    transitionProperty: \"transform\",\n  },\n  barActive: {\n    transform: \"scaleY(1)\",\n  },\n  progressBar: {\n    width: \"100%\",\n    height: \"100%\",\n    backgroundColor: colors.current[500],\n    transformOrigin: \"left\",\n    transform: \"scaleX(0)\",\n    transitionDuration: \"300ms\",\n  },\n  progressBarDone: {\n    transform: \"scaleX(1)\",\n  },\n  progressBarError: {\n    backgroundColor: colors.negative[500],\n  },\n\n  mobileContainer: {\n    borderBottomWidth: 1,\n    borderBottomColor: colors.gray[100],\n    paddingBottom: 10,\n  },\n  mobileNumber: {\n    minWidth: 28,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: colors.current[100],\n    backgroundColor: colors.current[50],\n  },\n  mobileNumberError: {\n    borderColor: colors.negative[100],\n    backgroundColor: colors.negative[50],\n  },\n});\n\ntype StepLinkProps = {\n  to: string;\n  disabled: boolean;\n  style?: CSSProperties;\n  children: ReactNode;\n};\n\nconst StepLink = ({ to, disabled, style, children }: StepLinkProps) => {\n  return disabled ? (\n    <span style={style}>{children}</span>\n  ) : (\n    <Link to={to} style={style}>\n      {children}\n    </Link>\n  );\n};\n\nexport type Step = {\n  id: string;\n  label: string;\n  url: string;\n  hasErrors?: boolean;\n};\n\nexport type StepWithChildren = { label: string; children: Step[] };\nexport type TopLevelStep = Step | StepWithChildren;\n\ntype Props = {\n  steps: TopLevelStep[];\n  activeStepId: string;\n  style?: StyleProp<ViewStyle>;\n};\n\nexport const LakeStepper = ({ steps, activeStepId, style }: Props) => {\n  const stepIds = steps.flatMap(step =>\n    match(step)\n      .with({ id: P.string }, ({ id }) => [id])\n      .with({ children: P.array(P.any) }, ({ children }) => children.map(({ id }) => id))\n      .exhaustive(),\n  );\n\n  const activeStepIndex = stepIds.indexOf(activeStepId);\n\n  return (\n    <Grid numColumns={steps.length} horizontalSpace={12} style={[styles.container, style]}>\n      {steps.map((step, index) => {\n        const stepNumber = index + 1;\n        const currentId = match(step)\n          .with({ id: P.string }, ({ id }) => id)\n          .with({ children: P.array(P.any) }, ({ children }) => children[0]?.id ?? \"\")\n          .exhaustive();\n\n        const isActive = match(step)\n          .with({ id: activeStepId }, () => true)\n          .with({ children: P.array(P.any) }, ({ children }) =>\n            children.some(({ id }) => id === activeStepId),\n          )\n          .otherwise(() => false);\n        const isDone = match(step)\n          .with({ id: P.string }, ({ id }) => stepIds.indexOf(id) < activeStepIndex)\n          .with({ children: P.array(P.any) }, ({ children }) =>\n            children.every(({ id }) => stepIds.indexOf(id) < activeStepIndex),\n          )\n          .exhaustive();\n\n        const hasErrors = match(step)\n          .with({ hasErrors: true }, () => true)\n          .with({ children: P.array(P.any) }, ({ children }) =>\n            children.some(({ hasErrors }) => hasErrors === true),\n          )\n          .otherwise(() => false);\n\n        const stepUrl = match(step)\n          .with({ id: P.string }, ({ url }) => url)\n          .with({ children: P.array(P.any) }, ({ children }) => children[0]?.url ?? \"\")\n          .exhaustive();\n\n        const subSteps = match(step)\n          .with({ id: P.string }, step => [step])\n          .with({ children: P.array(P.any) }, ({ children }) => children)\n          .exhaustive();\n\n        return (\n          <StepLink key={currentId} to={stepUrl} disabled={!isDone} style={linkStyle}>\n            <LakeText\n              variant={isActive ? \"medium\" : \"regular\"}\n              color={\n                hasErrors && (isDone || isActive)\n                  ? colors.negative[500]\n                  : isActive || isDone\n                    ? colors.current[500]\n                    : colors.gray[300]\n              }\n            >\n              {stepNumber}. {step.label}\n            </LakeText>\n\n            <Space height={12} />\n\n            <Grid numColumns={subSteps.length} horizontalSpace={12}>\n              {subSteps.map(subStep => {\n                const isActive = subStep.id === activeStepId;\n                const isDone = stepIds.indexOf(subStep.id) < activeStepIndex;\n                const hasErrors = subStep.hasErrors === true;\n\n                return (\n                  <View key={subStep.id} style={[styles.bar, isActive && styles.barActive]}>\n                    <View\n                      style={[\n                        styles.progressBar,\n                        (isActive || isDone) && styles.progressBarDone,\n                        hasErrors && styles.progressBarError,\n                      ]}\n                    />\n                  </View>\n                );\n              })}\n            </Grid>\n          </StepLink>\n        );\n      })}\n    </Grid>\n  );\n};\n\nexport const MobileStepTitle = ({ steps, activeStepId }: Props) => {\n  const currentStep = Option.fromNullable(\n    steps\n      .flatMap((step, index) =>\n        match(step)\n          .with({ id: P.string }, step => ({ ...step, number: `${index + 1}` }))\n          .with({ children: P.array(P.any) }, ({ children }) =>\n            children.map((child, subIndex) => ({\n              ...child,\n              number: `${index + 1}.${subIndex + 1}`,\n            })),\n          )\n          .exhaustive(),\n      )\n      .find(({ id }) => id === activeStepId),\n  ).map(({ label, hasErrors, number }) => ({\n    number,\n    label,\n    isErrorState: hasErrors === true,\n  }));\n\n  return currentStep.match({\n    Some: ({ number, label, isErrorState }) => (\n      <Box\n        direction=\"row\"\n        alignItems=\"center\"\n        justifyContent=\"center\"\n        style={styles.mobileContainer}\n      >\n        <Box\n          alignItems=\"center\"\n          justifyContent=\"center\"\n          style={[styles.mobileNumber, isErrorState && styles.mobileNumberError]}\n        >\n          <LakeText\n            variant=\"smallMedium\"\n            color={isErrorState ? colors.negative[500] : colors.current[500]}\n          >\n            {number}\n          </LakeText>\n        </Box>\n\n        <Space width={8} />\n\n        <LakeHeading\n          level={4}\n          variant=\"h4\"\n          color={isErrorState ? colors.negative[500] : colors.current[500]}\n        >\n          {label}\n        </LakeHeading>\n      </Box>\n    ),\n    None: () => null,\n  });\n};\n","import { Meta } from \"@storybook/react\";\nimport { useState } from \"react\";\nimport { match, P } from \"ts-pattern\";\nimport { Box } from \"../src/components/Box\";\nimport { LakeButton } from \"../src/components/LakeButton\";\nimport { LakeStepper, TopLevelStep } from \"../src/components/LakeStepper\";\nimport { Space } from \"../src/components/Space\";\nimport { WithCurrentColor } from \"../src/components/WithCurrentColor\";\nimport { isNullish } from \"../src/utils/nullish\";\nimport { StoryBlock } from \"./_StoriesComponents\";\n\nexport default {\n  title: \"Forms/Stepper\",\n  component: LakeStepper,\n} as Meta<typeof LakeStepper>;\n\nconst steps: TopLevelStep[] = [\n  {\n    id: \"enter_your_email\",\n    label: \"Enter your e-mail\",\n    url: \"#\",\n  },\n  {\n    label: \"Fill in the form\",\n    children: [\n      {\n        id: \"fill_in_the_form_part_1\",\n        label: \"Fill in the form part 1\",\n        url: \"#\",\n      },\n      {\n        id: \"fill_in_the_form_part_2\",\n        label: \"Fill in the form part 2\",\n        url: \"#\",\n      },\n    ],\n  },\n  {\n    id: \"add_an_owner\",\n    label: \"Add an owner\",\n    url: \"#\",\n  },\n  {\n    label: \"Attach the documents\",\n    children: [\n      {\n        id: \"attach_the_documents_part_1\",\n        label: \"Attach the documents part 1\",\n        url: \"#\",\n      },\n      {\n        id: \"attach_the_documents_part_2\",\n        label: \"Attach the documents part 2\",\n        url: \"#\",\n      },\n      {\n        id: \"attach_the_documents_part_3\",\n        label: \"Attach the documents part 3\",\n        url: \"#\",\n      },\n    ],\n  },\n  {\n    id: \"finalize\",\n    label: \"Finalize\",\n    url: \"#\",\n  },\n];\n\nconst stepIds = steps.flatMap(step =>\n  match(step)\n    .with({ id: P.string }, ({ id }) => [id])\n    .with({ children: P.array(P.any) }, ({ children }) => children.map(child => child.id))\n    .exhaustive(),\n);\n\nexport const Interactive = () => {\n  const [activeStepId, setActiveStepId] = useState(\"attach_the_documents_part_2\");\n\n  const setPreviousStep = () => {\n    const currentIndex = stepIds.indexOf(activeStepId);\n    const previousStepId = stepIds[currentIndex - 1];\n    if (!isNullish(previousStepId)) {\n      setActiveStepId(previousStepId);\n    }\n  };\n\n  const setNextStep = () => {\n    const currentIndex = stepIds.indexOf(activeStepId);\n    const nextStepId = stepIds[currentIndex + 1];\n    if (!isNullish(nextStepId)) {\n      setActiveStepId(nextStepId);\n    }\n  };\n\n  return (\n    <WithCurrentColor variant=\"live\">\n      <StoryBlock title=\"Stepper\">\n        <LakeStepper steps={steps} activeStepId={activeStepId} />\n        <Space height={32} />\n\n        <Box direction=\"row\">\n          <LakeButton\n            size=\"small\"\n            icon=\"chevron-left-filled\"\n            color=\"current\"\n            onPress={setPreviousStep}\n            ariaLabel=\"Previous\"\n          />\n\n          <Space width={16} />\n\n          <LakeButton\n            size=\"small\"\n            icon=\"chevron-right-filled\"\n            color=\"current\"\n            onPress={setNextStep}\n            ariaLabel=\"Next\"\n          />\n        </Box>\n      </StoryBlock>\n    </WithCurrentColor>\n  );\n};\n"],"names":["linkStyle","styles","StyleSheet","colors","StepLink","to","disabled","style","children","jsx","Link","LakeStepper","steps","activeStepId","stepIds","match","step","P","id","activeStepIndex","Grid","index","stepNumber","currentId","_a","isActive","isDone","hasErrors","stepUrl","url","subSteps","jsxs","LakeText","Space","subStep","View","Stepper_stories","title","component","label","flatMap","with","string","array","any","map","child","exhaustive","Interactive","setActiveStepId","useState","setPreviousStep","currentIndex","indexOf","previousStepId","isNullish","setNextStep","nextStepId","WithCurrentColor","StoryBlock","Box","LakeButton"],"mappings":"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"}