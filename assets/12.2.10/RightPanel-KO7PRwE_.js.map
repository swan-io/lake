{"version":3,"file":"RightPanel-KO7PRwE_.js","sources":["../../../packages/lake/src/components/RightPanel.tsx"],"sourcesContent":["import { ReactNode, Ref, useEffect, useState } from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { backgroundColor, breakpoints } from \"../constants/design\";\nimport { useBodyClassName } from \"../hooks/useBodyClassName\";\nimport { FocusTrap, FocusTrapRef } from \"./FocusTrap\";\nimport { LoadingView } from \"./LoadingView\";\nimport { Portal } from \"./Portal\";\nimport { Pressable } from \"./Pressable\";\nimport { Context, ResponsiveContainer } from \"./ResponsiveContainer\";\nimport { Suspendable } from \"./Suspendable\";\nimport { TransitionView } from \"./TransitionView\";\n\nconst BACKGROUND_COLOR = \"rgba(0, 0, 0, 0.6)\";\n\nconst styles = StyleSheet.create({\n  root: {\n    ...StyleSheet.absoluteFillObject,\n    position: \"fixed\",\n  },\n  inert: {\n    pointerEvents: \"none\",\n  },\n  fill: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  overlayEnter: {\n    animationKeyframes: {\n      \"0%\": { opacity: 0 },\n    },\n    animationDuration: \"200ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  overlayLeave: {\n    animationKeyframes: {\n      \"100%\": { opacity: 0 },\n    },\n    animationDuration: \"200ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  containerEnter: {\n    animationKeyframes: {\n      \"0%\": { opacity: 0, transform: \"translateZ(0px) translateX(100px)\" },\n    },\n    animationDuration: \"500ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  containerLeave: {\n    animationKeyframes: {\n      \"100%\": { opacity: 0, transform: \"translateZ(0px) translateX(100px)\" },\n    },\n    animationDuration: \"500ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: BACKGROUND_COLOR,\n  },\n  container: {\n    ...StyleSheet.absoluteFillObject,\n\n    transform: \"translateZ(0px)\",\n    flexDirection: \"row\",\n    alignItems: \"stretch\",\n    backgroundColor: backgroundColor.default,\n  },\n  fillMax: {\n    position: \"absolute\",\n    top: 0,\n    bottom: 0,\n    right: 0,\n    width: \"100%\",\n  },\n  fillMaxLarge: { maxWidth: 700 },\n  contentsEnter: {\n    animationKeyframes: {\n      \"0%\": { transform: \"translateZ(0px) translateX(25px)\" },\n    },\n    animationDuration: \"500ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  contentsLeave: {\n    animationKeyframes: {\n      \"100%\": { transform: \"translateZ(0px) translateX(25px)\" },\n    },\n    animationDuration: \"500ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  contentsContainer: {\n    ...StyleSheet.absoluteFillObject,\n    zIndex: 2,\n    transform: \"translateZ(0px)\",\n    maxWidth: \"100%\",\n    flexGrow: 1,\n  },\n  contents: {\n    ...StyleSheet.absoluteFillObject,\n    maxWidth: \"100%\",\n    flexGrow: 1,\n  },\n});\n\ntype Props = {\n  ref?: Ref<FocusTrapRef>;\n  visible: boolean;\n  children: ReactNode | ((context: Context) => ReactNode);\n  onPressClose?: () => void;\n};\n\nconst rootNode = document.querySelector(\"#full-page-layer-root\") as Element;\n\nexport const RightPanel = ({ ref, visible, children, onPressClose }: Props) => {\n  const [delayedVisible, setDelayedVisible] = useState(visible);\n\n  useEffect(() => {\n    setDelayedVisible(visible);\n  }, [visible]);\n\n  useBodyClassName(\"RightPanelOpen\", { enabled: visible });\n\n  return (\n    <Portal container={rootNode}>\n      <View style={[styles.root, !visible && styles.inert]}>\n        <ResponsiveContainer style={styles.root} breakpoint={breakpoints.small}>\n          {({ large }) => (\n            <>\n              <TransitionView\n                style={styles.fill}\n                enter={styles.overlayEnter}\n                leave={styles.overlayLeave}\n              >\n                {visible ? (\n                  onPressClose != null ? (\n                    <Pressable style={styles.overlay} onPress={onPressClose} />\n                  ) : (\n                    <View style={styles.overlay} />\n                  )\n                ) : null}\n              </TransitionView>\n\n              <Suspendable fallback={<LoadingView color={backgroundColor.accented} delay={0} />}>\n                <TransitionView\n                  style={[styles.fillMax, large && styles.fillMaxLarge]}\n                  enter={styles.containerEnter}\n                  leave={styles.containerLeave}\n                >\n                  {delayedVisible ? (\n                    <FocusTrap\n                      onEscapeKey={onPressClose}\n                      focusLock={true}\n                      autoFocus={true}\n                      returnFocus={true}\n                      ref={ref}\n                      style={styles.container}\n                    >\n                      <TransitionView\n                        style={styles.contentsContainer}\n                        enter={styles.contentsEnter}\n                        leave={styles.contentsLeave}\n                      >\n                        <View style={styles.contents}>\n                          <View style={styles.contentsContainer}>\n                            {typeof children === \"function\" ? (\n                              <ResponsiveContainer\n                                style={styles.root}\n                                breakpoint={breakpoints.small}\n                              >\n                                {children}\n                              </ResponsiveContainer>\n                            ) : (\n                              children\n                            )}\n                          </View>\n                        </View>\n                      </TransitionView>\n                    </FocusTrap>\n                  ) : null}\n                </TransitionView>\n              </Suspendable>\n            </>\n          )}\n        </ResponsiveContainer>\n      </View>\n    </Portal>\n  );\n};\n"],"names":["BACKGROUND_COLOR","styles","StyleSheet","backgroundColor","rootNode","RightPanel","ref","visible","children","onPressClose","delayedVisible","setDelayedVisible","useState","useEffect","useBodyClassName","jsx","Portal","View","ResponsiveContainer","breakpoints","large","jsxs","Fragment","TransitionView","Pressable","Suspendable","LoadingView","FocusTrap"],"mappings":"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"}