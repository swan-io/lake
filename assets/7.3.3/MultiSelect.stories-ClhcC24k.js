import{s as F,c as o,t as h,j as e,L as he,S as v,d as $,r as ye,g as Y,i as R,G as xe,Y as be,H as U,B as T,I as E,h as Se,T as k,V as X}from"./Space-B-tuzGSB.js";import{r as a}from"./index-CBqU2yxZ.js";import{u as je}from"./useDisclosure-CS9t68_Y.js";import{g as ve}from"./array-rjEBP2Ry.js";import{s as Ce}from"./string-CPvFQwzo.js";import{P as Ie}from"./Popover-IY56r5AU.js";import{b as Pe,a as Me}from"./Pressable-D4CfqCYA.js";import{T as J}from"./Tag-Dpz2oGzo.js";import{P as D}from"./index-BWWcrcy6.js";import{S as we}from"./index-CuzezegV.js";import{F as Le}from"./index-BwReBjvh.js";import{S as le,a as y}from"./_StoriesComponents-qw3Cph9e.js";import"./extends-CCbyfPlC.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BtM5VmRH.js";import"./useResponsive-Bnyz6X8I.js";import"./function-DPzsNpwz.js";import"./BottomPanel-DBY7T8fj.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-FAgY5CgW.js";import"./math-DSXNCDfc.js";import"./FocusTrap-Dcd989mj.js";import"./a11y-DXvpDVrG.js";import"./Suspendable-DyQqXxP8.js";import"./index-CP-wDJ33.js";import"./TransitionView-C72wiUIW.js";import"./index-BJ_S6Iac.js";const Te=F.create({base:{color:o.negative[500],lineHeight:h.h1.lineHeight,minHeight:32,paddingHorizontal:3,paddingVertical:4}}),se=({message:l="",style:n})=>l!==""?e.jsx(he,{variant:"smallRegular",style:[Te.base,n],children:l}):e.jsx(v,{height:32});se.__docgenInfo={description:"",methods:[],displayName:"InputError",props:{message:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"TextStyle"}],raw:"StyleProp<TextStyle>"},description:""}}};const Ee=120,ke=32,He=10.5,s=F.create({base:{...h.regular,backgroundColor:$.accented,borderColor:o.gray[100],borderRadius:ye[6],borderWidth:1,cursor:"default",overflow:"hidden",transitionDuration:"150ms",transitionProperty:"border-color, box-shadow"},errored:{borderColor:o.negative[500]},tag:{marginRight:4,marginVertical:2},hovered:{boxShadow:Y.tile},focused:{borderColor:o.gray[500],boxShadow:Y.tile,outlineStyle:"none"},disabled:{backgroundColor:o.gray[50],borderColor:o.gray[100],cursor:"not-allowed"},actions:{marginVertical:"auto",position:"absolute",bottom:0,top:0,right:20},placeholder:{...h.regular,color:o.gray[300],userSelect:"none"},list:{marginVertical:4,maxHeight:ke*He,minHeight:224},filterContainer:{flexGrow:1,flexShrink:1,margin:16},filterInput:{...h.regular,backgroundColor:$.accented,borderColor:o.gray[100],borderRadius:4,borderWidth:1,flexGrow:1,flexShrink:1,height:40,outlineStyle:"none",paddingHorizontal:12,paddingLeft:40,placeholderTextColor:o.gray[300]},filterfocused:{borderColor:o.gray[200]},searchIcon:{position:"absolute",left:14},tagsList:{flexWrap:"wrap",maxHeight:Ee,minHeight:40,overflowY:"auto",paddingHorizontal:16,paddingRight:60,paddingVertical:8},groupTitleBase:{alignItems:"center",flexDirection:"row",flexGrow:1,flexShrink:1,justifyContent:"space-between",paddingHorizontal:16,paddingVertical:12,transitionDuration:"200ms",transitionProperty:"background-color"},groupTitle:{...h.semibold,userSelect:"none"},line:{...h.regular,paddingHorizontal:16,paddingVertical:8,transitionDuration:"200ms",transitionProperty:"background-color",userSelect:"none"},lineInGroup:{paddingLeft:24},emptyList:{height:136},emptyListText:{color:o.gray.primary}}),G=a.memo(({color:l="gray",disabled:n=!1,emptyResultText:m,enableGroups:b=!0,filterPlaceholder:P,items:p,onValueChange:c,placeholder:g,renderTagGroup:M,error:w,style:S,values:i,id:j})=>{const[u,B]=a.useState(""),L=a.useRef(!1),H=a.useRef(null),z=a.useRef(null),ae=a.useRef(null),[f,{open:ie,close:ne}]=je(!1),ce=o[l][50],ue=o[l][100];a.useEffect(()=>{f||B("")},[f]),a.useEffect(()=>{var t,r;if(L.current){const d=(t=H.current)==null?void 0:t.scrollHeight;(r=H.current)==null||r.scrollTo({top:d})}L.current=!1},[i]);const W=t=>{L.current=!0,c([...i,t.value])},de=t=>{c(i.filter(r=>r!==t.value))},pe=()=>{c([])},me=t=>{L.current=!0;const r=t.map(_=>_.value),d=[...new Set([...i,...r])];c(d)},O=a.useMemo(()=>p.reduce((t,r)=>(t[r.value]=r,t),{}),[p]),V=a.useMemo(()=>i.map(t=>O[t]).filter(R),[i,O]),N=a.useMemo(()=>{const t=p.filter(d=>!i.includes(d.value)),r=u.trim().toLowerCase();return r===""?t:t.filter(({label:d})=>d.toLowerCase().includes(r))},[u,p,i]),ge=a.useMemo(()=>xe.filterMap(be.entries(ve(N,({group:t})=>t)),([t,r])=>r===void 0?U.None():U.Some({title:t,data:r})),[N]),q=a.useMemo(()=>e.jsxs(T,{direction:"row",alignItems:"center",style:s.filterContainer,children:[e.jsx(Pe,{autoComplete:"off",inputMode:"search",multiline:!1,rows:1,onChangeText:t=>B(t),placeholder:P,value:u,style:({focused:t})=>[s.filterInput,t&&s.filterfocused]}),e.jsx(E,{name:"search-filled",color:o[l].primary,size:20,style:s.searchIcon})]}),[u,P,l]),A=a.useMemo(()=>e.jsxs(T,{justifyContent:"center",alignItems:"center",style:s.emptyList,children:[e.jsx(E,{name:"clipboard-search-regular",size:24,color:o.gray.primary}),Se(m)&&e.jsxs(e.Fragment,{children:[e.jsx(v,{height:8}),e.jsx(k,{style:s.emptyListText,children:m})]})]}),[m]);return e.jsxs(X,{style:S,children:[e.jsxs(D,{id:j,ref:z,"aria-haspopup":"listbox",role:"button","aria-expanded":f,disabled:n,onPress:ie,style:({hovered:t,focused:r})=>[s.base,t&&s.hovered,(r||f)&&s.focused,n&&s.disabled,R(w)&&s.errored],children:[e.jsx(T,{ref:H,alignItems:"center",direction:"row",style:s.tagsList,children:V.length>0?V.map(t=>e.jsx(J,{color:l,onPressRemove:n?void 0:()=>de(t),style:s.tag,children:t.label},t.value)):g!==""?e.jsx(k,{role:"label",numberOfLines:1,style:s.placeholder,children:g}):null}),e.jsxs(T,{direction:"row",alignItems:"center",style:s.actions,children:[V.length>=1&&!n&&e.jsxs(e.Fragment,{children:[e.jsx(D,{role:"button",onPress:pe,children:e.jsx(E,{name:"dismiss-filled",color:o.gray.primary,size:15})}),e.jsx(v,{width:8})]}),e.jsx(E,{color:o.gray.primary,name:f?"chevron-up-filled":"chevron-down-filled",size:20})]})]}),e.jsx(Ie,{role:"listbox",matchReferenceWidth:!0,onDismiss:ne,referenceRef:z,returnFocus:!0,visible:f,children:e.jsx(X,{style:s.list,children:b?e.jsx(we,{role:"listbox","aria-multiselectable":!0,keyExtractor:(t,r)=>`group-field-${t.value}-${r}`,extraData:u,ListHeaderComponent:q,ListEmptyComponent:A,ListFooterComponent:e.jsx(v,{height:16}),sections:ge,renderSectionHeader:({section:{title:t,data:r}})=>e.jsxs(D,{role:"listitem",onPress:()=>me(r),style:({hovered:d,pressed:_,focused:fe})=>[s.groupTitleBase,(d||fe)&&{backgroundColor:ce},_&&{backgroundColor:ue}],children:[e.jsx(k,{numberOfLines:1,style:s.groupTitle,children:t}),R(M)&&e.jsx(J,{color:l,children:M(r)})]}),renderItem:({item:t})=>e.jsx(K,{color:l,filter:u,item:t,handleSelectItem:W,style:s.lineInGroup})}):e.jsx(Le,{ref:ae,role:"list",data:N,extraData:u,keyExtractor:t=>`field-${t.value}`,ListHeaderComponent:q,ListEmptyComponent:A,ListFooterComponent:e.jsx(v,{height:8}),renderItem:({item:t})=>e.jsx(K,{color:l,filter:u,item:t,handleSelectItem:W})})})}),e.jsx(se,{message:w})]})}),K=({item:l,color:n,filter:m,handleSelectItem:b,style:P})=>{const{label:p,disabled:c=!1}=l,g=m.trim().toLowerCase(),M=o[n][50],w=o[n][100],S=a.useMemo(()=>c||g===""?p:Ce(p,g),[p,c,g]);return e.jsx(Me,{role:"listitem",disabled:c,numberOfLines:1,onPress:()=>b(l),style:({hovered:i,pressed:j})=>[s.line,P,i&&{backgroundColor:M},j&&{backgroundColor:w},c&&{backgroundColor:o.gray[50],color:o.gray[100]}],children:typeof S=="string"?S:S.map((i,j)=>i.toLowerCase()===g?e.jsx(k,{style:{color:n},children:i},j):i)})};G.__docgenInfo={description:"",methods:[],displayName:"MultiSelect",props:{color:{defaultValue:{value:'"gray"',computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1},enableGroups:{defaultValue:{value:"true",computed:!1},required:!1}}};const Ve=F.create({select:{maxWidth:400}}),nt={title:"Forms/MultiSelect",component:G},Ne=[{label:"Camille",value:"camille",group:"C"},{label:"Charlotte",value:"charlotte",group:"C"},{label:"Francis",value:"francis",group:"F"},{label:"Émilie",value:"emilie",group:"E"},{label:"François",value:"francois",group:"F"},{label:"Laura",value:"laura",group:"L"},{label:"Marie-Anne",value:"marie_anne",group:"M"},{label:"Natasha",value:"natasha",group:"N",disabled:!0},{label:"Nicolas",value:"nicolas",group:"N"},{label:"Pierre",value:"pierre",group:"P"}],x=({initialValues:l=[],...n})=>{const[m,b]=a.useState(l);return e.jsx(G,{placeholder:"Select people...",filterPlaceholder:"Search...",emptyResultText:"No result",values:m,items:Ne,onValueChange:b,style:Ve.select,...n})},C=()=>e.jsxs(le,{title:"MultiSelect variations",children:[e.jsx(y,{title:"Default",children:e.jsx(x,{})}),e.jsx(y,{title:"Without groups",children:e.jsx(x,{enableGroups:!1})}),e.jsx(y,{title:"Disabled",children:e.jsx(x,{disabled:!0})}),e.jsx(y,{title:"Disabled with a value",children:e.jsx(x,{disabled:!0,initialValues:["charlotte"]})}),e.jsx(y,{title:"Without any option",children:e.jsx(x,{items:[]})})]}),I=()=>e.jsx(le,{title:"MultiSelect colors",children:Object.keys(o).map(l=>e.jsx(y,{title:l,children:e.jsx(x,{color:l})},l))});C.__docgenInfo={description:"",methods:[],displayName:"Variations"};I.__docgenInfo={description:"",methods:[],displayName:"Colors"};var Q,Z,ee;C.parameters={...C.parameters,docs:{...(Q=C.parameters)==null?void 0:Q.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect variations">
      <StoryPart title="Default">
        <EditableMultiSelect />
      </StoryPart>

      <StoryPart title="Without groups">
        <EditableMultiSelect enableGroups={false} />
      </StoryPart>

      <StoryPart title="Disabled">
        <EditableMultiSelect disabled={true} />
      </StoryPart>

      <StoryPart title="Disabled with a value">
        <EditableMultiSelect disabled={true} initialValues={["charlotte"]} />
      </StoryPart>

      <StoryPart title="Without any option">
        <EditableMultiSelect items={[]} />
      </StoryPart>
    </StoryBlock>;
}`,...(ee=(Z=C.parameters)==null?void 0:Z.docs)==null?void 0:ee.source}}};var te,re,oe;I.parameters={...I.parameters,docs:{...(te=I.parameters)==null?void 0:te.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect colors">
      {Object.keys(colors).map(color => <StoryPart key={color} title={color}>
          <EditableMultiSelect color={(color as ColorVariants)} />
        </StoryPart>)}
    </StoryBlock>;
}`,...(oe=(re=I.parameters)==null?void 0:re.docs)==null?void 0:oe.source}}};const ct=["Variations","Colors"];export{I as Colors,C as Variations,ct as __namedExportsOrder,nt as default};
//# sourceMappingURL=MultiSelect.stories-ClhcC24k.js.map
