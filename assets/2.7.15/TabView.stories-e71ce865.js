import{S as he,c as g,t as ee,r as oe,f as z,g as ie,s as pe,v as fe,N as Q,_ as O,j as e,k as me,i as a,C as ce,a as y,V as j,T as E,b as T,I as Y,p as we,F as G,L as ge}from"./Space-f85095f8.js";import{P as ye}from"./index-aa498c51.js";import{r as o}from"./index-b9a8c83f.js";import{u as be}from"./useMergeRefs-56399732.js";import{n as ke}from"./function-2aea345a.js";import{B as Fe}from"./Box-f4fbfbba.js";import{F as ve}from"./FocusTrap-758e437a.js";import{L as Se}from"./Link-78c240df.js";import{a as ue}from"./Pressable-7e9fd84c.js";import{T as Le}from"./TransitionView-5833e7af.js";import{S as Ce}from"./_StoriesComponents-d9c76764.js";import"./extends-98964cd2.js";import"./_commonjsHelpers-de833af9.js";import"./index-c216e26a.js";import"./with-selector-74062ea5.js";import"./Boxed-885d7854.js";import"./array-a4405b3e.js";const Te=40,n=he.create({container:{borderBottomWidth:1,borderBottomColor:g.gray[100],zIndex:10},link:{...ee.medium,position:"relative",color:g.gray[700],height:Te,whiteSpace:"nowrap",display:"flex",flexDirection:"row",alignItems:"center"},activeLink:{color:g.current[500],boxShadow:`inset 0 -2px ${g.gray[700]}`},hoveredLink:{boxShadow:`inset 0 -2px ${g.gray[700]}`},underline:{position:"absolute",bottom:0,height:2,width:1,backgroundColor:g.current[500]},animatedUnderline:{transformOrigin:"0 0",transition:"200ms ease-in-out transform"},placeholder:{position:"absolute",top:0,left:0,right:0,visibility:"hidden",flexDirection:"row",alignItems:"flex-end",overflow:"hidden",pointerEvents:"none"},count:{...ee.smallRegular,color:g.current[500],backgroundColor:g.current[50],borderColor:g.current[100],borderWidth:1,borderRadius:oe[4],paddingHorizontal:z[4],minWidth:z[24],display:"inline-block",textAlign:"center"},dropdownHandleContainer:{alignItems:"center",justifyContent:"center",alignSelf:"stretch"},dropdownPlacement:{position:"absolute",right:0,top:"100%"},dropdown:{position:"absolute",right:0,top:"100%",backgroundColor:ie.accented,borderRadius:oe[8],boxShadow:pe.modal,paddingVertical:z[8]},dropdownLink:{...ee.regular,paddingHorizontal:z[16],paddingVertical:z[8],whiteSpace:"nowrap"},dropdownLinkTextHovered:{backgroundColor:g.gray[50]},dropdownLinkTextActive:{boxShadow:`inset 3px 0 ${g.current.primary}`,color:g.current.primary},separator:{position:"absolute",top:0,left:fe[16],bottom:0,width:1,backgroundColor:g.gray[100]},sticky:{backgroundColor:ie.default,position:"sticky",top:-1}}),te=o.forwardRef(({children:s,style:d,tab:b,onChange:p,activeTabId:x,onBlur:f,onFocus:k,onPress:c},t)=>Q(b).with({url:O.string},({url:h})=>e(Se,{ref:t,to:h,style:d,onFocus:k,onBlur:f,onPress:c,children:s})).with({id:O.string},({id:h})=>{const m=h===x;return e(ue,{ref:t,style:F=>d({...F,active:m}),onPress:()=>{p==null||p(h),c==null||c()},onFocus:k,onBlur:f,children:s})}).exhaustive()),Oe=({tabs:s,onHoverStart:d,onHoverEnd:b,onLinkFocus:p,onLinkBlur:x,onLinkPress:f,activeTabId:k,onChange:c})=>{const t=o.useRef(null);return ce(t,{onHoverStart:d,onHoverEnd:b}),e(j,{role:"menu",style:n.dropdown,ref:t,children:s.map(h=>{const m=K(h);return e(te,{onChange:c,activeTabId:k,tab:h,onFocus:p,onBlur:x,onPress:f,role:"menuitem",ariaCurrentValue:"location",style:({active:F,hovered:P})=>[n.dropdownLink,F&&n.dropdownLinkTextActive,P&&n.dropdownLinkTextHovered],children:h.label},m)})})},xe=new Set(["ForcedOpen","OpenFromFocus"]),Re=new Set(["Open","ForcedOpen","OpenFromFocus"]),Ie=new Set(["ForcedOpen"]),He=o.forwardRef(({tabs:s,otherLabel:d,currentUrl:b,activeTabId:p,onChange:x},f)=>{const[k,c]=o.useReducer((r,u)=>Q([u,r]).returnType().with(["ForceToggle","Closed"],["ForceToggle","Open"],["ForceToggle","ForcedClosed"],()=>"ForcedOpen").with(["ForceToggle","OpenFromFocus"],["ForceToggle","ForcedOpen"],()=>"ForcedClosed").with(["ForceClose",O.any],()=>"ForcedClosed").with(["FocusHandle","ForcedClosed"],()=>"Closed").with(["Open","ForcedOpen"],["FocusHandle","ForcedOpen"],["Close","ForcedOpen"],()=>"ForcedOpen").with(["Open",O.any],()=>"Open").with(["FocusHandle",O.any],()=>"OpenFromFocus").with(["Close",O.any],()=>"Closed").exhaustive(),"Closed"),t=o.useRef(void 0),h=o.useRef(null),m=o.useRef(null),F=o.useRef(null),{onHandleFocus:P,onLinkFocus:B,onAnyBlur:D,onHoverStart:M,onHoverEnd:N,onPress:W,onPressOutside:V,onEscapeKey:q}=o.useMemo(()=>({onHandleFocus:r=>{if(me(m.current))return;F.current=Date.now();const u=m.current,i=r;u.contains(i.relatedTarget)||(a(t.current)&&clearTimeout(t.current),c("FocusHandle"))},onLinkFocus:()=>{a(t.current)&&clearTimeout(t.current),c("Open")},onAnyBlur:()=>{a(t.current)&&clearTimeout(t.current),t.current=window.setTimeout(()=>{c("Close")},300)},onHoverStart:()=>{a(t.current)&&clearTimeout(t.current),c("Open")},onHoverEnd:()=>{a(t.current)&&clearTimeout(t.current),t.current=window.setTimeout(()=>{c("Close")},300)},onPress:()=>{F.current!=null&&Date.now()-F.current<32||(a(t.current)&&clearTimeout(t.current),c("ForceToggle"))},onPressOutside:r=>{a(h.current)&&h.current.contains(r.target)||(a(t.current)&&clearTimeout(t.current),c("ForceClose"),t.current=window.setTimeout(()=>{c("Close")},300))},onEscapeKey:()=>{a(t.current)&&clearTimeout(t.current),c("ForceClose"),t.current=window.setTimeout(()=>{c("Close")},300)}}),[]);o.useEffect(()=>()=>{a(t.current)&&clearTimeout(t.current)},[]);const U=Re.has(k),$=xe.has(k),H=Ie.has(k);ce(h,{onHoverStart:M,onHoverEnd:N});const A=be(m,f),Z=o.useMemo(()=>s.find(r=>re({activeTabId:p,currentLocationURL:b,tab:r})),[p,b,s]);return y(j,{style:n.dropdownHandleContainer,ref:A,children:[y(ue,{ref:h,role:"button","aria-expanded":U,"aria-haspopup":"true",onFocus:P,onBlur:D,onPress:W,style:({hovered:r})=>[n.link,a(Z)?n.activeLink:r?n.hoveredLink:null],children:[e(E,{children:d}),e(T,{width:8}),e(E,{style:n.count,children:s.length}),e(T,{width:4}),e(Y,{name:"chevron-down-filled",size:12})]}),e(Le,{...we.fadeAndSlideInFromBottom,style:n.dropdownPlacement,children:U?e(ve,{autoFocus:$,focusLock:H,returnFocus:H,onClickOutside:V,onEscapeKey:H?q:void 0,children:e(Oe,{onChange:x,activeTabId:p,tabs:s,onHoverStart:M,onHoverEnd:N,onLinkFocus:B,onLinkBlur:D,onLinkPress:q})}):null})]})}),re=({tab:s,activeTabId:d,currentLocationURL:b})=>Q(s).with({url:O.string},({url:p})=>b.startsWith(p)).with({id:O.string},({id:p})=>a(d)&&p===d).exhaustive(),K=s=>Q(s).with({url:O.string},({url:d})=>d).with({id:O.string},({id:d})=>d).exhaustive(),J=({tabs:s,otherLabel:d,hideIfSingleItem:b=!0,sticky:p=!1,padding:x,activeTabId:f,onChange:k})=>{const c=o.useRef(null),t=o.useRef(null),h=o.useRef(null),m=o.useRef({}),F=o.useRef({}),[{left:P,width:B},D]=o.useState({left:0,width:0}),[M,N]=o.useState(!1),[[W,V],q]=o.useState([[],[]]),U=ye(),{path:$}=U,H=U.toString();o.useEffect(()=>{if(a(m.current)){const r=Object.entries(m.current),u=c.current;for(const[i,w]of r)if((i===f||"/"+$.join("/")===i)&&a(w)&&a(u)){w.measureLayout(u,(v,S,L)=>{D({left:v-(x??0),width:L})},ke);return}}D({left:0,width:0})},[$,W,V,x,f]),o.useEffect(()=>{N(B>0)},[B]);const A=o.useCallback(({width:r})=>{const u=s.map(l=>{if(F.current){const I=K(l),C=F.current[I];if(a(C)){const _=C.getBoundingClientRect().width;return{tab:l,width:_+32}}else return{tab:l,width:0}}else return{tab:l,width:0}}),i=[],w=[];let v=0;u.forEach(l=>{if(v+=l.width,v<r)i.push({...l.tab,width:l.width});else if(re({activeTabId:f,currentLocationURL:H,tab:l.tab})){for(;i.length!==0&&i.reduce((I,C)=>I+C.width,0)+(l.width+16)>=r;){const I=i.pop();a(I)&&(w.unshift(I),v-=I.width)}i.push({...l.tab,width:l.width})}else w.push({...l.tab,width:l.width})});const S=h.current;let L=100;a(S)&&(L=S.getBoundingClientRect().width);const R=i.findIndex(l=>re({activeTabId:f,currentLocationURL:H,tab:l}));if(R!==-1){const l=i[R],I=(l==null?void 0:l.width)??0,C=[...i.slice(0,R),...i.slice(R+1)];for(;C.length!==0&&C.reduce((_,de)=>_+de.width,0)+I+(w.length>=1?L:0)>=r;){const _=C.pop();a(_)&&w.unshift(_)}const ne=[...C.slice(0,R),...l!=null?[l]:[],...C.slice(R)];q([ne,w])}else q([i,w])},[s,f,H]),Z=o.useCallback(({target:r,nativeEvent:{layout:{width:u}}})=>{A({container:r,width:u})},[A]);return o.useLayoutEffect(()=>{const r=t.current;if(r){const u=r,i=u.getBoundingClientRect().width;A({container:u,width:i})}},[A]),s.length<=1&&b?null:y(Fe,{alignItems:"center",direction:"row",role:"tablist",ref:c,style:[n.container,p&&n.sticky,{paddingHorizontal:x}],children:[y(j,{style:n.placeholder,"aria-hidden":!0,ref:t,onLayout:Z,children:[s.map(r=>{const{label:u,icon:i,count:w}=r,v=K(r);return y(o.Fragment,{children:[y(te,{ref:S=>{F.current&&(F.current[v]=S)},activeTabId:f,tab:r,onChange:k,style:({active:S,hovered:L})=>[n.link,S?n.activeLink:L?n.hoveredLink:null],children:[a(i)&&y(G,{children:[e(Y,{name:i,size:16,color:"currentColor"}),e(T,{width:8})]}),e(E,{children:u}),w!=null?y(G,{children:[e(T,{width:8}),e(E,{style:n.count,children:w})]}):null]}),e(T,{width:32})]},v)}),y(ge,{ref:h,style:n.link,children:[e(E,{children:d}),e(T,{width:8}),e(E,{style:n.count,children:s.length}),e(T,{width:4}),e(Y,{name:"chevron-down-filled",size:12})]})]}),W.map(r=>{const{label:u,icon:i,withSeparator:w,count:v}=r,S=K(r);return y(o.Fragment,{children:[y(te,{ref:L=>{m.current&&(m.current[S]=L)},onChange:k,activeTabId:f,tab:r,role:"tab",style:({active:L,hovered:R})=>[n.link,L?n.activeLink:R?n.hoveredLink:null],children:[w===!0&&e(j,{style:n.separator,role:"none"}),a(i)&&y(G,{children:[e(Y,{name:i,size:16,color:"currentColor"}),e(T,{width:8})]}),e(E,{children:u}),v!=null?y(G,{children:[e(T,{width:8}),e(E,{style:n.count,children:v})]}):null]}),e(T,{width:32})]},S)}),V.length>0?e(He,{ref:r=>{V.forEach(u=>{if(m.current){const i=K(u);m.current[i]=r}})},onChange:k,tabs:V,currentUrl:H,otherLabel:d,activeTabId:f}):null,M&&e(j,{style:[n.underline,n.animatedUnderline,{transform:`translateX(${P}px) scaleX(${B})`}]})]})};try{J.displayName="TabView",J.__docgenInfo={description:"",displayName:"TabView",props:{activeTabId:{defaultValue:null,description:"",name:"activeTabId",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((id: string) => void)"}},tabs:{defaultValue:null,description:"",name:"tabs",required:!0,type:{name:"Tab[]"}},otherLabel:{defaultValue:null,description:"",name:"otherLabel",required:!0,type:{name:"string"}},hideIfSingleItem:{defaultValue:{value:"true"},description:"",name:"hideIfSingleItem",required:!1,type:{name:"boolean"}},padding:{defaultValue:null,description:"",name:"padding",required:!1,type:{name:"enum",value:[{value:"4"},{value:"8"},{value:"12"},{value:"16"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},sticky:{defaultValue:{value:"false"},description:"",name:"sticky",required:!1,type:{name:"boolean"}}}}}catch{}const Xe={title:"Interactivity/TabView",component:J},X=({sticky:s,padding:d,hideIfSingleItem:b})=>e(Ce,{title:"TabView",description:"You can reduce window's width to see behavior when there isn't enough space to display all tabs",children:e(J,{sticky:s,padding:d,hideIfSingleItem:b,tabs:[{label:"SEPA Credit Transfers",url:"/simulator/sct",count:2},{label:"SEPA Direct Debits",url:"/simulator/sdd",icon:"building-regular"},{label:"Cards",url:"/simulator/cards",withSeparator:!0},{label:"Apple Pay/Google Pay",url:"/simulator/apple-pay-google-pay"},{label:"Account holders",url:"/simulator/account-holders"},{label:"Merchant acquiring",url:"/simulator/merchant-acquiring"}],otherLabel:"More"})});var le,se,ae;X.parameters={...X.parameters,docs:{...(le=X.parameters)==null?void 0:le.docs,source:{originalSource:`({
  sticky,
  padding,
  hideIfSingleItem
}: StoryArgs) => {
  return <StoryBlock title="TabView" description="You can reduce window's width to see behavior when there isn't enough space to display all tabs">
      <TabView sticky={sticky} padding={padding} hideIfSingleItem={hideIfSingleItem} tabs={[{
      label: "SEPA Credit Transfers",
      url: "/simulator/sct",
      count: 2
    }, {
      label: "SEPA Direct Debits",
      url: "/simulator/sdd",
      icon: "building-regular"
    }, {
      label: "Cards",
      url: "/simulator/cards",
      withSeparator: true
    }, {
      label: "Apple Pay/Google Pay",
      url: "/simulator/apple-pay-google-pay"
    }, {
      label: "Account holders",
      url: "/simulator/account-holders"
    }, {
      label: "Merchant acquiring",
      url: "/simulator/merchant-acquiring"
    }]} otherLabel="More" />
    </StoryBlock>;
}`,...(ae=(se=X.parameters)==null?void 0:se.docs)==null?void 0:ae.source}}};const Ye=["Default"];export{X as Default,Ye as __namedExportsOrder,Xe as default};
//# sourceMappingURL=TabView.stories-e71ce865.js.map
