import{h as R,j as e,V as c,B as te,I as q,c as i,S as re,T as se,L as oe,s as h,m as ae,d as b}from"./ScrollView-BHyA0YQe.js";import{r as t}from"./iframe-D68wIgOL.js";import{u as ie}from"./Pressable-WCLW66TX.js";import{g as A}from"./FocusTrap-DqMjcozw.js";import{P as le,F as ue}from"./Popover-CCue58Aw.js";import{L as de}from"./LakeTextInput-By_o2jzn.js";import{L as D}from"./Suspendable-GzJ3-enj.js";import{S as ce}from"./Separator-Rc6ZyfHq.js";import{M as me}from"./index-CFkdFAO1.js";const pe=64,fe=3.5,r=h.create({list:{marginVertical:b[8]},flatList:{scrollBehavior:"smooth"},item:{flexShrink:1,flexGrow:1,justifyContent:"center",paddingHorizontal:b[24],paddingVertical:0,transitionProperty:"background-color",transitionDuration:"200ms",outlineStyle:"none",justifyContents:"center"},hoveredItem:{backgroundColor:i.gray[0]},focusedItem:{backgroundColor:i.gray[0]},pressedItem:{backgroundColor:i.gray[100]},itemText:{userSelect:"none"},loader:{padding:b[24]},listContainer:{flexGrow:1,flexShrink:1},loaderAdditional:{...h.absoluteFillObject,alignItems:"center",justifyContent:"center"},loaderAdditionalUnderlay:{...h.absoluteFillObject,backgroundColor:ae.accented,opacity:.8},emptyList:{height:136},emptyListText:{color:i.gray.primary},input:{width:1,flexGrow:1}}),ye=({ref:F,inputRef:P,value:p,items:T,itemHeight:k=pe,nbItemsDisplayed:S=fe,ListFooterComponent:N,onChange:V,onValueChange:I,onSelectItem:_,renderItem:B,keyExtractor:O,icon:G,placeholder:H,disabled:K=!1,emptyResultText:U,readOnly:M,id:z,error:W,hideErrors:Y})=>{const f=t.useRef(null),J=ie(f,P),y=t.useRef(null),l=t.useRef(void 0),[Q,v]=t.useState(!1),[g,a]=t.useState("closed"),X=t.useCallback(()=>a("opened"),[]),Z=t.useCallback(()=>a("closed"),[]),C=t.useCallback(()=>a("dismissed"),[]);t.useImperativeHandle(F,()=>({open:X,close:Z}));const j=t.useId(),$=t.useCallback(n=>{if(n.nativeEvent.key==="ArrowDown"){const s=y.current;s!=null&&(A(s,!1)[0]?.focus(),n.preventDefault())}},[]),ee=t.useCallback(n=>{if(n.nativeEvent.key==="ArrowDown"||n.nativeEvent.key==="ArrowUp"){const s=y.current;if(s!=null){const u=s,o=n.currentTarget,d=A(u,!1),m=d.indexOf(o),x=n.nativeEvent.key==="ArrowDown"?1:-1;if(m===-1)return;const w=m+x;n.preventDefault(),w===-1?f.current?.focus():d[w===d.length?0:w]?.focus()}}},[]),ne=t.useCallback(n=>{I(n),a(R(n)?"opened":"closed")},[I]),E=t.useCallback(()=>{R(p)&&(window.clearTimeout(l.current),l.current=window.setTimeout(()=>{a(n=>n==="closed"?"opened":n)},100))},[p]),L=t.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>{a("dismissed")},100)},[]);return e.jsxs(c,{children:[e.jsx(de,{containerRef:J,style:r.input,ariaExpanded:g==="opened",ariaControls:g==="opened"?j:"",enterKeyHint:"search",icon:G,role:"combobox",placeholder:H,value:p,disabled:K,error:W,hideErrors:Y,onChangeText:ne,onChange:V,onFocus:E,onBlur:L,onKeyPress:$,id:z,readOnly:M}),e.jsx(le,{id:j,role:"listbox",matchReferenceWidth:!0,onEscapeKey:C,referenceRef:f,autoFocus:!1,returnFocus:!0,visible:g==="opened"&&!T.isNotAsked(),underlay:!1,forcedMode:"Dropdown",children:e.jsx(c,{style:[r.list,{maxHeight:k*S}],children:T.match({NotAsked:()=>null,Loading:()=>e.jsx(D,{style:r.loader}),Done:n=>n.match({Error:s=>e.jsx(q,{name:"error-circle-regular",size:22,color:i.negative[500]}),Ok:s=>e.jsxs(c,{ref:y,style:r.listContainer,children:[s.length===0?e.jsxs(te,{justifyContent:"center",alignItems:"center",style:r.emptyList,children:[e.jsx(q,{name:"clipboard-search-regular",size:24,color:i.gray.primary}),e.jsx(re,{height:8}),e.jsx(se,{style:r.emptyListText,children:U})]}):e.jsx(ue,{keyExtractor:O,role:"list",data:s,style:r.flatList,ItemSeparatorComponent:e.jsx(ce,{}),renderItem:({item:u})=>{const o=B(u);return e.jsx(me,{onFocus:E,onBlur:L,role:"listitem",onKeyDown:ee,style:({hovered:d,pressed:m,focused:x})=>[r.item,d&&r.hoveredItem,x&&r.focusedItem,m&&r.pressedItem,{height:k}],onPress:()=>{window.clearTimeout(l.current),v(!0),Promise.resolve(_(u)).finally(()=>{v(!1),C()})},children:typeof o=="string"||typeof o=="number"?e.jsx(oe,{numberOfLines:1,style:r.itemText,children:o}):o})}}),N,Q?e.jsxs(c,{style:r.loaderAdditional,children:[e.jsx(c,{style:r.loaderAdditionalUnderlay}),e.jsx(D,{})]}):null]})})})})})]})};ye.__docgenInfo={description:"",methods:[],displayName:"LakeCombobox",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:`{
  close: () => void;
  open: () => void;
}`,signature:{properties:[{key:"close",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}}]}}],raw:"Ref<LakeComboboxRef>"},description:""},inputRef:{required:!1,tsType:{name:"Ref",elements:[{name:"unknown"}],raw:"Ref<unknown>"},description:""},value:{required:!0,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"AsyncData",elements:[{name:"Result",elements:[{name:"Array",elements:[{name:"I"}],raw:"I[]"},{name:"unknown"}],raw:"Result<I[], unknown>"}],raw:"AsyncData<Result<I[], unknown>>"},description:""},itemHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"64",computed:!1}},nbItemsDisplayed:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3.5",computed:!1}},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},onChange:{required:!1,tsType:{name:'intersection["onChange"]',raw:'LakeTextInputProps["onChange"]'},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onSelectItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: I) => void | Promise<unknown>",signature:{arguments:[{type:{name:"I"},name:"value"}],return:{name:"union",raw:"void | Promise<unknown>",elements:[{name:"void"},{name:"Promise",elements:[{name:"unknown"}],raw:"Promise<unknown>"}]}}},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => ReactNode | null",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"union",raw:"ReactNode | null",elements:[{name:"ReactNode"},{name:"null"}]}}},description:""},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => string",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"string"}}},description:""},icon:{required:!1,tsType:{name:"unknown"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},emptyResultText:{required:!0,tsType:{name:"string"},description:""},error:{required:!1,tsType:{name:"string"},description:""},hideErrors:{required:!1,tsType:{name:"boolean"},description:""},id:{required:!1,tsType:{name:"string"},description:""},readOnly:{required:!1,tsType:{name:"boolean"},description:""}}};export{ye as L};
//# sourceMappingURL=LakeCombobox-CL6Aer8X.js.map
