import{S as he,c as g,t as ee,r as oe,s as z,e as ie,f as pe,n as fe,a as e,l as me,i as s,j as b,V as j,T as I,b as C,p as we,F as G,L as ge}from"./Space-57107f4e.js";import{K as be}from"./index-01d9d616.js";import{r as i}from"./index-8db94870.js";import{Q as J,H as O,B as ye}from"./index-7a357b54.js";import{a as ce,u as Fe}from"./useMergeRefs-9ae9a1ea.js";import{n as ke}from"./function-30fe01e9.js";import{F as ve}from"./FocusTrap-307c77b1.js";import{I as Y}from"./Icon-26b2c7d1.js";import{L as Le}from"./Link-3a671092.js";import{a as ue}from"./Pressable-ac4f9d8c.js";import{T as Te}from"./TransitionView-07b011e8.js";import{S as Se}from"./_StoriesComponents-f7676638.js";import"./extends-98964cd2.js";import"./_commonjsHelpers-042e6b4d.js";import"./with-selector-11af2eb6.js";import"./index-302a0035.js";import"./Boxed-b75d14a5.js";import"./array-b3630b94.js";import"./Svg-c3c146c4.js";const Ce=40,n=he.create({container:{borderBottomWidth:1,borderBottomColor:g.gray[100],zIndex:10},link:{...ee.medium,position:"relative",color:g.gray[700],height:Ce,whiteSpace:"nowrap",display:"flex",flexDirection:"row",alignItems:"center"},activeLink:{color:g.current[500],boxShadow:`inset 0 -2px ${g.gray[700]}`},hoveredLink:{boxShadow:`inset 0 -2px ${g.gray[700]}`},underline:{position:"absolute",bottom:0,height:2,width:1,backgroundColor:g.current[500]},animatedUnderline:{transformOrigin:"0 0",transition:"200ms ease-in-out transform"},placeholder:{position:"absolute",top:0,left:0,right:0,visibility:"hidden",flexDirection:"row",alignItems:"flex-end",overflow:"hidden",pointerEvents:"none"},count:{...ee.smallRegular,color:g.current[500],backgroundColor:g.current[50],borderColor:g.current[100],borderWidth:1,borderRadius:oe[4],paddingHorizontal:z[4],minWidth:z[24],display:"inline-block",textAlign:"center"},dropdownHandleContainer:{alignItems:"center",justifyContent:"center",alignSelf:"stretch"},dropdownPlacement:{position:"absolute",right:0,top:"100%"},dropdown:{position:"absolute",right:0,top:"100%",backgroundColor:ie.accented,borderRadius:oe[8],boxShadow:pe.modal,paddingVertical:z[8]},dropdownLink:{...ee.regular,paddingHorizontal:z[16],paddingVertical:z[8],whiteSpace:"nowrap"},dropdownLinkTextHovered:{backgroundColor:g.gray[50]},dropdownLinkTextActive:{boxShadow:`inset 3px 0 ${g.current.primary}`,color:g.current.primary},separator:{position:"absolute",top:0,left:fe[16],bottom:0,width:1,backgroundColor:g.gray[100]},sticky:{backgroundColor:ie.default,position:"sticky",top:-1}}),te=i.forwardRef(({children:u,style:d,tab:v,onChange:f,activeTabId:x,onBlur:h,onFocus:y,onPress:a},t)=>J(v).with({url:O.string},({url:p})=>e(Le,{ref:t,to:p,style:d,onFocus:y,onBlur:h,onPress:a,children:u})).with({id:O.string},({id:p})=>{const F=P(v)===x;return e(ue,{ref:t,style:V=>d({...V,active:F}),onPress:()=>{f==null||f(p),a==null||a()},onFocus:y,onBlur:h,children:u})}).exhaustive()),Oe=({tabs:u,onHoverStart:d,onHoverEnd:v,onLinkFocus:f,onLinkBlur:x,onLinkPress:h,activeTabId:y,onChange:a})=>{const t=i.useRef(null);return ce(t,{onHoverStart:d,onHoverEnd:v}),e(j,{role:"menu",style:n.dropdown,ref:t,children:u.map(p=>{const w=P(p);return e(te,{onChange:a,activeTabId:y,tab:p,onFocus:f,onBlur:x,onPress:h,role:"menuitem",ariaCurrentValue:"location",style:({active:F,hovered:V})=>[n.dropdownLink,F&&n.dropdownLinkTextActive,V&&n.dropdownLinkTextHovered],children:p.label},w)})})},xe=new Set(["ForcedOpen","OpenFromFocus"]),Re=new Set(["Open","ForcedOpen","OpenFromFocus"]),He=new Set(["ForcedOpen"]),Ee=i.forwardRef(({tabs:u,otherLabel:d,currentUrl:v,activeTabId:f,onChange:x},h)=>{const[y,a]=i.useReducer((r,c)=>J([c,r]).returnType().with(["ForceToggle","Closed"],["ForceToggle","Open"],["ForceToggle","ForcedClosed"],()=>"ForcedOpen").with(["ForceToggle","OpenFromFocus"],["ForceToggle","ForcedOpen"],()=>"ForcedClosed").with(["ForceClose",O.any],()=>"ForcedClosed").with(["FocusHandle","ForcedClosed"],()=>"Closed").with(["Open","ForcedOpen"],["FocusHandle","ForcedOpen"],["Close","ForcedOpen"],()=>"ForcedOpen").with(["Open",O.any],()=>"Open").with(["FocusHandle",O.any],()=>"OpenFromFocus").with(["Close",O.any],()=>"Closed").exhaustive(),"Closed"),t=i.useRef(void 0),p=i.useRef(null),w=i.useRef(null),F=i.useRef(null),{onHandleFocus:V,onLinkFocus:D,onAnyBlur:U,onHoverStart:W,onHoverEnd:M,onPress:N,onPressOutside:A,onEscapeKey:q}=i.useMemo(()=>({onHandleFocus:r=>{if(me(w.current))return;F.current=Date.now();const c=w.current,o=r;c.contains(o.relatedTarget)||(s(t.current)&&clearTimeout(t.current),a("FocusHandle"))},onLinkFocus:()=>{s(t.current)&&clearTimeout(t.current),a("Open")},onAnyBlur:()=>{s(t.current)&&clearTimeout(t.current),t.current=window.setTimeout(()=>{a("Close")},300)},onHoverStart:()=>{s(t.current)&&clearTimeout(t.current),a("Open")},onHoverEnd:()=>{s(t.current)&&clearTimeout(t.current),t.current=window.setTimeout(()=>{a("Close")},300)},onPress:()=>{F.current!=null&&Date.now()-F.current<32||(s(t.current)&&clearTimeout(t.current),a("ForceToggle"))},onPressOutside:r=>{s(p.current)&&p.current.contains(r.target)||(s(t.current)&&clearTimeout(t.current),a("ForceClose"),t.current=window.setTimeout(()=>{a("Close")},300))},onEscapeKey:()=>{s(t.current)&&clearTimeout(t.current),a("ForceClose"),t.current=window.setTimeout(()=>{a("Close")},300)}}),[]);i.useEffect(()=>()=>{s(t.current)&&clearTimeout(t.current)},[]);const K=Re.has(y),$=xe.has(y),E=He.has(y);ce(p,{onHoverStart:W,onHoverEnd:M});const _=Fe(w,h),Z=u.find(r=>re({activeTabId:f,currentLocationURL:v,tab:r}));return b(j,{style:n.dropdownHandleContainer,ref:_,children:[b(ue,{ref:p,role:"button","aria-expanded":K,"aria-haspopup":"true",onFocus:V,onBlur:U,onPress:N,style:({hovered:r})=>[n.link,s(Z)?n.activeLink:r?n.hoveredLink:null],children:[e(I,{children:d}),e(C,{width:8}),e(I,{style:n.count,children:u.length}),e(C,{width:4}),e(Y,{name:"chevron-down-filled",size:12})]}),e(Te,{...we.fadeAndSlideInFromBottom,style:n.dropdownPlacement,children:K?e(ve,{autoFocus:$,focusLock:E,returnFocus:E,onClickOutside:A,onEscapeKey:E?q:void 0,children:e(Oe,{onChange:x,activeTabId:f,tabs:u,onHoverStart:W,onHoverEnd:M,onLinkFocus:D,onLinkBlur:U,onLinkPress:q})}):null})]})}),re=({tab:u,activeTabId:d,currentLocationURL:v})=>J(u).with({url:O.string},({url:f})=>v.startsWith(f)).with({id:O.string},({id:f})=>s(d)&&f===d).exhaustive(),P=u=>J(u).with({url:O.string},({url:d})=>d).with({id:O.string},({id:d})=>d).exhaustive(),Q=({tabs:u,otherLabel:d,hideIfSingleItem:v=!0,sticky:f=!1,padding:x,activeTabId:h,onChange:y})=>{const a=i.useRef(null),t=i.useRef(null),p=i.useRef(null),w=i.useRef({}),F=i.useRef({}),[{left:V,width:D},U]=i.useState({left:0,width:0}),[W,M]=i.useState(!1),[[N,A],q]=i.useState([[],[]]),K=be(),{path:$}=K,E=K.toString();i.useEffect(()=>{if(s(w.current)){const r=Object.entries(w.current),c=a.current;for(const[o,m]of r)if((o===h||"/"+$.join("/")===o)&&s(m)&&s(c)){m.measureLayout(c,(k,L,T)=>{U({left:k-(x??0),width:T})},ke);return}}U({left:0,width:0})},[$,N,A,x,h]),i.useEffect(()=>{M(D>0)},[D]);const _=i.useCallback(({width:r})=>{const c=u.map(l=>{if(F.current){const H=P(l),S=F.current[H];if(s(S)){const B=S.getBoundingClientRect().width;return{tab:l,width:B+32}}else return{tab:l,width:0}}else return{tab:l,width:0}}),o=[],m=[];let k=0;c.forEach(l=>{if(k+=l.width,k<r)o.push({...l.tab,width:l.width});else if(re({activeTabId:h,currentLocationURL:E,tab:l.tab})){for(;o.length!==0&&o.reduce((H,S)=>H+S.width,0)+(l.width+16)>=r;){const H=o.pop();s(H)&&(m.unshift(H),k-=H.width)}o.push({...l.tab,width:l.width})}else m.push({...l.tab,width:l.width})});const L=p.current;let T=100;s(L)&&(T=L.getBoundingClientRect().width);const R=o.findIndex(l=>re({activeTabId:h,currentLocationURL:E,tab:l}));if(R!==-1){const l=o[R],H=(l==null?void 0:l.width)??0,S=[...o.slice(0,R),...o.slice(R+1)];for(;S.length!==0&&S.reduce((B,de)=>B+de.width,0)+H+(m.length>=1?T:0)>=r;){const B=S.pop();s(B)&&m.unshift(B)}const ne=[...S.slice(0,R),...l!=null?[l]:[],...S.slice(R)];q([ne,m])}else q([o,m])},[u,h,E]),Z=i.useCallback(({target:r,nativeEvent:{layout:{width:c}}})=>{_({container:r,width:c})},[_]);return i.useLayoutEffect(()=>{const r=t.current;if(r){const c=r,o=c.getBoundingClientRect().width;_({container:c,width:o})}},[_]),u.length<=1&&v?null:b(ye,{alignItems:"center",direction:"row",role:"tablist",ref:a,style:[n.container,f&&n.sticky,{paddingHorizontal:x}],children:[b(j,{style:n.placeholder,"aria-hidden":!0,ref:t,onLayout:Z,children:[u.map(r=>{const{label:c,icon:o,count:m}=r,k=P(r);return b(i.Fragment,{children:[b(te,{ref:L=>{F.current&&(F.current[k]=L)},activeTabId:h,tab:r,onChange:y,style:({active:L,hovered:T})=>[n.link,L?n.activeLink:T?n.hoveredLink:null],children:[s(o)&&b(G,{children:[e(Y,{name:o,size:16,color:"currentColor"}),e(C,{width:8})]}),e(I,{children:c}),m!=null?b(G,{children:[e(C,{width:8}),e(I,{style:n.count,children:m})]}):null]}),e(C,{width:32})]},k)}),b(ge,{ref:p,style:n.link,children:[e(I,{children:d}),e(C,{width:8}),e(I,{style:n.count,children:u.length}),e(C,{width:4}),e(Y,{name:"chevron-down-filled",size:12})]})]}),N.map(r=>{const{label:c,icon:o,withSeparator:m,count:k}=r,L=P(r);return b(i.Fragment,{children:[b(te,{ref:T=>{w.current&&(w.current[L]=T)},onChange:y,activeTabId:h,tab:r,role:"tab",style:({active:T,hovered:R})=>[n.link,T?n.activeLink:R?n.hoveredLink:null],children:[m===!0&&e(j,{style:n.separator,role:"none"}),s(o)&&b(G,{children:[e(Y,{name:o,size:16,color:"currentColor"}),e(C,{width:8})]}),e(I,{children:c}),k!=null?b(G,{children:[e(C,{width:8}),e(I,{style:n.count,children:k})]}):null]}),e(C,{width:32})]},L)}),A.length>0?e(Ee,{ref:r=>{A.forEach(c=>{if(w.current){const o=P(c);w.current[o]=r}})},onChange:y,tabs:A,currentUrl:E,otherLabel:d,activeTabId:h}):null,W&&e(j,{style:[n.underline,n.animatedUnderline,{transform:`translateX(${V}px) scaleX(${D})`}]})]})};try{Q.displayName="TabView",Q.__docgenInfo={description:"",displayName:"TabView",props:{activeTabId:{defaultValue:null,description:"",name:"activeTabId",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((id: string) => void)"}},tabs:{defaultValue:null,description:"",name:"tabs",required:!0,type:{name:"Tab[]"}},otherLabel:{defaultValue:null,description:"",name:"otherLabel",required:!0,type:{name:"string"}},hideIfSingleItem:{defaultValue:{value:"true"},description:"",name:"hideIfSingleItem",required:!1,type:{name:"boolean"}},padding:{defaultValue:null,description:"",name:"padding",required:!1,type:{name:"enum",value:[{value:"4"},{value:"8"},{value:"12"},{value:"16"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},sticky:{defaultValue:{value:"false"},description:"",name:"sticky",required:!1,type:{name:"boolean"}}}}}catch{}const Qe={title:"Interactivity/TabView",component:Q},X=()=>e(Se,{title:"TabView",description:"You can reduce window's width to see behavior when there isn't enough space to display all tabs",children:e(Q,{tabs:[{label:"SEPA Credit Transfers",url:"/simulator/sct",count:2},{label:"SEPA Direct Debits",url:"/simulator/sdd",icon:"building-regular"},{label:"Cards",url:"/simulator/cards",withSeparator:!0},{label:"Apple Pay/Google Pay",url:"/simulator/apple-pay-google-pay"},{label:"Account holders",url:"/simulator/account-holders"},{label:"Merchant acquiring",url:"/simulator/merchant-acquiring"}],otherLabel:"More"})});var le,se,ae;X.parameters={...X.parameters,docs:{...(le=X.parameters)==null?void 0:le.docs,source:{originalSource:`() => {
  return <StoryBlock title="TabView" description="You can reduce window's width to see behavior when there isn't enough space to display all tabs">
      <TabView tabs={[{
      label: "SEPA Credit Transfers",
      url: "/simulator/sct",
      count: 2
    }, {
      label: "SEPA Direct Debits",
      url: "/simulator/sdd",
      icon: "building-regular"
    }, {
      label: "Cards",
      url: "/simulator/cards",
      withSeparator: true
    }, {
      label: "Apple Pay/Google Pay",
      url: "/simulator/apple-pay-google-pay"
    }, {
      label: "Account holders",
      url: "/simulator/account-holders"
    }, {
      label: "Merchant acquiring",
      url: "/simulator/merchant-acquiring"
    }]} otherLabel="More" />
    </StoryBlock>;
}`,...(ae=(se=X.parameters)==null?void 0:se.docs)==null?void 0:ae.source}}};const Je=["Default"];export{X as Default,Je as __namedExportsOrder,Qe as default};
//# sourceMappingURL=TabView.stories-e8f64539.js.map
