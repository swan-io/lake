{"version":3,"file":"DatePicker.stories-88d1eea1.js","sources":["../../../packages/lake/src/components/DatePicker.tsx"],"sourcesContent":["import { Option } from \"@swan-io/boxed\";\nimport dayjs from \"dayjs\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { Rifm } from \"rifm\";\nimport { P, match } from \"ts-pattern\";\nimport { colors, invariantColors, radii, spacings } from \"../constants/design\";\nimport { noop } from \"../utils/function\";\nimport { isNotNullish, isNotNullishOrEmpty, isNullishOrEmpty } from \"../utils/nullish\";\nimport { getRifmProps } from \"../utils/rifm\";\nimport { Box } from \"./Box\";\nimport { Fill } from \"./Fill\";\nimport { Icon } from \"./Icon\";\nimport { LakeButton } from \"./LakeButton\";\nimport { Item, LakeSelect } from \"./LakeSelect\";\nimport { LakeText } from \"./LakeText\";\nimport { LakeTextInput } from \"./LakeTextInput\";\nimport { Pressable } from \"./Pressable\";\nimport { Separator } from \"./Separator\";\nimport { Space } from \"./Space\";\n\nconst styles = StyleSheet.create({\n  popoverContainer: {\n    width: 430,\n    padding: spacings[24],\n    backgroundColor: invariantColors.white,\n    borderRadius: radii[8],\n  },\n  rangePopoverContainer: {\n    alignSelf: \"flex-start\", // to remove when popover is setup\n    padding: spacings[24],\n    backgroundColor: invariantColors.white,\n    borderRadius: radii[8],\n  },\n  rangePopoverPart: {\n    width: 330,\n  },\n  button: {\n    flex: 1,\n  },\n  monthSelect: {\n    width: 130,\n  },\n  yearSelect: {\n    width: 100,\n  },\n  weekRow: {\n    paddingVertical: spacings[4],\n  },\n  dayName: {\n    flex: 1,\n    height: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  dayContainer: {\n    flex: 1,\n    alignItems: \"center\",\n  },\n  dayRangeIndicator: {\n    position: \"absolute\",\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    backgroundColor: colors.current[100],\n  },\n  dayStartRangeIndicator: {\n    left: \"50%\",\n  },\n  dayEndRangeIndicator: {\n    right: \"50%\",\n  },\n  dayNumber: {\n    width: 32,\n    height: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderRadius: 16,\n  },\n  dayNumberFocused: {},\n  dayNumberHover: {\n    backgroundColor: colors.current[100],\n  },\n  dayNumberPressed: {},\n  dayNumberSelected: {\n    backgroundColor: colors.current[500],\n  },\n  todayIndicator: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    bottom: 0,\n    width: 4,\n    height: 4,\n    marginHorizontal: \"auto\",\n    borderRadius: 2,\n    backgroundColor: colors.current[500],\n  },\n});\n\nconst NB_DAYS_IN_WEEK = 7;\n\ntype MonthNames = readonly [\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n  string,\n];\ntype WeekDayNames = readonly [string, string, string, string, string, string, string];\n\ntype YearMonth = {\n  year: number;\n  month: number;\n};\n\nconst weekDayIndex = {\n  sunday: 0,\n  monday: 1,\n  tuesday: 2,\n  wednesday: 3,\n  thursday: 4,\n  friday: 5,\n  saturday: 6,\n};\n\nexport type DatePickerDate = {\n  day: number;\n  month: number;\n  year: number;\n};\n\nexport type DatePickerRange = {\n  start: Option<DatePickerDate>;\n  end: Option<DatePickerDate>;\n};\n\ntype DateFormat = \"DD/MM/YYYY\" | \"MM/DD/YYYY\";\n\nconst rifmDateProps = getRifmProps({\n  accept: \"numeric\",\n  charMap: { 2: \"/\", 4: \"/\" },\n  maxLength: 8,\n});\n\nconst parseDate = (value: string, format: DateFormat): Option<DatePickerDate> => {\n  const date = dayjs.utc(value, format);\n  return date.isValid()\n    ? Option.Some({ day: date.date(), month: date.month(), year: date.year() })\n    : Option.None();\n};\n\nconst parseRange = (value: { start: string; end: string }, format: DateFormat): DatePickerRange => {\n  return {\n    start: parseDate(value.start, format),\n    end: parseDate(value.end, format),\n  };\n};\n\nconst stringifyDate = (value: DatePickerDate, format: DateFormat): string => {\n  const date = dayjs.utc().year(value.year).month(value.month).date(value.day);\n  return date.format(format);\n};\n\nexport const validateDateRangeOrder = (\n  value: { start: string; end: string },\n  format: DateFormat,\n) => {\n  const range = parseRange(value, format);\n\n  if (range.start.isNone() || range.end.isNone()) {\n    return true;\n  }\n\n  if (isDateAfter(range.start.value, range.end.value)) {\n    return false;\n  }\n\n  return true;\n};\n\nconst range = (start: number, end: number): number[] => {\n  const result = [];\n  for (let i = start; i <= end; i++) {\n    result.push(i);\n  }\n  return result;\n};\n\nconst groupEvery = <T,>(input: T[], groupSize: number): T[][] => {\n  const result = [];\n  const nbGroups = Math.ceil(input.length / groupSize);\n  for (let i = 0; i < nbGroups; i++) {\n    result.push(input.slice(i * groupSize, (i + 1) * groupSize));\n  }\n\n  return result;\n};\n\nconst padEnd = <T,>(input: T[], length: number, value: T): T[] => {\n  const itemsToAppend = new Array(length - input.length).fill(value) as T[];\n  return [...input, ...itemsToAppend];\n};\n\nexport const isTodayOrFutureDate = (date: DatePickerDate): boolean => {\n  const today = new Date();\n\n  return (\n    date.year >= today.getFullYear() &&\n    date.month >= today.getMonth() &&\n    date.day >= today.getDate()\n  );\n};\n\nexport const isDateInRange =\n  (minDate: Date, maxDate: Date) =>\n  (date: DatePickerDate): boolean => {\n    const minDay = minDate.getDate();\n    const minMonth = minDate.getMonth();\n    const minYear = minDate.getFullYear();\n\n    const maxDay = maxDate.getDate();\n    const maxMonth = maxDate.getMonth();\n    const maxYear = maxDate.getFullYear();\n\n    return (\n      date.day >= minDay &&\n      date.month >= minMonth &&\n      date.year >= minYear &&\n      date.day <= maxDay &&\n      date.month <= maxMonth &&\n      date.year <= maxYear\n    );\n  };\n\nconst isDateToday = (date: DatePickerDate): boolean => {\n  const today = new Date();\n  return (\n    date.day === today.getDate() &&\n    date.month === today.getMonth() &&\n    date.year === today.getFullYear()\n  );\n};\n\nconst getMonthDates = (month: number, year: number): DatePickerDate[] => {\n  const aggregate = (acc: DatePickerDate[], date: Date): DatePickerDate[] => {\n    const dateDay = date.getDate();\n    const dateMonth = date.getMonth();\n    const dateYear = date.getFullYear();\n\n    if (date.getMonth() !== month) {\n      return acc;\n    }\n\n    return aggregate(\n      [...acc, { day: dateDay, month: dateMonth, year: dateYear }],\n      new Date(year, month, dateDay + 1),\n    );\n  };\n\n  return aggregate([], new Date(year, month, 1));\n};\n\nconst getMonthWeeks = (\n  month: number,\n  year: number,\n  firstWeekDay: keyof typeof weekDayIndex,\n): Option<DatePickerDate>[][] => {\n  const firstWeekDayIndex = weekDayIndex[firstWeekDay];\n  const monthFirstWeekDay = new Date(year, month, 1).getDay();\n  const monthDates = getMonthDates(month, year).map(date => Option.Some(date));\n\n  const nbDaysToPrepend =\n    monthFirstWeekDay >= firstWeekDayIndex\n      ? monthFirstWeekDay - firstWeekDayIndex\n      : NB_DAYS_IN_WEEK - firstWeekDayIndex + monthFirstWeekDay;\n\n  for (let i = 0; i < nbDaysToPrepend; i++) {\n    monthDates.unshift(Option.None());\n  }\n  const weeks = groupEvery(monthDates, NB_DAYS_IN_WEEK);\n  const lastWeek = weeks[weeks.length - 1];\n\n  if (!lastWeek) {\n    return weeks;\n  }\n  weeks[weeks.length - 1] = padEnd(lastWeek, NB_DAYS_IN_WEEK, Option.None());\n\n  return weeks;\n};\n\nconst getWeekDayNames = (\n  dayNames: WeekDayNames,\n  firstWeekDay: keyof typeof weekDayIndex = \"sunday\",\n): WeekDayNames => {\n  const firstWeekDayIndex = weekDayIndex[firstWeekDay];\n  const firstWeekDayNames = dayNames.slice(firstWeekDayIndex);\n  const lastWeekDayNames = dayNames.slice(0, firstWeekDayIndex);\n\n  // @ts-expect-error\n  return [...firstWeekDayNames, ...lastWeekDayNames];\n};\n\nconst isDateEquals = (date1: DatePickerDate, date2: DatePickerDate): boolean => {\n  return date1.day === date2.day && date1.month === date2.month && date1.year === date2.year;\n};\n\nconst isDateBefore = (date1: DatePickerDate, date2: DatePickerDate): boolean => {\n  return (\n    date1.year < date2.year ||\n    (date1.year === date2.year && date1.month < date2.month) ||\n    (date1.year === date2.year && date1.month === date2.month && date1.day < date2.day)\n  );\n};\n\nconst isDateAfter = (date1: DatePickerDate, date2: DatePickerDate): boolean => {\n  return (\n    date1.year > date2.year ||\n    (date1.year === date2.year && date1.month > date2.month) ||\n    (date1.year === date2.year && date1.month === date2.month && date1.day > date2.day)\n  );\n};\n\nconst isDateRange = (value: Option<DatePickerDate> | DatePickerRange): value is DatePickerRange => {\n  return match(value)\n    .with({ start: P._, end: P._ }, () => true)\n    .otherwise(() => false);\n};\n\nconst isSelectedDate = (date: DatePickerDate, value: Option<DatePickerDate> | DatePickerRange) => {\n  return match(value)\n    .with(Option.pattern.Some(P.select()), value => isDateEquals(value, date))\n    .with(Option.pattern.None, () => false)\n    .with(\n      P.when(isDateRange),\n      ({ start, end }) =>\n        start.match({\n          Some: start => isDateEquals(start, date),\n          None: () => false,\n        }) ||\n        end.match({\n          Some: end => isDateEquals(end, date),\n          None: () => false,\n        }),\n    )\n    .exhaustive();\n};\n\nconst getRangeIndicatorType = (\n  date: DatePickerDate,\n  value: Option<DatePickerDate> | DatePickerRange,\n): \"none\" | \"start\" | \"end\" | \"between\" => {\n  if (!isDateRange(value)) {\n    return \"none\";\n  }\n\n  const { start, end } = value;\n  if (start.isNone() || end.isNone()) {\n    return \"none\";\n  }\n\n  const startDate = start.value;\n  const endDate = end.value;\n\n  if (isDateEquals(startDate, endDate)) {\n    return \"none\";\n  }\n  if (isDateEquals(date, startDate)) {\n    return \"start\";\n  }\n  if (isDateEquals(date, endDate)) {\n    return \"end\";\n  }\n  if (isDateAfter(date, startDate) && isDateBefore(date, endDate)) {\n    return \"between\";\n  }\n  return \"none\";\n};\n\nconst computeDateDistanceInDays = (date1: DatePickerDate, date2: DatePickerDate): number => {\n  const date1Date = new Date(date1.year, date1.month, date1.day);\n  const date2Date = new Date(date2.year, date2.month, date2.day);\n\n  const diffInMs = Math.abs(date2Date.getTime() - date1Date.getTime());\n  return Math.round(diffInMs / (1000 * 3600 * 24));\n};\n\nconst getNewDateRange = (\n  currentRange: DatePickerRange,\n  selectedDate: DatePickerDate,\n): DatePickerRange => {\n  const { start, end } = currentRange;\n\n  // Handle initial selection\n  if (start.isNone()) {\n    return { start: Option.Some(selectedDate), end: Option.None() };\n  }\n  if (end.isNone()) {\n    if (isDateAfter(selectedDate, start.value)) {\n      return { start, end: Option.Some(selectedDate) };\n    }\n\n    return { start: Option.Some(selectedDate), end: currentRange.start };\n  }\n\n  // Handle selection outside of the current range\n  if (isDateBefore(selectedDate, start.value)) {\n    return { start: Option.Some(selectedDate), end: currentRange.end };\n  }\n  if (isDateAfter(selectedDate, end.value)) {\n    return { start: currentRange.start, end: Option.Some(selectedDate) };\n  }\n\n  // We change the closest date to the new date\n  const startDistance = computeDateDistanceInDays(start.value, selectedDate);\n  const endDistance = computeDateDistanceInDays(end.value, selectedDate);\n\n  if (startDistance < endDistance) {\n    return { start: Option.Some(selectedDate), end: currentRange.end };\n  }\n  return { start: currentRange.start, end: Option.Some(selectedDate) };\n};\n\nconst getTodayYearMonth = (): YearMonth => ({\n  month: new Date().getMonth(),\n  year: new Date().getFullYear(),\n});\n\nconst getYearMonth = (value: string | undefined, format: DateFormat): Option<YearMonth> => {\n  if (isNullishOrEmpty(value)) {\n    return Option.None();\n  }\n  return parseDate(value, format);\n};\n\nconst isYearMonthBefore = (date1: YearMonth, date2: YearMonth): boolean => {\n  return date1.year < date2.year || (date1.year === date2.year && date1.month < date2.month);\n};\n\nconst isYearMonthEquals = (date1: YearMonth, date2: YearMonth): boolean => {\n  return date1.year === date2.year && date1.month === date2.month;\n};\n\nconst minYearMonth = (date1: YearMonth, date2: YearMonth): YearMonth => {\n  return isYearMonthBefore(date1, date2) ? date1 : date2;\n};\n\nconst maxYearMonth = (date1: YearMonth, date2: YearMonth): YearMonth => {\n  return isYearMonthBefore(date1, date2) ? date2 : date1;\n};\n\nconst incrementYearMonth = ({ month, year }: YearMonth): YearMonth => {\n  if (month === 11) {\n    return { month: 0, year: year + 1 };\n  }\n  return { month: month + 1, year };\n};\n\nconst decrementYearMonth = ({ month, year }: YearMonth): YearMonth => {\n  if (month === 0) {\n    return { month: 11, year: year - 1 };\n  }\n  return { month: month - 1, year };\n};\n\ntype YearMonthSelectProps = {\n  monthNames: MonthNames;\n  value: YearMonth;\n  arrowsPosition?: \"around\" | \"right\";\n  minValue?: YearMonth;\n  maxValue?: YearMonth;\n  onChange: (value: YearMonth) => void;\n};\n\nconst YearMonthSelect = ({\n  monthNames,\n  value,\n  minValue,\n  maxValue,\n  arrowsPosition = \"right\",\n  onChange,\n}: YearMonthSelectProps) => {\n  const monthItems = useMemo<Item<number>[]>(\n    () => monthNames.map((name, index) => ({ name, value: index })),\n    [monthNames],\n  );\n\n  const yearItems = useMemo<Item<number>[]>(\n    () =>\n      range(value.year - 5, value.year + 5).map(year => ({\n        name: year.toString(),\n        value: year,\n      })),\n    [value.year],\n  );\n\n  const selectMonth = (month: number) => {\n    onChange({ year: value.year, month });\n  };\n\n  const selectYear = (year: number) => {\n    onChange({ year, month: value.month });\n  };\n\n  const setPreviousMonth = () => {\n    onChange(decrementYearMonth(value));\n  };\n\n  const setNextMonth = () => {\n    onChange(incrementYearMonth(value));\n  };\n\n  const isPreviousDisabled = !minValue\n    ? false\n    : value.year <= minValue.year && value.month <= minValue.month;\n  const isNextDisabled = !maxValue\n    ? false\n    : value.year >= maxValue.year && value.month >= maxValue.month;\n\n  return (\n    <Box direction=\"row\" alignItems=\"center\">\n      {arrowsPosition === \"around\" && (\n        <>\n          <LakeButton\n            size=\"small\"\n            mode=\"tertiary\"\n            icon=\"arrow-left-filled\"\n            disabled={isPreviousDisabled}\n            onPress={setPreviousMonth}\n          />\n\n          <Fill minWidth={12} />\n        </>\n      )}\n\n      <LakeSelect\n        items={monthItems}\n        value={value.month}\n        onValueChange={selectMonth}\n        mode=\"borderless\"\n        size=\"small\"\n        hideErrors={true}\n        style={styles.monthSelect}\n      />\n\n      <LakeSelect\n        items={yearItems}\n        value={value.year}\n        onValueChange={selectYear}\n        mode=\"borderless\"\n        size=\"small\"\n        hideErrors={true}\n        style={styles.yearSelect}\n      />\n\n      <Fill minWidth={12} />\n\n      {arrowsPosition === \"right\" && (\n        <>\n          <LakeButton\n            size=\"small\"\n            mode=\"tertiary\"\n            icon=\"arrow-left-filled\"\n            disabled={isPreviousDisabled}\n            onPress={setPreviousMonth}\n          />\n\n          <Space width={12} />\n        </>\n      )}\n\n      <LakeButton\n        size=\"small\"\n        mode=\"tertiary\"\n        icon=\"arrow-right-filled\"\n        disabled={isNextDisabled}\n        onPress={setNextMonth}\n      />\n    </Box>\n  );\n};\n\ntype MonthCalendarProps = {\n  month: number;\n  year: number;\n  value: Option<DatePickerDate> | DatePickerRange;\n  firstWeekDay: keyof typeof weekDayIndex;\n  weekDayNames: WeekDayNames;\n  isSelectable?: (date: DatePickerDate) => boolean;\n  onChange: (date: DatePickerDate) => void;\n};\n\nconst MonthCalendar = ({\n  month,\n  year,\n  value,\n  firstWeekDay,\n  weekDayNames,\n  isSelectable,\n  onChange,\n}: MonthCalendarProps) => {\n  const dayNames = useMemo(\n    () => getWeekDayNames(weekDayNames, firstWeekDay),\n    [weekDayNames, firstWeekDay],\n  );\n  const weeks = useMemo(\n    () => getMonthWeeks(month, year, firstWeekDay),\n    [month, year, firstWeekDay],\n  );\n\n  return (\n    <View>\n      <Box direction=\"row\" alignItems=\"center\" style={styles.weekRow}>\n        {dayNames.map(dayName => (\n          <View key={dayName} style={styles.dayName}>\n            <LakeText variant=\"medium\" color={colors.gray[600]}>\n              {dayName.substring(0, 1)}\n            </LakeText>\n          </View>\n        ))}\n      </Box>\n\n      {weeks.map((week, weekIndex) => (\n        <Box key={weekIndex} direction=\"row\" alignItems=\"center\" style={styles.weekRow}>\n          {week.map((date, dateIndex) => {\n            const isDisabled = date.match({\n              Some: date => isNotNullish(isSelectable) && !isSelectable(date),\n              None: () => true,\n            });\n            const isSelected = date.match({\n              Some: date => isSelectedDate(date, value),\n              None: () => false,\n            });\n            const isToday = date.match({\n              Some: date => isDateToday(date),\n              None: () => false,\n            });\n            const rangeIndicator = date.match({\n              Some: date => getRangeIndicatorType(date, value),\n              None: () => \"none\" as const,\n            });\n\n            return (\n              <View key={dateIndex} style={styles.dayContainer}>\n                {rangeIndicator !== \"none\" && (\n                  <View\n                    style={[\n                      styles.dayRangeIndicator,\n                      rangeIndicator === \"start\" && styles.dayStartRangeIndicator,\n                      rangeIndicator === \"end\" && styles.dayEndRangeIndicator,\n                    ]}\n                  />\n                )}\n\n                <Pressable\n                  disabled={isDisabled}\n                  onPress={() => date.match({ Some: onChange, None: noop })}\n                  style={({ focused, hovered, pressed }) => [\n                    styles.dayNumber,\n                    focused && styles.dayNumberFocused,\n                    hovered && styles.dayNumberHover,\n                    pressed && styles.dayNumberPressed,\n                    isSelected && styles.dayNumberSelected,\n                  ]}\n                >\n                  <LakeText\n                    variant=\"smallRegular\"\n                    color={\n                      isSelected\n                        ? colors.current.contrast\n                        : isDisabled\n                        ? colors.gray[300]\n                        : isToday\n                        ? colors.current[500]\n                        : colors.gray[900]\n                    }\n                  >\n                    {date.match({ Some: ({ day }) => day.toString(), None: () => \" \" })}\n                  </LakeText>\n\n                  {isToday && <View style={styles.todayIndicator} />}\n                </Pressable>\n              </View>\n            );\n          })}\n        </Box>\n      ))}\n    </View>\n  );\n};\n\nexport type DatePickerProps = {\n  value?: string;\n  error?: string;\n  format: DateFormat;\n  firstWeekDay: keyof typeof weekDayIndex;\n  monthNames: MonthNames;\n  weekDayNames: WeekDayNames;\n  isSelectable?: (date: DatePickerDate) => boolean;\n  onChange: (date: string) => void;\n};\n\nconst DatePickerPopover = ({\n  value,\n  format,\n  firstWeekDay,\n  monthNames,\n  weekDayNames,\n  isSelectable,\n  onChange,\n}: DatePickerProps) => {\n  const [monthYear, setMonthYear] = useState(() =>\n    getYearMonth(value, format).getWithDefault(getTodayYearMonth()),\n  );\n\n  // Automatically change displayed year and month when user change the value with text input\n  useEffect(() => {\n    const yearMonth = getYearMonth(value, format);\n    if (yearMonth.isSome()) {\n      setMonthYear(yearMonth.value);\n    }\n  }, [value, format]);\n\n  const handleChange = useCallback(\n    (date: DatePickerDate) => {\n      const formatted = stringifyDate(date, format);\n      onChange(formatted);\n    },\n    [format, onChange],\n  );\n\n  return (\n    <View style={styles.popoverContainer}>\n      <YearMonthSelect monthNames={monthNames} value={monthYear} onChange={setMonthYear} />\n      <Space height={24} />\n\n      <MonthCalendar\n        month={monthYear.month}\n        year={monthYear.year}\n        value={isNotNullishOrEmpty(value) ? parseDate(value, format) : Option.None()}\n        firstWeekDay={firstWeekDay}\n        weekDayNames={weekDayNames}\n        isSelectable={isSelectable}\n        onChange={handleChange}\n      />\n    </View>\n  );\n};\n\nexport const DatePicker = ({\n  value,\n  error,\n  format,\n  firstWeekDay,\n  monthNames,\n  weekDayNames,\n  isSelectable,\n  onChange,\n}: DatePickerProps) => {\n  return (\n    <>\n      <Rifm value={value ?? \"\"} onChange={onChange} {...rifmDateProps}>\n        {({ value, onChange }) => (\n          <LakeTextInput placeholder={format} value={value} error={error} onChange={onChange} />\n        )}\n      </Rifm>\n\n      <DatePickerPopover\n        value={value}\n        format={format}\n        firstWeekDay={firstWeekDay}\n        monthNames={monthNames}\n        weekDayNames={weekDayNames}\n        isSelectable={isSelectable}\n        onChange={onChange}\n      />\n    </>\n  );\n};\n\nexport type DateRangePickerProps = {\n  value: { start: string; end: string };\n  error?: string;\n  format: DateFormat;\n  firstWeekDay: keyof typeof weekDayIndex;\n  monthNames: MonthNames;\n  weekDayNames: WeekDayNames;\n  isSelectable?: (date: DatePickerDate) => boolean;\n  onChange: (date: { start: string; end: string }) => void;\n  cancelLabel: string;\n  confirmLabel: string;\n};\n\nconst DateRangePickerPopover = ({\n  value,\n  format,\n  firstWeekDay,\n  monthNames,\n  weekDayNames,\n  isSelectable,\n  onChange,\n  cancelLabel,\n  confirmLabel,\n}: DateRangePickerProps) => {\n  const [periods, setPeriods] = useState(() => {\n    const startYearMonth = getYearMonth(value.start, format).getWithDefault(getTodayYearMonth());\n    const endYearMonth = getYearMonth(value.end, format).getWithDefault(\n      incrementYearMonth(startYearMonth),\n    );\n    return { start: startYearMonth, end: endYearMonth };\n  });\n\n  // Automatically change displayed year and month when start date changes\n  useEffect(() => {\n    const startYearMonth = getYearMonth(value.start, format);\n\n    if (startYearMonth.isSome()) {\n      setPeriods(periods => {\n        const isStartAndEndSameMonth = isYearMonthEquals(startYearMonth.value, periods.end);\n        if (isStartAndEndSameMonth) {\n          return {\n            start: decrementYearMonth(periods.end),\n            end: periods.end,\n          };\n        }\n\n        // change end period if it becomes before start period\n        const endPeriod = maxYearMonth(periods.end, incrementYearMonth(startYearMonth.value));\n\n        return {\n          start: startYearMonth.value,\n          end: endPeriod,\n        };\n      });\n    }\n  }, [value.start, format]);\n\n  // Automatically change displayed year and month when end date changes\n  useEffect(() => {\n    const endYearMonth = getYearMonth(value.end, format);\n\n    if (endYearMonth.isSome()) {\n      setPeriods(periods => {\n        const isStartAndEndSameMonth = isYearMonthEquals(periods.start, endYearMonth.value);\n        if (isStartAndEndSameMonth) {\n          return {\n            start: periods.start,\n            end: incrementYearMonth(periods.start),\n          };\n        }\n\n        // change start period if it becomes after end period\n        const startPeriod = minYearMonth(periods.start, decrementYearMonth(endYearMonth.value));\n\n        return {\n          start: startPeriod,\n          end: endYearMonth.value,\n        };\n      });\n    }\n  }, [value.end, format]);\n\n  const setStartPeriod = useCallback((yearMonth: YearMonth) => {\n    setPeriods(periods => ({\n      start: yearMonth,\n      end: maxYearMonth(periods.end, incrementYearMonth(yearMonth)),\n    }));\n  }, []);\n\n  const setEndPeriod = useCallback((yearMonth: YearMonth) => {\n    setPeriods(periods => ({\n      start: minYearMonth(periods.start, decrementYearMonth(yearMonth)),\n      end: yearMonth,\n    }));\n  }, []);\n\n  const dateRange = useMemo(() => parseRange(value, format), [value, format]);\n\n  const handleSelectDate = (date: DatePickerDate) => {\n    const newRange = getNewDateRange(dateRange, date);\n    const newValue = {\n      start: newRange.start.match({\n        Some: date => stringifyDate(date, format),\n        None: () => value.start,\n      }),\n      end: newRange.end.match({\n        Some: date => stringifyDate(date, format),\n        None: () => value.end,\n      }),\n    };\n    onChange(newValue);\n  };\n\n  return (\n    <View style={styles.rangePopoverContainer}>\n      <Box direction=\"row\" alignItems=\"start\">\n        <View style={styles.rangePopoverPart}>\n          <YearMonthSelect\n            monthNames={monthNames}\n            value={periods.start}\n            maxValue={decrementYearMonth(periods.end)}\n            arrowsPosition=\"around\"\n            onChange={setStartPeriod}\n          />\n\n          <Space height={24} />\n\n          <MonthCalendar\n            month={periods.start.month}\n            year={periods.start.year}\n            value={dateRange}\n            firstWeekDay={firstWeekDay}\n            weekDayNames={weekDayNames}\n            isSelectable={isSelectable}\n            onChange={handleSelectDate}\n          />\n        </View>\n\n        <Separator space={24} horizontal={true} />\n\n        <View style={styles.rangePopoverPart}>\n          <YearMonthSelect\n            monthNames={monthNames}\n            value={periods.end}\n            minValue={incrementYearMonth(periods.start)}\n            arrowsPosition=\"around\"\n            onChange={setEndPeriod}\n          />\n\n          <Space height={24} />\n\n          <MonthCalendar\n            month={periods.end.month}\n            year={periods.end.year}\n            value={dateRange}\n            firstWeekDay={firstWeekDay}\n            weekDayNames={weekDayNames}\n            isSelectable={isSelectable}\n            onChange={handleSelectDate}\n          />\n        </View>\n      </Box>\n\n      <Space height={24} />\n\n      <Box direction=\"row\" alignItems=\"start\">\n        <LakeButton size=\"small\" mode=\"secondary\" style={styles.button}>\n          {cancelLabel}\n        </LakeButton>\n\n        <Space width={48} />\n\n        <LakeButton size=\"small\" mode=\"primary\" color=\"current\" style={styles.button}>\n          {confirmLabel}\n        </LakeButton>\n      </Box>\n    </View>\n  );\n};\n\nexport const DateRangePicker = ({\n  value,\n  error,\n  format,\n  firstWeekDay,\n  monthNames,\n  weekDayNames,\n  isSelectable,\n  onChange,\n  cancelLabel,\n  confirmLabel,\n}: DateRangePickerProps) => {\n  const handleStartChange = useCallback(\n    (start: string) => {\n      onChange({ start, end: value.end });\n    },\n    [value, onChange],\n  );\n\n  const handleEndChange = useCallback(\n    (end: string) => {\n      onChange({ start: value.start, end });\n    },\n    [value, onChange],\n  );\n\n  return (\n    <View>\n      <Box direction=\"row\" alignItems=\"center\">\n        <Rifm value={value.start} onChange={handleStartChange} {...rifmDateProps}>\n          {({ value, onChange }) => (\n            <LakeTextInput\n              placeholder={format}\n              value={value}\n              onChange={onChange}\n              hideErrors={true}\n            />\n          )}\n        </Rifm>\n\n        <Space width={12} />\n        <Icon name=\"arrow-right-filled\" size={20} />\n        <Space width={12} />\n\n        <Rifm value={value.end} onChange={handleEndChange} {...rifmDateProps}>\n          {({ value, onChange }) => (\n            <LakeTextInput\n              placeholder={format}\n              value={value}\n              onChange={onChange}\n              hideErrors={true}\n            />\n          )}\n        </Rifm>\n      </Box>\n\n      <Space height={4} />\n\n      <LakeText variant=\"smallRegular\" color={colors.negative[500]}>\n        {error ?? \" \"}\n      </LakeText>\n\n      <DateRangePickerPopover\n        value={value}\n        format={format}\n        firstWeekDay={firstWeekDay}\n        monthNames={monthNames}\n        weekDayNames={weekDayNames}\n        isSelectable={isSelectable}\n        onChange={onChange}\n        cancelLabel={cancelLabel}\n        confirmLabel={confirmLabel}\n      />\n    </View>\n  );\n};\n"],"names":["styles","StyleSheet","spacings","invariantColors","radii","colors","NB_DAYS_IN_WEEK","weekDayIndex","rifmDateProps","getRifmProps","parseDate","value","format","date","dayjs","Option","parseRange","stringifyDate","validateDateRangeOrder","range2","isDateAfter","range","start","end","result","i","groupEvery","input","groupSize","nbGroups","padEnd","length","itemsToAppend","isTodayOrFutureDate","today","isDateToday","getMonthDates","month","year","aggregate","acc","dateDay","dateMonth","dateYear","getMonthWeeks","firstWeekDay","firstWeekDayIndex","monthFirstWeekDay","monthDates","nbDaysToPrepend","weeks","lastWeek","getWeekDayNames","dayNames","firstWeekDayNames","lastWeekDayNames","isDateEquals","date1","date2","isDateBefore","isDateRange","match","P","isSelectedDate","value2","start2","end2","getRangeIndicatorType","startDate","endDate","computeDateDistanceInDays","date1Date","date2Date","diffInMs","getNewDateRange","currentRange","selectedDate","startDistance","endDistance","getTodayYearMonth","getYearMonth","isNullishOrEmpty","isYearMonthBefore","isYearMonthEquals","minYearMonth","maxYearMonth","incrementYearMonth","decrementYearMonth","YearMonthSelect","monthNames","minValue","maxValue","arrowsPosition","onChange","monthItems","useMemo","name","index","yearItems","selectMonth","selectYear","setPreviousMonth","setNextMonth","isPreviousDisabled","isNextDisabled","jsxs","Box","Fragment","jsx","LakeButton","Fill","LakeSelect","Space","MonthCalendar","weekDayNames","isSelectable","View","dayName","LakeText","week","weekIndex","dateIndex","isDisabled","isNotNullish","isSelected","isToday","rangeIndicator","Pressable","noop","focused","hovered","pressed","day","DatePickerPopover","monthYear","setMonthYear","useState","useEffect","yearMonth","handleChange","useCallback","formatted","isNotNullishOrEmpty","DatePicker","error","Rifm","onChange2","LakeTextInput","DateRangePickerPopover","cancelLabel","confirmLabel","periods","setPeriods","startYearMonth","endYearMonth","periods2","endPeriod","setStartPeriod","setEndPeriod","dateRange","handleSelectDate","newRange","newValue","Separator","DateRangePicker","handleStartChange","handleEndChange","Icon"],"mappings":"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"}