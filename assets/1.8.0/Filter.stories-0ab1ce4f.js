import{S as fe,c as H,j as P,F as ke,a as n,V as O,T as N,b as B,h as Ie,e as Oe,s as _e,i as ue}from"./Space-111b54e3.js";import{r as o}from"./index-f1f749bf.js";import{t as ge}from"./typography-6ad07e3d.js";import{u as $,P as U}from"./Popover-8bf24474.js";import{B as pe,K as se,S as X}from"./index.module-527d12e5.js";import{I as qe}from"./Icon-7fbfcf46.js";import{L as ne}from"./LakeButton-58a6fecd.js";import{F as ve}from"./index-e8767029.js";import{P as ae}from"./index-e0ca888d.js";import{d as Z}from"./dayjs.min-33e2be6b.js";import{s as be}from"./index-7f2f9e92.js";import{R as De}from"./rifm.esm-58cee9fb.js";import{a as ze}from"./useMergeRefs-9b9769b7.js";import{u as Be}from"./TransitionView-42b30aac.js";import{L as je}from"./LakeCheckbox-7d120b76.js";import{L as Re}from"./LakeLabel-361d87ed.js";import{L as Le}from"./LakeRadio-e251eafb.js";import{L as Ee}from"./LakeTextInput-64435d27.js";import{T as Ce}from"./Tag-59977808.js";import{W as Me}from"./WithCurrentColor-c5fb8277.js";import{g as Ae}from"./rifm-0becb07d.js";import{S as We}from"./_StoriesComponents-5ee96107.js";import"./extends-98964cd2.js";import"./_commonjsHelpers-042e6b4d.js";import"./colors-298625c7.js";import"./useResponsive-2d3d2aeb.js";import"./BottomPanel-95bef718.js";import"./commonStyles-d52fedae.js";import"./useBodyClassName-bd00433d.js";import"./math-5b8bd895.js";import"./FocusTrap-1dc42be7.js";import"./array-b3630b94.js";import"./LoadingView-2b013638.js";import"./index-89ec994e.js";import"./Portal-283179dd.js";import"./index-96c5f47c.js";import"./index-386c6b93.js";import"./Svg-c7a509c5.js";import"./Pressable-99e9839b.js";import"./v4-a960c1f4.js";import"./Fill-a6733115.js";const W=fe.create({selected:{color:H.gray[500]},list:{paddingVertical:20,marginVertical:4,minWidth:250,overflow:"hidden"},item:{display:"flex",paddingHorizontal:24,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},itemHovered:{backgroundColor:H.gray[50]},availableFiltersTitle:{...ge.bodyLarge,color:H.current[500],paddingHorizontal:24},filterName:{...ge.bodySmall}});function re({filters:a,openFilters:t,label:c,title:s,availableFilters:u,large:p=!0,onAddFilter:h}){const i=o.useRef(null),[S,{close:y,toggle:g}]=$(!1);return P(ke,{children:[n(pe,{direction:"row",justifyContent:"start",alignItems:"center",children:n(ne,{size:"small",mode:"secondary",color:"gray",onPress:g,ref:i,icon:p?"chevron-down-filled":"filter-filled",iconPosition:"end",ariaLabel:c,children:p?c:null})}),n(U,{role:"listbox",matchReferenceMinWidth:!0,onDismiss:y,referenceRef:i,returnFocus:!1,visible:S,children:P(O,{style:W.list,children:[n(N,{style:W.availableFiltersTitle,children:s}),n(B,{height:8}),n(ve,{role:"list",data:u,keyExtractor:(v,l)=>`filter-item-${l}`,renderItem:({item:v})=>{const l=!!a[v.name]||t.includes(v.name);return P(ae,{style:({hovered:b})=>[W.item,b&&W.itemHovered],role:"button",disabled:l,onPress:()=>{h(v.name),y()},children:[n(N,{style:[W.filterName,l&&W.selected],children:v.label}),l&&n(qe,{color:H.positive[500],name:"checkmark-filled",size:14})]})}})]})})]})}try{re.displayName="FilterChooser",re.__docgenInfo={description:"",displayName:"FilterChooser",props:{filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"Partial<Record<FilterName, unknown>>"}},openFilters:{defaultValue:null,description:"",name:"openFilters",required:!0,type:{name:"FilterName[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},availableFilters:{defaultValue:null,description:"",name:"availableFilters",required:!0,type:{name:"{ label: string; name: FilterName; }[]"}},large:{defaultValue:{value:"true"},description:"",name:"large",required:!1,type:{name:"boolean"}},onAddFilter:{defaultValue:null,description:"",name:"onAddFilter",required:!0,type:{name:"(filterName: FilterName) => void"}}}}}catch{}function z(){return z=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var c=arguments[t];for(var s in c)Object.prototype.hasOwnProperty.call(c,s)&&(a[s]=c[s])}return a},z.apply(this,arguments)}var He=typeof window>"u"?o.useEffect:o.useLayoutEffect,Ne=function(a){return a},Fe=function(){},we=function(a){return typeof a=="function"?a():a},oe=function(a){return!!a&&(typeof a=="object"||typeof a=="function")&&typeof a.then=="function"},Te=function(a,t){return t.every(function(c){return a[c]!==void 0})},Ke=function(a){var t=o.useReducer(function(){return[]},[])[1],c=o.useRef(!1),s=o.useRef(a),u=o.useRef("untouched");He(function(){s.current=a}),o.useEffect(function(){return c.current=!0,function(){c.current=!1}},[]);var p=o.useRef(),h=o.useRef(),i=o.useRef(),S=o.useRef(),y=o.useRef(),g=o.useRef(),v=o.useRef(),l=o.useMemo(function(){var C=function(e){return we(s.current[e].initialValue)},m=function(e){var r;return(r=s.current[e].sanitize)!=null?r:Ne},E=function(e){var r;return(r=s.current[e].validate)!=null?r:Fe},w=function(e){return i.current[e]},x=function(e,r){var f=p.current[e],d=typeof r=="function"?r({value:f.exposed.value,talkative:f.talkative,validity:f.validity}):r,R=d.talkative&&d.validity.tag!=="unknown"?{validating:d.validity.tag==="validating",valid:d.validity.tag==="valid",error:d.validity.tag==="invalid"?d.validity.error:void 0}:{validating:!1,valid:!E(e),error:void 0};p.current[e]={talkative:d.talkative,validity:d.validity,exposed:z({},R,{value:d.value})}},V=function(e){var r=y.current[e],f=r!==void 0;return f&&(clearTimeout(r),y.current[e]=void 0),f},F=function(e){h.current[e].forEach(function(r){return r()})},K=function(e,r){var f=function(d){var R;return(R=s.current[d].strategy)!=null?R:"onSuccessOrBlur"}(e);r&&!r.some(function(d){return f===d})||x(e,function(d){return z({},d,{talkative:!0})})},me=function(e){x(e,function(r){return z({},r,{validity:{tag:"validating"}})})},le=function(e,r){x(e,function(f){return z({},f,{validity:r!==void 0?{tag:"invalid",error:r}:{tag:"valid"}})})},Y=function(e,r){r===void 0&&(r={});var f=p.current[e].exposed;return r.sanitize?z({},f,{value:m(e)(f.value)}):f},M=function(e){var r=V(e),f=m(e),d=E(e),R=f(p.current[e].exposed.value),L=d(R,{getFieldState:Y,focusField:J});if(!oe(L)){var j=L;return j===void 0&&K(e,["onSuccess","onSuccessOrBlur"]),le(e,j),F(e),j}return r||(me(e),F(e)),L.then(function(_){var G=function(D){var A;return(A=s.current[D].equalityFn)!=null?A:Object.is}(e),T=f(p.current[e].exposed.value);if(G(R,T))return _===void 0&&K(e,["onSuccess","onSuccessOrBlur"]),le(e,_),F(e),_}).catch(function(_){})},J=function(e){var r=S.current[e];r.current&&typeof r.current.focus=="function"&&r.current.focus()},ye=function(e,r){r===void 0&&(r={}),V(e),x(e,function(f){return{value:r.feedbackOnly?f.value:C(e),talkative:!1,validity:{tag:"unknown"}}}),F(e)},he=function(e,r){var f=e[r.findIndex(function(d){return d!==void 0})];f!==void 0&&J(f)},Q=function(e,r){oe(e)?(t(),e.finally(function(){u.current="submitted",c.current&&t()})):(u.current="submitted",r&&t())};return{getFieldState:Y,setFieldValue:function(e,r,f){f===void 0&&(f={}),x(e,function(d){return z({},d,{value:r})}),f.validate&&K(e),M(e)},setFieldError:function(e,r){le(e,r),K(e),F(e)},focusField:J,resetField:ye,validateField:function(e){return w(e)?(K(e),Promise.resolve(M(e))):Promise.resolve(void 0)},listenFields:function(e,r){var f=function(){r(e.reduce(function(d,R){return d[R]=Y(R),d},{}))};return e.forEach(function(d){return h.current[d].add(f)}),function(){e.forEach(function(d){return h.current[d].delete(f)})}},resetForm:function(e){e===void 0&&(e={}),Object.keys(s.current).forEach(function(r){return ye(r,e)}),e.feedbackOnly||(u.current="untouched"),t()},submitForm:function(e,r,f){if(r===void 0&&(r=Fe),f===void 0&&(f={}),u.current!=="submitting"){var d=u.current==="editing";u.current="submitting";var R=Object.keys(i.current).filter(function(T){return i.current[T]}),L={},j={},_=[],G=!f.avoidFocusOnError;if(R.forEach(function(T,D){K(T),L[T]=Y(T,{sanitize:!0}).value,_[D]=M(T)}),function(T){return T.every(function(D){return!oe(D)})}(_))return _.every(function(T){return T===void 0})?Q(e(L),d):(G&&he(R,_),R.forEach(function(T,D){j[T]=_[D]}),Q(r(j),d));t(),Promise.all(_.map(function(T){return Promise.resolve(T)})).then(function(T){var D=T;return D.every(function(A){return A===void 0})?Q(e(L),d):(G&&he(R,D),R.forEach(function(A,Pe){j[A]=D[Pe]}),Q(r(j),d))}).finally(function(){u.current="submitted",c.current&&t()})}},setState:x,getOnChange:function(e){return function(r){var f=function(d){var R;return(R=s.current[d].debounceInterval)!=null?R:0}(e);x(e,function(d){return z({},d,{value:r})}),K(e,["onChange"]),V(e),u.current!=="untouched"&&u.current!=="submitted"||(u.current="editing",t()),f!==0?(me(e),F(e),y.current[e]=setTimeout(function(){w(e)?M(e):V(e)},f)):M(e)}},getOnBlur:function(e){return function(){p.current[e].validity.tag==="unknown"||function(r){return p.current[r].talkative}(e)||(K(e,["onBlur","onSuccessOrBlur"]),M(e))}},getFocusNextField:function(e){return function(){var r=Object.keys(s.current),f=r.findIndex(function(R){return R===e});if(f!==void 0){var d=r[f+1];d!==void 0&&J(d)}}}}},[]);if(!p.current){for(var b in p.current={},h.current={},i.current={},S.current={},y.current={},s.current)Object.prototype.hasOwnProperty.call(s.current,b)&&(l.setState(b,{value:we(s.current[b].initialValue),talkative:!1,validity:{tag:"unknown"}}),h.current[b]=new Set,i.current[b]=!1,S.current[b]={current:null},y.current[b]=void 0);var k=function(C){var m=C.name,E=C.children,w=o.useMemo(function(){return{getSnapshot:function(){return p.current[m]},subscribe:function(V){return h.current[m].add(V),function(){h.current[m].delete(V)}}}},[m]),x=w.getSnapshot;return be.useSyncExternalStore(w.subscribe,x,x),o.useEffect(function(){var V=!i.current[m];return V&&(i.current[m]=!0),function(){V&&(i.current[m]=!1)}},[m]),E(z({},l.getFieldState(m),{ref:S.current[m],focusNextField:o.useMemo(function(){return l.getFocusNextField(m)},[m]),onBlur:o.useMemo(function(){return l.getOnBlur(m)},[m]),onChange:o.useMemo(function(){return l.getOnChange(m)},[m])}))};k.displayName="Field",g.current=k;var I=function(C){var m=C.names,E=C.children,w=o.useMemo(function(){return{getSnapshot:function(){return JSON.stringify(m.map(function(V){return p.current[V]}))},subscribe:function(V){return m.forEach(function(F){return h.current[F].add(V)}),function(){m.forEach(function(F){return h.current[F].delete(V)})}}}},[JSON.stringify(m)]),x=w.getSnapshot;return be.useSyncExternalStore(w.subscribe,x,x),E(m.reduce(function(V,F){return V[F]=l.getFieldState(F),V},{}))};I.displayName="FieldsListener",v.current=I}return{formStatus:u.current,Field:g.current,FieldsListener:v.current,getFieldState:l.getFieldState,setFieldValue:l.setFieldValue,setFieldError:l.setFieldError,focusField:l.focusField,resetField:l.resetField,validateField:l.validateField,listenFields:l.listenFields,resetForm:l.resetForm,submitForm:l.submitForm}};const $e=fe.create({wrap:{flexWrap:"wrap"}}),ce=o.forwardRef(({children:a,space:t,wrap:c=!1,...s},u)=>{const{direction:p="column"}=s,h=p==="row"||p==="rowReverse";return n(pe,{style:c&&$e.wrap,ref:u,...s,children:o.Children.map(a,(i,S)=>Ie(i)?i:P(o.Fragment,{children:[S!==0&&(h?n(B,{width:t}):n(B,{height:t})),i]}))})});try{ce.displayName="Stack",ce.__docgenInfo={description:"",displayName:"Stack",props:{role:{defaultValue:null,description:"",name:"role",required:!1,type:{name:"enum",value:[{value:'"label"'},{value:'"form"'},{value:'"none"'},{value:'"grid"'},{value:'"row"'},{value:'"cell"'},{value:'"alert"'},{value:'"alertdialog"'},{value:'"application"'},{value:'"article"'},{value:'"banner"'},{value:'"button"'},{value:'"checkbox"'},{value:'"columnheader"'},{value:'"combobox"'},{value:'"complementary"'},{value:'"contentinfo"'},{value:'"definition"'},{value:'"dialog"'},{value:'"directory"'},{value:'"document"'},{value:'"feed"'},{value:'"figure"'},{value:'"group"'},{value:'"heading"'},{value:'"img"'},{value:'"link"'},{value:'"list"'},{value:'"listitem"'},{value:'"log"'},{value:'"main"'},{value:'"marquee"'},{value:'"math"'},{value:'"menu"'},{value:'"menubar"'},{value:'"menuitem"'},{value:'"meter"'},{value:'"navigation"'},{value:'"note"'},{value:'"option"'},{value:'"presentation"'},{value:'"progressbar"'},{value:'"radio"'},{value:'"radiogroup"'},{value:'"region"'},{value:'"rowgroup"'},{value:'"rowheader"'},{value:'"scrollbar"'},{value:'"searchbox"'},{value:'"separator"'},{value:'"slider"'},{value:'"spinbutton"'},{value:'"status"'},{value:'"summary"'},{value:'"switch"'},{value:'"tab"'},{value:'"table"'},{value:'"tablist"'},{value:'"tabpanel"'},{value:'"term"'},{value:'"timer"'},{value:'"toolbar"'},{value:'"tooltip"'},{value:'"tree"'},{value:'"treegrid"'},{value:'"treeitem"'},{value:'"blockquote"'},{value:'"code"'},{value:'"deletion"'},{value:'"emphasis"'},{value:'"insertion"'},{value:'"paragraph"'},{value:'"strong"'},{value:'"gridcell"'},{value:'"listbox"'},{value:'"menuitemcheckbox"'},{value:'"menuitemradio"'},{value:'"textbox"'}]}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyDownCapture:{defaultValue:null,description:"",name:"onKeyDownCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUp:{defaultValue:null,description:"",name:"onKeyUp",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},onKeyUpCapture:{defaultValue:null,description:"",name:"onKeyUpCapture",required:!1,type:{name:"((event: NativeSyntheticEvent<KeyboardEvent<Element>>) => void)"}},tabIndex:{defaultValue:null,description:"Additional accessibility props",name:"tabIndex",required:!1,type:{name:"enum",value:[{value:"0"},{value:"-1"}]}},"aria-activedescendant":{defaultValue:null,description:`Aria props (additional, minus existants)
@see https://necolas.github.io/react-native-web/docs/accessibility
@see https://reactnative.dev/docs/accessibility#aria-valuemax`,name:"aria-activedescendant",required:!1,type:{name:"string"}},"aria-atomic":{defaultValue:null,description:"",name:"aria-atomic",required:!1,type:{name:"boolean"}},"aria-autocomplete":{defaultValue:null,description:"",name:"aria-autocomplete",required:!1,type:{name:"string"}},"aria-colcount":{defaultValue:null,description:"",name:"aria-colcount",required:!1,type:{name:"number"}},"aria-colindex":{defaultValue:null,description:"",name:"aria-colindex",required:!1,type:{name:"number"}},"aria-colspan":{defaultValue:null,description:"",name:"aria-colspan",required:!1,type:{name:"number"}},"aria-controls":{defaultValue:null,description:"",name:"aria-controls",required:!1,type:{name:"string"}},"aria-current":{defaultValue:null,description:"",name:"aria-current",required:!1,type:{name:'boolean | "page" | "step" | "location" | "date" | "time"'}},"aria-describedby":{defaultValue:null,description:"",name:"aria-describedby",required:!1,type:{name:"string"}},"aria-details":{defaultValue:null,description:"",name:"aria-details",required:!1,type:{name:"string"}},"aria-errormessage":{defaultValue:null,description:"",name:"aria-errormessage",required:!1,type:{name:"string"}},"aria-flowto":{defaultValue:null,description:"",name:"aria-flowto",required:!1,type:{name:"string"}},"aria-haspopup":{defaultValue:null,description:"",name:"aria-haspopup",required:!1,type:{name:"string"}},"aria-invalid":{defaultValue:null,description:"",name:"aria-invalid",required:!1,type:{name:"boolean"}},"aria-keyshortcuts":{defaultValue:null,description:"",name:"aria-keyshortcuts",required:!1,type:{name:"string"}},"aria-level":{defaultValue:null,description:"",name:"aria-level",required:!1,type:{name:"number"}},"aria-multiline":{defaultValue:null,description:"",name:"aria-multiline",required:!1,type:{name:"boolean"}},"aria-multiselectable":{defaultValue:null,description:"",name:"aria-multiselectable",required:!1,type:{name:"boolean"}},"aria-orientation":{defaultValue:null,description:"",name:"aria-orientation",required:!1,type:{name:"enum",value:[{value:'"horizontal"'},{value:'"vertical"'}]}},"aria-owns":{defaultValue:null,description:"",name:"aria-owns",required:!1,type:{name:"string"}},"aria-placeholder":{defaultValue:null,description:"",name:"aria-placeholder",required:!1,type:{name:"string"}},"aria-posinset":{defaultValue:null,description:"",name:"aria-posinset",required:!1,type:{name:"number"}},"aria-pressed":{defaultValue:null,description:"",name:"aria-pressed",required:!1,type:{name:"boolean"}},"aria-readonly":{defaultValue:null,description:"",name:"aria-readonly",required:!1,type:{name:"boolean"}},"aria-required":{defaultValue:null,description:"",name:"aria-required",required:!1,type:{name:"boolean"}},"aria-roledescription":{defaultValue:null,description:"",name:"aria-roledescription",required:!1,type:{name:"string"}},"aria-rowcount":{defaultValue:null,description:"",name:"aria-rowcount",required:!1,type:{name:"number"}},"aria-rowindex":{defaultValue:null,description:"",name:"aria-rowindex",required:!1,type:{name:"number"}},"aria-rowspan":{defaultValue:null,description:"",name:"aria-rowspan",required:!1,type:{name:"number"}},"aria-setsize":{defaultValue:null,description:"",name:"aria-setsize",required:!1,type:{name:"number"}},"aria-sort":{defaultValue:null,description:"",name:"aria-sort",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"ascending"'},{value:'"descending"'},{value:'"other"'}]}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"stretch"'},{value:'"baseline"'}]}},direction:{defaultValue:null,description:"",name:"direction",required:!1,type:{name:"enum",value:[{value:'"row"'},{value:'"column"'},{value:'"columnReverse"'},{value:'"rowReverse"'}]}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"enum",value:[{value:'"center"'},{value:'"start"'},{value:'"end"'},{value:'"normal"'},{value:'"spaceBetween"'},{value:'"spaceAround"'},{value:'"spaceEvenly"'}]}},space:{defaultValue:null,description:"",name:"space",required:!1,type:{name:"enum",value:[{value:"16"},{value:"4"},{value:"8"},{value:"12"},{value:"20"},{value:"24"},{value:"32"},{value:"40"},{value:"48"},{value:"72"},{value:"96"}]}},wrap:{defaultValue:{value:"false"},description:"",name:"wrap",required:!1,type:{name:"boolean"}}}}}catch{}const q=fe.create({container:{paddingRight:12,paddingBottom:8},shadowed:{position:"absolute",opacity:0,width:"100%",height:"100%",borderRadius:4,boxShadow:Oe.tile,transitionDuration:"150ms",transitionProperty:"opacity"},hovered:{opacity:1},dropdown:{maxHeight:400,minWidth:200},itemHovered:{backgroundColor:H.gray[50]},content:{paddingVertical:12},inputContent:{padding:24},radio:{display:"flex",flexDirection:"row",alignItems:"center",height:32,paddingHorizontal:24},input:{minWidth:200},value:{maxWidth:130,whiteSpace:"nowrap"},buttonContainer:{paddingHorizontal:_e[24]}}),ie=o.forwardRef(({onPress:a,onPressRemove:t,label:c,value:s="",isActive:u},p)=>{const h=o.useRef(null),i=ze(h,p);return n(ae,{ref:i,onPress:a,children:({hovered:S})=>P(ke,{children:[n(O,{style:[q.shadowed,S&&q.hovered]}),n(Ce,{label:c,color:"current",onPressRemove:t,children:P(pe,{direction:"row",alignItems:"center",children:[n(N,{numberOfLines:1,style:q.value,children:s}),n(B,{width:4}),n(qe,{color:H.current.primary,name:u?"chevron-up-filled":"chevron-down-filled",size:16})]})})]})})});function Ue({label:a,items:t,value:c,onValueChange:s,onPressRemove:u,autoOpen:p=!1}){const h=o.useRef(null),[i,{close:S,toggle:y}]=$(p),g=o.useMemo(()=>t.find(v=>v.value===c),[t,c]);return P(O,{style:q.container,children:[n(ie,{label:a,onPress:y,ref:h,onPressRemove:u,isActive:i,value:g==null?void 0:g.label}),n(U,{role:"listbox",matchReferenceWidth:!1,onDismiss:S,referenceRef:h,returnFocus:!1,visible:i,children:n(O,{style:q.dropdown,children:n(ve,{role:"list",data:t,contentContainerStyle:q.content,keyExtractor:(v,l)=>`filter-item-${l}`,renderItem:({item:v})=>{const l=c===v.value;return P(ae,{role:"radio","aria-checked":l,style:({hovered:b})=>[q.radio,b&&q.itemHovered],onPress:()=>{s(v.value),S()},children:[n(Le,{value:l}),n(B,{width:12}),n(N,{children:v.label})]})}})})})]})}function Ye({label:a,items:t,checkAllLabel:c,value:s,onValueChange:u,applyButtonLabel:p,onPressRemove:h,autoOpen:i=!1}){const S=o.useRef(null),[y,{close:g,toggle:v}]=$(i),[l,b]=o.useState(s),k=o.useMemo(()=>new Set(l),[l]),I=o.useMemo(()=>t.filter(w=>k.has(w.value)),[t,k]),C=c!=null&&k.size===t.length,m=o.useMemo(()=>{if(c==null)return t;const w=k.size===0?!1:k.size===t.length?!0:"mixed";return[{label:c,checked:w},...t]},[t,c,k]),E=o.useCallback(()=>{u(l),g()},[u,l,g]);return o.useEffect(()=>{y||b(s)},[y,s]),P(O,{style:q.container,children:[n(ie,{label:a,onPress:v,ref:S,onPressRemove:h,isActive:y,value:C?c:I.map(w=>w.label).join(", ")}),n(U,{role:"listbox",matchReferenceWidth:!1,onDismiss:g,referenceRef:S,returnFocus:!1,visible:y,children:P(O,{style:q.dropdown,children:[n(ve,{role:"list",data:m,contentContainerStyle:q.content,keyExtractor:(w,x)=>`filter-item-${x}`,renderItem:({item:w})=>{const x=se(w).with({checked:X.any},({checked:F})=>F).with({value:X.any},({value:F})=>k.has(F)).exhaustive(),V=se(w).with({checked:X.any},({checked:F})=>()=>{b(F===!0?void 0:t.map(K=>K.value))}).with({value:X.any},({value:F})=>()=>{const K=new Set([...k]);x===!0?K.delete(F):K.add(F),K.size===0?b(void 0):b([...K])}).exhaustive();return P(ae,{role:"radio","aria-checked":x,style:({hovered:F})=>[q.radio,F&&q.itemHovered],onPress:V,children:[n(je,{value:x}),n(B,{width:12}),n(N,{children:w.label})]})}}),n(B,{height:8}),n(O,{style:q.buttonContainer,children:n(ne,{color:"current",onPress:E,children:p})}),n(B,{height:24})]})})]})}function Je({label:a,initialValue:t,noValueText:c,submitText:s,dateFormat:u,rifmProps:p,validate:h,onSave:i,onPressRemove:S,autoOpen:y=!1}){const g=o.useRef(null),[v,{close:l,toggle:b}]=$(y),{Field:k,submitForm:I,setFieldValue:C}=Ke({date:{initialValue:ue(t)?Z(t).format(u):"",validate:h}});o.useEffect(()=>{C("date",ue(t)?Z(t).format(u):"")},[t,u,C]);const m=()=>{I(E=>{if(Te(E,["date"])){const w=Z(E.date,u,!0).toJSON();i(w),l()}})};return P(O,{style:q.container,children:[n(ie,{label:a,onPress:b,ref:g,onPressRemove:S,isActive:v,value:ue(t)?Z(t).format(u):c}),n(U,{role:"listbox",matchReferenceWidth:!1,onDismiss:l,referenceRef:g,returnFocus:!1,visible:v,children:P(O,{style:[q.dropdown,q.inputContent],children:[n(k,{name:"date",children:({value:E,onChange:w,error:x})=>n(De,{value:E,onChange:w,...p,children:({value:V,onChange:F})=>n(Re,{label:a,render:K=>n(Ee,{nativeID:K,error:x,style:q.input,placeholder:u,value:V,onChange:F})})})}),n(ne,{color:"current",size:"small",onPress:m,children:s})]})})]})}function Qe({label:a,initialValue:t="",noValueText:c,submitText:s,autoOpen:u=!1,placeholder:p,validate:h,onSave:i,onPressRemove:S}){const y=o.useRef(null),[g,{close:v,toggle:l}]=$(u),[b,k]=o.useState(t),{Field:I,submitForm:C}=Ke({input:{initialValue:t,validate:h}}),m=()=>{C(E=>{Te(E,["input"])&&(k(E.input),i(E.input),v())})};return P(O,{style:q.container,children:[n(ie,{label:a,onPress:l,ref:y,onPressRemove:S,isActive:g,value:b===""?c:b}),n(U,{role:"listbox",matchReferenceWidth:!1,onDismiss:v,referenceRef:y,returnFocus:!1,visible:g,children:P(O,{style:[q.dropdown,q.inputContent],children:[n(I,{name:"input",children:({error:E,value:w,onChange:x})=>n(Re,{label:a,render:V=>n(Ee,{nativeID:V,error:E,style:q.input,placeholder:p,value:w,onChangeText:x})})}),n(ne,{size:"small",color:"current",onPress:m,children:s})]})})]})}function Ge({children:a,onAdd:t,onPressRemove:c}){return o.useEffect(t,[]),n(Ce,{color:"current",onPressRemove:c,children:a})}const ee=(a,t,c)=>t[c],de=({filters:a,openedFilters:t,definition:c,onChangeOpened:s,onChangeFilters:u})=>{const p=Be(t),h=t.length>p.length?t[t.length-1]:void 0;return t.length===0?null:n(ce,{direction:"row",wrap:!0,children:t.map(i=>{const S=c[i];return typeof i!="string"||S==null?null:n(O,{children:se(S).with({type:"radio"},({type:y,label:g,items:v})=>n(Ue,{label:g,items:v,autoOpen:h===i,onPressRemove:()=>{u({...a,[i]:void 0}),s(t.filter(l=>l!==i))},value:ee(y,a,i),onValueChange:l=>u({...a,[i]:l})})).with({type:"checkbox"},({type:y,label:g,items:v,checkAllLabel:l,submitText:b})=>n(Ye,{label:g,items:v,checkAllLabel:l,autoOpen:h===i,applyButtonLabel:b,value:ee(y,a,i),onValueChange:k=>u({...a,[i]:k}),onPressRemove:()=>{u({...a,[i]:void 0}),s(t.filter(k=>k!==i))}})).with({type:"date"},({type:y,label:g,noValueText:v,submitText:l,dateFormat:b,rifmProps:k,validate:I})=>n(Je,{label:g,noValueText:v,submitText:l,autoOpen:h===i,dateFormat:b,rifmProps:k,validate:I,initialValue:ee(y,a,i),onSave:C=>u({...a,[i]:C}),onPressRemove:()=>{u({...a,[i]:void 0}),s(t.filter(C=>C!==i))}})).with({type:"input"},({type:y,label:g,placeholder:v,noValueText:l,submitText:b,validate:k})=>n(Qe,{label:g,placeholder:v,noValueText:l,submitText:b,autoOpen:h===i,validate:k,initialValue:ee(y,a,i),onSave:I=>u({...a,[i]:I}),onPressRemove:()=>{u({...a,[i]:void 0}),s(t.filter(I=>I!==i))}})).with({type:"boolean"},({label:y})=>n(Ge,{onAdd:()=>{u({...a,[i]:!0})},onPressRemove:()=>{u({...a,[i]:void 0}),s(t.filter(g=>g!==i))},children:y})).exhaustive()},i)})})};try{de.displayName="FiltersStack",de.__docgenInfo={description:"",displayName:"FiltersStack",props:{definition:{defaultValue:null,description:"",name:"definition",required:!0,type:{name:"FiltersDefinition"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"{ [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }"}},openedFilters:{defaultValue:null,description:"",name:"openedFilters",required:!0,type:{name:"(keyof T)[]"}},onChangeOpened:{defaultValue:null,description:"",name:"onChangeOpened",required:!0,type:{name:"(value: (keyof T)[]) => void"}},onChangeFilters:{defaultValue:null,description:"",name:"onChangeFilters",required:!0,type:{name:"(value: { [KeyType in keyof { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<T[K]>[KeyType]; }; }]: { [K in keyof T]: { [KeyType in keyof ExtractFilterValue<T[K]>]: ExtractFilterValue<...>[KeyType]; }; }[KeyType]; }) => void"}}}}}catch{}const Xe=Ae({accept:"numeric",charMap:{2:"/",4:"/"},maxLength:8}),Ze={type:"radio",label:"Mode",items:[{label:"QES",value:"QES"},{label:"Expert",value:"Expert"}]},et={type:"checkbox",label:"Status",submitText:"Apply",items:[{label:"Accepted",value:"Accepted"},{label:"Canceled",value:"Canceled"},{label:"Failed",value:"Failed"},{label:"Expired",value:"Expired"},{label:"CustomerRefused",value:"CustomerRefused"}]},tt={type:"date",label:"Start Date",submitText:"Save",noValueText:"None",dateFormat:"DD/MM/YYYY",rifmProps:Xe},rt={type:"input",label:"Resource ID",noValueText:"None",submitText:"Save",placeholder:"Placeholder..."},nt={mode:Ze,status:et,startDate:tt,resourceId:rt},at=[{name:"mode",label:"Mode"},{name:"status",label:"Status"},{name:"startDate",label:"Start date"},{name:"resourceId",label:"Ressource ID"}],$t={title:"Forms/Filter",component:re},te=()=>{const[a,t]=o.useState([]),[c,s]=o.useState({mode:void 0,status:void 0,resourceId:void 0,startDate:void 0});return n(We,{title:"Filter",children:n(Me,{variant:"live",children:P(O,{children:[n(re,{filters:c,label:"Choose filters",title:"Filters",onAddFilter:u=>t(p=>[...p,u]),availableFilters:at,openFilters:a}),n(B,{height:8}),n(de,{definition:nt,filters:c,openedFilters:a,onChangeFilters:s,onChangeOpened:t})]})})})};var xe,Ve,Se;te.parameters={...te.parameters,docs:{...(xe=te.parameters)==null?void 0:xe.docs,source:{originalSource:`() => {
  const [openFilters, setOpenFilters] = useState<(keyof State)[]>([]);
  const [filters, setFilters] = useState<State>({
    mode: undefined,
    status: undefined,
    resourceId: undefined,
    startDate: undefined
  });
  return <StoryBlock title="Filter">
      <WithCurrentColor variant="live">
        <View>
          <FilterChooser filters={filters} label="Choose filters" title="Filters" onAddFilter={filter => setOpenFilters(filters => [...filters, filter])} availableFilters={availableFilters} openFilters={openFilters} />

          <Space height={8} />

          <FiltersStack definition={definition} filters={filters} openedFilters={openFilters} onChangeFilters={setFilters} onChangeOpened={setOpenFilters} />
        </View>
      </WithCurrentColor>
    </StoryBlock>;
}`,...(Se=(Ve=te.parameters)==null?void 0:Ve.docs)==null?void 0:Se.source}}};const Ut=["All"];export{te as All,Ut as __namedExportsOrder,$t as default};
//# sourceMappingURL=Filter.stories-0ab1ce4f.js.map
