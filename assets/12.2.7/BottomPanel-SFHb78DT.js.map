{"version":3,"file":"BottomPanel-SFHb78DT.js","sources":["../../../packages/lake/src/components/BottomPanel.tsx"],"sourcesContent":["import { ReactNode, useEffect, useRef, useState } from \"react\";\nimport { Pressable, StyleSheet, View } from \"react-native\";\nimport { commonStyles } from \"../constants/commonStyles\";\nimport { backgroundColor, radii, shadows } from \"../constants/design\";\nimport { useBodyClassName } from \"../hooks/useBodyClassName\";\nimport { FocusTrap } from \"./FocusTrap\";\nimport { LoadingView } from \"./LoadingView\";\nimport { Portal } from \"./Portal\";\nimport { ScrollView } from \"./ScrollView\";\nimport { Suspendable } from \"./Suspendable\";\nimport { TransitionView } from \"./TransitionView\";\n\nconst BACKGROUND_COLOR = \"rgba(0, 0, 0, 0.6)\";\n\nconst styles = StyleSheet.create({\n  fill: {\n    ...StyleSheet.absoluteFillObject,\n    position: \"absolute\",\n    animationFillMode: \"forwards\",\n    visibility: \"visible\",\n  },\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: BACKGROUND_COLOR,\n  },\n  overlayEnter: {\n    animationKeyframes: {\n      \"0%\": { opacity: 0 },\n    },\n    animationDuration: \"200ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  overlayLeave: {\n    animationKeyframes: {\n      \"100%\": { opacity: 0 },\n    },\n    animationDuration: \"200ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  modalEnter: {\n    animationKeyframes: {\n      \"0%\": {\n        opacity: 0,\n        transform: \"translateY(20px)\",\n      },\n    },\n    animationDuration: \"300ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  modalLeave: {\n    animationKeyframes: {\n      \"100%\": {\n        opacity: 0,\n        transform: \"translateY(20px)\",\n      },\n    },\n    animationDuration: \"300ms\",\n    animationTimingFunction: \"ease-in-out\",\n  },\n  container: {\n    ...StyleSheet.absoluteFillObject,\n    transitionDuration: \"300ms\",\n    transitionProperty: \"transform\",\n  },\n  modalContainer: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  modalContentContainer: {\n    justifyContent: \"flex-end\",\n    flexGrow: 1,\n  },\n  trap: {\n    ...commonStyles.fill,\n  },\n  modal: {\n    backgroundColor: backgroundColor.accented,\n    borderTopLeftRadius: radii[8],\n    borderTopRightRadius: radii[8],\n    boxShadow: shadows.modal,\n    alignSelf: \"stretch\",\n  },\n  pressableOverlay: {\n    ...commonStyles.fill,\n    outlineWidth: 0,\n    // make focus indicator invisible on iOS (outline: none doesn't work)\n    opacity: 0,\n    order: -1,\n  },\n});\n\ntype Props = {\n  visible: boolean;\n  onPressClose: () => void;\n  children: ReactNode;\n  returnFocus?: boolean;\n};\n\nexport const BottomPanel = ({ visible, onPressClose, children, returnFocus = true }: Props) => {\n  const [rootElement, setRootElement] = useState<Element | undefined>(() => undefined);\n  const container = useRef<View>(null);\n\n  useEffect(() => {\n    const rootElement = document.createElement(\"div\");\n    document.body.append(rootElement);\n    setRootElement(rootElement);\n    return () => {\n      rootElement.remove();\n      setRootElement(undefined);\n    };\n  }, []);\n\n  useBodyClassName(\"BottomPanelOpen\", { enabled: visible });\n\n  if (rootElement == null) {\n    return null;\n  }\n\n  return (\n    <Portal container={rootElement}>\n      <TransitionView style={styles.fill} enter={styles.overlayEnter} leave={styles.overlayLeave}>\n        {visible ? <View style={styles.overlay} /> : null}\n      </TransitionView>\n\n      <Suspendable fallback={<LoadingView color={backgroundColor.accented} delay={0} />}>\n        <TransitionView style={styles.fill} enter={styles.modalEnter} leave={styles.modalLeave}>\n          {visible ? (\n            <View ref={container} style={styles.container}>\n              <ScrollView\n                style={styles.modalContainer}\n                contentContainerStyle={styles.modalContentContainer}\n              >\n                <FocusTrap\n                  autoFocus={true}\n                  focusLock={true}\n                  returnFocus={returnFocus}\n                  onEscapeKey={() => {\n                    if (onPressClose != null) {\n                      onPressClose();\n                    }\n                  }}\n                  style={styles.trap}\n                >\n                  <View style={styles.modal}>{children}</View>\n\n                  {onPressClose != null ? (\n                    <Pressable onPress={onPressClose} style={styles.pressableOverlay} />\n                  ) : null}\n                </FocusTrap>\n              </ScrollView>\n            </View>\n          ) : null}\n        </TransitionView>\n      </Suspendable>\n    </Portal>\n  );\n};\n"],"names":["BACKGROUND_COLOR","styles","StyleSheet","commonStyles","backgroundColor","radii","shadows","BottomPanel","visible","onPressClose","children","returnFocus","rootElement","setRootElement","useState","container","useRef","useEffect","useBodyClassName","jsxs","Portal","jsx","TransitionView","View","Suspendable","LoadingView","ScrollView","FocusTrap","Pressable"],"mappings":"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"}