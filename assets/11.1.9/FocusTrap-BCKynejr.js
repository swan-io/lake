import{j as S}from"./jsx-runtime-BlAj40OV.js";import{r as e}from"./index-Cs7sjTYM.js";import{i as v,h as x,z as q,V as j}from"./ScrollView-B3jDVNB7.js";import{f as T,l as C}from"./array-BfAlyugE.js";const M=(t,n)=>{const a=e.useRef(t);e.useEffect(()=>{a.current=t},[t]),e.useEffect(()=>{const o=window.setInterval(()=>a.current(o),n);return()=>window.clearInterval(o)},[n])},V=({containerRef:t,onClickOutside:n,onFocusOutside:a})=>{const o=e.useRef(!1),i=e.useCallback(s=>{const u=s.target;return v(t.current)&&t.current instanceof HTMLElement&&t.current.contains(u)},[t]);e.useEffect(()=>{if(x(n))return;const s=c=>{i(c)||(o.current=!0)},u=c=>{!i(c)&&o.current&&(n==null||n(c)),o.current=!1};return document.addEventListener("mousedown",s,!0),document.addEventListener("mouseup",u,!0),document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",u,!0),()=>{document.removeEventListener("mousedown",s,!0),document.removeEventListener("mouseup",u,!0),document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",u,!0)}},[i,n]),e.useEffect(()=>{if(x(a))return;const s=u=>{i(u)||a==null||a(u)};return document.addEventListener("focusin",s,!0),()=>{document.removeEventListener("focusin",s,!0)}},[i,a])},L=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'].join(", "),g=(t=document.documentElement,n=!0)=>(n&&t.matches(L)?[t]:[]).concat(Array.from(t.querySelectorAll(L)));let E=0;const A=e.forwardRef(({children:t,focusLock:n,onClickOutside:a,onEscapeKey:o,returnFocus:i,style:s,autoFocus:u},c)=>{const f=e.useRef(null),h=e.useRef(null),y=e.useRef(!1);e.useImperativeHandle(c,()=>({setInitiallyFocusedElement:r=>h.current=r}));const[w]=e.useState(E);e.useEffect(()=>(++E,()=>{--E}));const I=e.useCallback(({nativeEvent:r})=>{q(r.key).with("Escape",()=>{E===w+1&&(o==null||o())}).with("Tab",()=>{if(!n)return;const d=f.current;if(v(d)){const m=r.target,l=g(d),p=T(l),b=C(l);m===p&&r.shiftKey&&(r.preventDefault(),b==null||b.focus()),m===b&&!r.shiftKey&&(r.preventDefault(),p==null||p.focus())}}).otherwise(()=>{})},[n,o,w]);e.useEffect(()=>{if(i)return h.current=document.activeElement,()=>{var r;y.current||(r=h.current)==null||r.focus()}},[i]),M(r=>{if(u){const d=f.current;if(v(d)){if(d.offsetWidth===0)return;const m=g(d),l=T(m);l==null||l.focus(),window.clearInterval(r)}}},16);const R=e.useCallback(()=>{y.current=!0},[]);return V({containerRef:f,onClickOutside:a,onFocusOutside:R}),S.jsx(j,{ref:f,onKeyDownCapture:I,style:s,children:t})});A.__docgenInfo={description:"",methods:[{name:"setInitiallyFocusedElement",docblock:null,modifiers:[],params:[{name:"element",optional:!1,type:null}],returns:null}],displayName:"FocusTrap",props:{autoFocus:{required:!0,tsType:{name:"boolean"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},focusLock:{required:!0,tsType:{name:"boolean"},description:""},onClickOutside:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: TouchEvent | MouseEvent) => void",signature:{arguments:[{type:{name:"union",raw:"TouchEvent | MouseEvent",elements:[{name:"TouchEvent"},{name:"MouseEvent"}]},name:"event"}],return:{name:"void"}}},description:""},onEscapeKey:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},returnFocus:{required:!0,tsType:{name:"boolean"},description:""},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""}}};export{A as F,g};
//# sourceMappingURL=FocusTrap-BCKynejr.js.map
