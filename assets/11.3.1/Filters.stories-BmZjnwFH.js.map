{"version":3,"file":"Filters.stories-BmZjnwFH.js","sources":["../../../packages/lake/src/components/FilterChooser.tsx","../../../packages/shared-business/src/components/Filters.tsx","../../../packages/shared-business/__stories__/Filters.stories.tsx"],"sourcesContent":["import { useRef } from \"react\";\nimport { Pressable, StyleSheet, View } from \"react-native\";\nimport { colors } from \"../constants/design\";\nimport { useDisclosure } from \"../hooks/useDisclosure\";\nimport { isNotNullishOrEmpty } from \"../utils/nullish\";\nimport { Box } from \"./Box\";\nimport { FlatList } from \"./FlatList\";\nimport { Icon } from \"./Icon\";\nimport { LakeButton } from \"./LakeButton\";\nimport { LakeText } from \"./LakeText\";\nimport { Popover } from \"./Popover\";\nimport { Space } from \"./Space\";\n\nconst styles = StyleSheet.create({\n  selected: {\n    color: colors.gray[500],\n  },\n  list: {\n    paddingVertical: 20,\n    marginVertical: 4,\n    minWidth: 250,\n    overflow: \"hidden\",\n  },\n  item: {\n    display: \"flex\",\n    paddingHorizontal: 24,\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingVertical: 8,\n  },\n  itemHovered: {\n    backgroundColor: colors.gray[50],\n  },\n  availableFiltersTitle: {\n    paddingHorizontal: 24,\n  },\n});\n\nexport function FilterChooser<FilterName extends string>({\n  filters,\n  openFilters,\n  label,\n  title,\n  availableFilters,\n  large = true,\n  onAddFilter,\n}: {\n  filters: Partial<Record<FilterName, unknown>>;\n  openFilters: FilterName[];\n  label: string;\n  title?: string;\n  availableFilters: { label: string; name: FilterName }[];\n  large?: boolean;\n  onAddFilter: (filterName: FilterName) => void;\n}) {\n  const inputRef = useRef<View>(null);\n  const [visible, { close, toggle }] = useDisclosure(false);\n\n  return (\n    <>\n      <Box direction=\"row\" justifyContent=\"start\" alignItems=\"center\">\n        <LakeButton\n          size=\"small\"\n          mode=\"secondary\"\n          color=\"gray\"\n          onPress={toggle}\n          ref={inputRef}\n          icon={large ? \"chevron-down-filled\" : \"filter-filled\"}\n          iconPosition=\"end\"\n          ariaLabel={label}\n        >\n          {large ? label : null}\n        </LakeButton>\n      </Box>\n\n      <Popover\n        role=\"listbox\"\n        matchReferenceMinWidth={true}\n        onDismiss={close}\n        referenceRef={inputRef}\n        returnFocus={false}\n        visible={visible}\n      >\n        <View style={styles.list}>\n          {isNotNullishOrEmpty(title) ? (\n            <>\n              <LakeText style={styles.availableFiltersTitle}>{title}</LakeText>\n              <Space height={8} />\n            </>\n          ) : null}\n\n          <FlatList\n            role=\"list\"\n            data={availableFilters}\n            keyExtractor={(_, index) => `filter-item-${index}`}\n            renderItem={({ item }) => {\n              const isSet = Boolean(filters[item.name]) || openFilters.includes(item.name);\n              return (\n                <Pressable\n                  style={({ hovered }) => [styles.item, hovered && styles.itemHovered]}\n                  role=\"button\"\n                  disabled={isSet}\n                  onPress={() => {\n                    onAddFilter(item.name);\n                    close();\n                  }}\n                >\n                  <LakeText variant=\"smallRegular\" style={isSet && styles.selected}>\n                    {item.label}\n                  </LakeText>\n\n                  {isSet && <Icon color={colors.positive[500]} name=\"checkmark-filled\" size={14} />}\n                </Pressable>\n              );\n            }}\n          />\n        </View>\n      </Popover>\n    </>\n  );\n}\n","import { Box } from \"@swan-io/lake/src/components/Box\";\nimport { FlatList } from \"@swan-io/lake/src/components/FlatList\";\nimport { Icon } from \"@swan-io/lake/src/components/Icon\";\nimport { LakeCheckbox } from \"@swan-io/lake/src/components/LakeCheckbox\";\nimport { LakeLabel } from \"@swan-io/lake/src/components/LakeLabel\";\nimport { LakeRadio } from \"@swan-io/lake/src/components/LakeRadio\";\nimport { LakeTextInput } from \"@swan-io/lake/src/components/LakeTextInput\";\nimport { Popover } from \"@swan-io/lake/src/components/Popover\";\nimport { Space } from \"@swan-io/lake/src/components/Space\";\nimport { Stack } from \"@swan-io/lake/src/components/Stack\";\nimport { Tag } from \"@swan-io/lake/src/components/Tag\";\nimport { colors, shadows } from \"@swan-io/lake/src/constants/design\";\nimport { useDisclosure } from \"@swan-io/lake/src/hooks/useDisclosure\";\nimport { useMergeRefs } from \"@swan-io/lake/src/hooks/useMergeRefs\";\nimport { usePreviousValue } from \"@swan-io/lake/src/hooks/usePreviousValue\";\nimport { isNotNullish, isNullish } from \"@swan-io/lake/src/utils/nullish\";\nimport { ValidatorResult } from \"@swan-io/use-form\";\nimport dayjs from \"dayjs\";\nimport { forwardRef, useCallback, useMemo, useRef, useState } from \"react\";\nimport { Pressable, StyleSheet, Text, View } from \"react-native\";\nimport { P, match } from \"ts-pattern\";\nimport { Simplify } from \"type-fest\";\nimport { DateFormat } from \"../utils/i18n\";\nimport { DatePickerDate, DatePickerModal } from \"./DatePicker\";\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingRight: 12,\n    paddingBottom: 8,\n  },\n  shadowed: {\n    position: \"absolute\",\n    opacity: 0,\n    width: \"100%\",\n    height: \"100%\",\n    borderRadius: 4,\n    boxShadow: shadows.tile,\n    transitionDuration: \"150ms\",\n    transitionProperty: \"opacity\",\n  },\n  hovered: {\n    opacity: 1,\n  },\n  dropdown: {\n    maxHeight: 400,\n    minWidth: 200,\n  },\n  itemHovered: {\n    backgroundColor: colors.gray[50],\n  },\n  content: {\n    paddingVertical: 12,\n  },\n  inputContent: {\n    paddingHorizontal: 24,\n    paddingTop: 24,\n    paddingBottom: 16,\n  },\n  radio: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    height: 32,\n    paddingHorizontal: 24,\n  },\n  itemLabel: {\n    textOverflow: \"ellipsis\",\n    overflow: \"hidden\",\n    whiteSpace: \"nowrap\",\n  },\n  input: {\n    width: 250,\n  },\n  value: {\n    maxWidth: 130,\n    whiteSpace: \"nowrap\",\n  },\n});\n\ntype Item<T> = {\n  label: string;\n  value: T;\n};\n\ntype TagProps = {\n  isActive: boolean;\n  label: string;\n  value?: string;\n  onPress: () => void;\n  onPressRemove: () => void;\n};\n\nconst FilterTag = forwardRef<View, TagProps>(\n  ({ onPress, onPressRemove, label, value = \"\", isActive }, forwardRef) => {\n    const ref = useRef<View>(null);\n    const mergedRef = useMergeRefs(ref, forwardRef);\n\n    return (\n      <Pressable ref={mergedRef} onPress={onPress}>\n        {({ hovered }) => (\n          <>\n            <View style={[styles.shadowed, hovered && styles.hovered]} />\n\n            <Tag label={label} color=\"current\" onPressRemove={onPressRemove}>\n              <Box direction=\"row\" alignItems=\"center\">\n                <Text numberOfLines={1} style={styles.value}>\n                  {value}\n                </Text>\n\n                <Space width={4} />\n\n                <Icon\n                  color={colors.current.primary}\n                  name={isActive ? \"chevron-up-filled\" : \"chevron-down-filled\"}\n                  size={16}\n                />\n              </Box>\n            </Tag>\n          </>\n        )}\n      </Pressable>\n    );\n  },\n);\n\ntype FilterRadioProps<T> = {\n  autoOpen?: boolean;\n  items: Item<T>[];\n  width?: number;\n  label: string;\n  value: T | undefined;\n  onPressRemove: () => void;\n  onValueChange: (value: T | undefined) => void;\n};\n\nfunction FilterRadio<T>({\n  label,\n  items,\n  width,\n  value,\n  onValueChange,\n  onPressRemove,\n  autoOpen = false,\n}: FilterRadioProps<T>) {\n  const inputRef = useRef<View>(null);\n  const [visible, { close, toggle }] = useDisclosure(autoOpen);\n  const currentValue = useMemo(() => items.find(i => i.value === value), [items, value]);\n\n  return (\n    <View style={styles.container}>\n      <FilterTag\n        label={label}\n        onPress={toggle}\n        ref={inputRef}\n        onPressRemove={onPressRemove}\n        isActive={visible}\n        value={currentValue?.label}\n      />\n\n      <Popover\n        role=\"listbox\"\n        matchReferenceWidth={false}\n        onDismiss={close}\n        referenceRef={inputRef}\n        returnFocus={false}\n        visible={visible}\n      >\n        <FlatList\n          role=\"list\"\n          data={items}\n          style={[styles.dropdown, { width }]}\n          contentContainerStyle={styles.content}\n          keyExtractor={(_, index) => `filter-item-${index}`}\n          renderItem={({ item }) => {\n            const isSelected = value === item.value;\n\n            return (\n              <Pressable\n                role=\"radio\"\n                aria-checked={isSelected}\n                style={({ hovered }) => [styles.radio, hovered && styles.itemHovered]}\n                onPress={() => {\n                  onValueChange(item.value);\n                  close();\n                }}\n              >\n                <LakeRadio value={isSelected} />\n                <Space width={12} />\n                <Text style={styles.itemLabel}>{item.label}</Text>\n              </Pressable>\n            );\n          }}\n        />\n      </Popover>\n    </View>\n  );\n}\n\ntype FilterCheckboxProps<T> = {\n  label: string;\n  items: Item<T>[];\n  width?: number;\n  onValueChange: (value: T[] | undefined) => void;\n  value: T[] | undefined;\n  onPressRemove: () => void;\n  autoOpen?: boolean;\n  checkAllLabel?: string;\n};\n\ntype CheckAllItem = {\n  label: string;\n  checked: boolean | \"mixed\";\n};\n\nfunction FilterCheckbox<T>({\n  label,\n  items,\n  width,\n  checkAllLabel,\n  value,\n  onValueChange,\n  onPressRemove,\n  autoOpen = false,\n}: FilterCheckboxProps<T>) {\n  const inputRef = useRef<View>(null);\n  const [visible, { close, toggle }] = useDisclosure(autoOpen);\n\n  const valueSet = useMemo(() => new Set(value), [value]);\n\n  const currentValue = useMemo(\n    () => items.filter(item => valueSet.has(item.value)),\n    [items, valueSet],\n  );\n\n  const allChecked = checkAllLabel != null && valueSet.size === items.length;\n\n  const listItems = useMemo(() => {\n    if (checkAllLabel == null) {\n      return items;\n    }\n\n    const checked: CheckAllItem[\"checked\"] =\n      valueSet.size === 0 ? false : valueSet.size === items.length ? true : \"mixed\";\n\n    const checkAllItem: CheckAllItem = {\n      label: checkAllLabel,\n      checked,\n    };\n\n    return [checkAllItem, ...items];\n  }, [items, checkAllLabel, valueSet]);\n\n  return (\n    <View style={styles.container}>\n      <FilterTag\n        label={label}\n        onPress={toggle}\n        ref={inputRef}\n        onPressRemove={onPressRemove}\n        isActive={visible}\n        value={allChecked ? checkAllLabel : currentValue.map(item => item.label).join(\", \")}\n      />\n\n      <Popover\n        role=\"listbox\"\n        matchReferenceWidth={false}\n        onDismiss={close}\n        referenceRef={inputRef}\n        returnFocus={false}\n        visible={visible}\n      >\n        <FlatList\n          role=\"list\"\n          data={listItems}\n          style={[styles.dropdown, { width }]}\n          contentContainerStyle={styles.content}\n          keyExtractor={(_, index) => `filter-item-${index}`}\n          renderItem={({ item }) => {\n            const isSelected = match<Item<unknown> | CheckAllItem>(item)\n              .with({ checked: P.any }, ({ checked }) => checked)\n              .with({ value: P.any }, ({ value }) => valueSet.has(value as T))\n              .exhaustive();\n\n            const onPress = match<Item<unknown> | CheckAllItem>(item)\n              // Check all item\n              .with({ checked: P.any }, ({ checked }) => () => {\n                if (checked === true) {\n                  onValueChange(undefined);\n                } else {\n                  onValueChange(items.map(item => item.value));\n                }\n              })\n              // Regular item\n              .with({ value: P.any }, ({ value }) => () => {\n                const nextValues = new Set([...valueSet]);\n                if (isSelected === true) {\n                  nextValues.delete(value as T);\n                } else {\n                  nextValues.add(value as T);\n                }\n                if (nextValues.size === 0) {\n                  onValueChange(undefined);\n                } else {\n                  onValueChange([...nextValues]);\n                }\n              })\n              .exhaustive();\n\n            return (\n              <Pressable\n                role=\"radio\"\n                aria-checked={isSelected}\n                style={({ hovered }) => [styles.radio, hovered && styles.itemHovered]}\n                onPress={onPress}\n              >\n                <LakeCheckbox value={isSelected} />\n                <Space width={12} />\n                <Text style={styles.itemLabel}>{item.label}</Text>\n              </Pressable>\n            );\n          }}\n        />\n      </Popover>\n    </View>\n  );\n}\n\ntype FilterDateProps = {\n  label: string;\n  noValueText: string;\n  cancelText: string;\n  submitText: string;\n  dateFormat: DateFormat;\n  isSelectable?: (date: DatePickerDate) => boolean;\n  validate?: (value: string) => ValidatorResult;\n  initialValue?: string;\n  onValueChange: (value: string) => void;\n  onPressRemove: () => void;\n  autoOpen?: boolean;\n};\n\nfunction FilterDate({\n  label,\n  initialValue,\n  noValueText,\n  cancelText,\n  submitText,\n  dateFormat,\n  isSelectable,\n  validate,\n  onValueChange,\n  onPressRemove,\n  autoOpen = false,\n}: FilterDateProps) {\n  const inputRef = useRef<View>(null);\n  const [visible, { close, toggle }] = useDisclosure(autoOpen);\n\n  const value = useMemo(\n    () => (isNotNullish(initialValue) ? dayjs(initialValue).format(dateFormat) : \"\"),\n    [initialValue, dateFormat],\n  );\n\n  return (\n    <View style={styles.container}>\n      <FilterTag\n        label={label}\n        onPress={toggle}\n        ref={inputRef}\n        onPressRemove={onPressRemove}\n        isActive={visible}\n        value={isNotNullish(initialValue) ? dayjs(initialValue).format(dateFormat) : noValueText}\n      />\n\n      <DatePickerModal\n        visible={visible}\n        format={dateFormat}\n        firstWeekDay=\"monday\"\n        label={label}\n        cancelLabel={cancelText}\n        confirmLabel={submitText}\n        value={value}\n        isSelectable={isSelectable}\n        validate={validate}\n        onChange={value => {\n          const formattedValue = dayjs(value, dateFormat, true).toJSON();\n          onValueChange(formattedValue);\n        }}\n        onDismiss={close}\n      />\n    </View>\n  );\n}\n\ntype FilterInputProps = {\n  label: string;\n  noValueText: string;\n  validate?: (value: string) => ValidatorResult;\n  placeholder?: string;\n  initialValue?: string;\n  onValueChange: (value: string | undefined) => void;\n  onPressRemove: () => void;\n  autoOpen?: boolean;\n};\n\nfunction FilterInput({\n  label,\n  initialValue = \"\",\n  noValueText,\n  autoOpen = false,\n  placeholder,\n  validate,\n  onValueChange,\n  onPressRemove,\n}: FilterInputProps) {\n  const [visible, { close, toggle }] = useDisclosure(autoOpen);\n  const tagRef = useRef<View>(null);\n\n  const getValueState = useCallback(\n    (inputValue: string, isInitialValue: boolean) => {\n      const trimmed = inputValue.trim();\n      const error = validate?.(trimmed) ?? undefined;\n      const validValue = isNullish(error) ? trimmed : undefined;\n\n      if (!isInitialValue) {\n        onValueChange(validValue);\n      }\n\n      return {\n        inputValue,\n        validValue,\n        error: isInitialValue ? undefined : error,\n      };\n    },\n    [validate, onValueChange],\n  );\n\n  const [{ inputValue, validValue, error }, setState] = useState(() =>\n    getValueState(initialValue, true),\n  );\n\n  const onChangeText = useCallback(\n    (value: string) => setState(getValueState(value, false)),\n    [getValueState],\n  );\n\n  return (\n    <View style={styles.container}>\n      <FilterTag\n        label={label}\n        onPress={toggle}\n        ref={tagRef}\n        onPressRemove={onPressRemove}\n        isActive={visible}\n        value={validValue ?? noValueText}\n      />\n\n      <Popover\n        role=\"listbox\"\n        matchReferenceWidth={false}\n        onDismiss={close}\n        referenceRef={tagRef}\n        returnFocus={false}\n        visible={visible}\n      >\n        <View style={[styles.dropdown, styles.inputContent]}>\n          <LakeLabel\n            label={label}\n            render={id => (\n              <LakeTextInput\n                id={id}\n                value={inputValue}\n                error={error}\n                style={styles.input}\n                placeholder={placeholder}\n                onChangeText={onChangeText}\n              />\n            )}\n          />\n        </View>\n      </Popover>\n    </View>\n  );\n}\n\nexport type FilterCheckboxDef<T> = {\n  type: \"checkbox\";\n  label: string;\n  items: Item<T>[];\n  width?: number;\n  checkAllLabel?: string;\n};\n\nexport type FilterRadioDef<T> = {\n  type: \"radio\";\n  label: string;\n  items: Item<T>[];\n  width?: number;\n};\n\nexport type FilterDateDef<Values = unknown> = {\n  type: \"date\";\n  label: string;\n  cancelText: string;\n  submitText: string;\n  noValueText: string;\n  dateFormat: DateFormat;\n  isSelectable?: (date: DatePickerDate, filters: Values) => boolean;\n  validate?: (value: string, filters: Values) => ValidatorResult;\n};\n\nexport type FilterInputDef = {\n  type: \"input\";\n  label: string;\n  noValueText: string;\n  placeholder?: string;\n  validate?: (value: string) => ValidatorResult;\n};\n\ntype Filter<T> = FilterCheckboxDef<T> | FilterRadioDef<T> | FilterDateDef | FilterInputDef;\n\ntype ExtractFilterValue<T extends Filter<unknown>> = T extends { type: \"checkbox\" }\n  ? T[\"items\"][number][\"value\"][] | undefined\n  : T extends { type: \"radio\" }\n    ? T[\"items\"][number][\"value\"] | undefined\n    : T extends { type: \"boolean\" }\n      ? boolean | undefined\n      : string | undefined;\n\nconst getFilterValue = <T extends Filter<unknown>[\"type\"]>(\n  _type: T,\n  filters: FiltersState<FiltersDefinition>,\n  name: string,\n) => filters[name] as ExtractFilterValue<Extract<Filter<unknown>, { type: T }>>;\n\ntype FiltersDefinition = Record<string, Filter<unknown>>;\n\nexport type FiltersState<T extends FiltersDefinition> = Simplify<{\n  [K in keyof T]: Simplify<ExtractFilterValue<T[K]>>;\n}>;\n\ntype FiltersStackProps<\n  Definition extends FiltersDefinition,\n  State extends FiltersState<Definition> = FiltersState<Definition>,\n> = {\n  definition: Definition;\n  filters: State;\n  openedFilters: (keyof Definition)[];\n  onChangeOpened: (value: (keyof Definition)[]) => void;\n  onChangeFilters: (value: State) => void;\n};\n\nexport const FiltersStack = <T extends FiltersDefinition>({\n  filters,\n  openedFilters,\n  definition,\n  onChangeOpened,\n  onChangeFilters,\n}: FiltersStackProps<T>) => {\n  const previousOpened = usePreviousValue(openedFilters);\n  const lastOpenedFilter =\n    openedFilters.length > previousOpened.length\n      ? openedFilters[openedFilters.length - 1]\n      : undefined;\n\n  if (openedFilters.length === 0) {\n    return null;\n  }\n\n  return (\n    <Stack direction=\"row\" wrap=\"wrap\">\n      {openedFilters.map(filterName => {\n        const filterDefinition = definition[filterName];\n\n        if (typeof filterName !== \"string\" || filterDefinition == null) {\n          return null;\n        }\n\n        return (\n          <View key={filterName}>\n            {match<Filter<unknown>>(filterDefinition)\n              .with({ type: \"radio\" }, ({ type, label, items, width }) => (\n                <FilterRadio\n                  label={label}\n                  items={items}\n                  width={width}\n                  autoOpen={lastOpenedFilter === filterName}\n                  onPressRemove={() => {\n                    onChangeFilters({ ...filters, [filterName]: undefined });\n                    onChangeOpened(openedFilters.filter(f => f !== filterName));\n                  }}\n                  value={getFilterValue(type, filters, filterName)}\n                  onValueChange={value => onChangeFilters({ ...filters, [filterName]: value })}\n                />\n              ))\n              .with({ type: \"checkbox\" }, ({ type, label, items, width, checkAllLabel }) => (\n                <FilterCheckbox\n                  label={label}\n                  items={items}\n                  width={width}\n                  checkAllLabel={checkAllLabel}\n                  autoOpen={lastOpenedFilter === filterName}\n                  value={getFilterValue(type, filters, filterName)}\n                  onValueChange={value => onChangeFilters({ ...filters, [filterName]: value })}\n                  onPressRemove={() => {\n                    onChangeFilters({ ...filters, [filterName]: undefined });\n                    onChangeOpened(openedFilters.filter(f => f !== filterName));\n                  }}\n                />\n              ))\n              .with(\n                { type: \"date\" },\n                ({\n                  type,\n                  label,\n                  noValueText,\n                  cancelText,\n                  submitText,\n                  dateFormat,\n                  isSelectable,\n                  validate,\n                }) => (\n                  <FilterDate\n                    label={label}\n                    noValueText={noValueText}\n                    cancelText={cancelText}\n                    submitText={submitText}\n                    dateFormat={dateFormat}\n                    autoOpen={lastOpenedFilter === filterName}\n                    isSelectable={isSelectable ? date => isSelectable(date, filters) : undefined}\n                    validate={validate ? value => validate(value, filters) : undefined}\n                    initialValue={getFilterValue(type, filters, filterName)}\n                    onValueChange={value => onChangeFilters({ ...filters, [filterName]: value })}\n                    onPressRemove={() => {\n                      onChangeFilters({ ...filters, [filterName]: undefined });\n                      onChangeOpened(openedFilters.filter(f => f !== filterName));\n                    }}\n                  />\n                ),\n              )\n              .with({ type: \"input\" }, ({ type, label, placeholder, noValueText, validate }) => (\n                <FilterInput\n                  label={label}\n                  placeholder={placeholder}\n                  noValueText={noValueText}\n                  autoOpen={lastOpenedFilter === filterName}\n                  validate={validate}\n                  initialValue={getFilterValue(type, filters, filterName)}\n                  onValueChange={value => onChangeFilters({ ...filters, [filterName]: value })}\n                  onPressRemove={() => {\n                    onChangeFilters({ ...filters, [filterName]: undefined });\n                    onChangeOpened(openedFilters.filter(f => f !== filterName));\n                  }}\n                />\n              ))\n              .exhaustive()}\n          </View>\n        );\n      })}\n    </Stack>\n  );\n};\n","import { Meta } from \"@storybook/react\";\nimport { FilterChooser } from \"@swan-io/lake/src/components/FilterChooser\";\nimport { Space } from \"@swan-io/lake/src/components/Space\";\nimport { WithCurrentColor } from \"@swan-io/lake/src/components/WithCurrentColor\";\nimport { useState } from \"react\";\nimport { View } from \"react-native\";\nimport {\n  FilterCheckboxDef,\n  FilterDateDef,\n  FilterInputDef,\n  FilterRadioDef,\n  FiltersStack,\n  FiltersState,\n} from \"../src/components/Filters\";\nimport { StoryBlock } from \"./_StoriesComponents\";\n\nconst mode: FilterRadioDef<\"QES\" | \"Expert\"> = {\n  type: \"radio\",\n  label: \"Mode\",\n  items: [\n    { label: \"QES\", value: \"QES\" },\n    { label: \"Expert\", value: \"Expert\" },\n  ],\n};\n\nconst status: FilterCheckboxDef<\n  \"Accepted\" | \"Canceled\" | \"Failed\" | \"Expired\" | \"CustomerRefused\"\n> = {\n  type: \"checkbox\",\n  label: \"Status\",\n  checkAllLabel: \"All\",\n  items: [\n    { label: \"Accepted\", value: \"Accepted\" },\n    { label: \"Canceled\", value: \"Canceled\" },\n    { label: \"Failed\", value: \"Failed\" },\n    { label: \"Expired\", value: \"Expired\" },\n    { label: \"CustomerRefused\", value: \"CustomerRefused\" },\n  ],\n};\n\nconst startDate: FilterDateDef = {\n  type: \"date\",\n  label: \"Start Date\",\n  cancelText: \"Cancel\",\n  submitText: \"Save\",\n  noValueText: \"None\",\n  dateFormat: \"DD/MM/YYYY\",\n};\n\nconst resourceId: FilterInputDef = {\n  type: \"input\",\n  label: \"Resource ID\",\n  noValueText: \"None\",\n  placeholder: \"Placeholder...\",\n  validate: value => {\n    if (value.length < 3) {\n      return \"Not long enough\";\n    }\n  },\n};\n\nconst definition = {\n  mode,\n  status,\n  startDate,\n  resourceId,\n};\n\ntype State = FiltersState<typeof definition>;\n\nconst availableFilters: { name: keyof State; label: string }[] = [\n  {\n    name: \"mode\",\n    label: \"Mode\",\n  },\n  {\n    name: \"status\",\n    label: \"Status\",\n  },\n  {\n    name: \"startDate\",\n    label: \"Start date\",\n  },\n  {\n    name: \"resourceId\",\n    label: \"Ressource ID\",\n  },\n];\n\nexport default {\n  title: \"Forms/Filters\",\n  component: FilterChooser,\n} as Meta<typeof FilterChooser>;\n\nexport const All = () => {\n  const [openFilters, setOpenFilters] = useState<(keyof State)[]>([]);\n\n  const [filters, setFilters] = useState<State>({\n    mode: undefined,\n    status: undefined,\n    resourceId: undefined,\n    startDate: undefined,\n  });\n\n  return (\n    <StoryBlock title=\"Filters\">\n      <WithCurrentColor variant=\"live\">\n        <View>\n          <FilterChooser\n            filters={filters}\n            label=\"Choose filters\"\n            title=\"Filters\"\n            onAddFilter={filter => setOpenFilters(filters => [...filters, filter])}\n            availableFilters={availableFilters}\n            openFilters={openFilters}\n          />\n\n          <Space height={8} />\n\n          <FiltersStack\n            definition={definition}\n            filters={filters}\n            openedFilters={openFilters}\n            onChangeFilters={setFilters}\n            onChangeOpened={setOpenFilters}\n          />\n        </View>\n      </WithCurrentColor>\n    </StoryBlock>\n  );\n};\n"],"names":["styles","StyleSheet","colors","FilterChooser","filters","openFilters","label","title","availableFilters","large","onAddFilter","inputRef","useRef","visible","close","toggle","useDisclosure","jsxs","Fragment","jsx","Box","LakeButton","Popover","View","isNotNullishOrEmpty","LakeText","Space","FlatList","_","index","item","isSet","Pressable","hovered","Icon","shadows","FilterTag","forwardRef","onPress","onPressRemove","value","isActive","ref","mergedRef","useMergeRefs","Tag","Text","FilterRadio","items","width","onValueChange","autoOpen","currentValue","useMemo","i","isSelected","LakeRadio","FilterCheckbox","checkAllLabel","valueSet","allChecked","listItems","checked","match","P","nextValues","LakeCheckbox","FilterDate","initialValue","noValueText","cancelText","submitText","dateFormat","isSelectable","validate","isNotNullish","dayjs","DatePickerModal","formattedValue","FilterInput","placeholder","tagRef","getValueState","useCallback","inputValue","isInitialValue","trimmed","error","validValue","isNullish","setState","useState","onChangeText","LakeLabel","id","LakeTextInput","getFilterValue","_type","name","FiltersStack","openedFilters","definition","onChangeOpened","onChangeFilters","previousOpened","usePreviousValue","lastOpenedFilter","Stack","filterName","filterDefinition","type","f","date","mode","status","startDate","resourceId","length","Filters_stories","component","All","setOpenFilters","setFilters","undefined","StoryBlock","WithCurrentColor","filter"],"mappings":"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"}