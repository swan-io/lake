import{s as G,c as s,t as L,j as e,L as be,S as M,F as xe,V as B,d as Z,r as Se,g as ee,i as $,E as Te,R as je,G as te,B as _,I as H,h as we,T as D}from"./Space-vOSkumTC.js";import{r as a}from"./index-uCp2LrAq.js";import{u as ve}from"./useBoolean-DklP6dZn.js";import{u as Ie}from"./useDisclosure-X_l1NENI.js";import{g as Ce}from"./array-rjEBP2Ry.js";import{s as Pe}from"./string-Co4sLf9O.js";import{P as Le,F as ke}from"./Popover-DL-rmZPP.js";import{T as Ve,a as Ee}from"./Pressable-C1mxBRS_.js";import{T as re}from"./Tag-C5yEGnhi.js";import{M as K}from"./index-ByctqrIc.js";import{S as ue,a as k}from"./_StoriesComponents-jOR6vAMI.js";import"./extends-CF3RwP-h.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BOkhicXD.js";import"./useResponsive-CWYKQO6x.js";import"./function-De4Cecxu.js";import"./BottomPanel-CQMdPCyR.js";import"./commonStyles-t4XfA7cz.js";import"./useBodyClassName-CiTylq2A.js";import"./FocusTrap-BMYOn2gx.js";import"./a11y-DXvpDVrG.js";import"./Suspendable-DAkP2ur3.js";import"./index-B_CfE0f5.js";import"./TransitionView-jc08-ng2.js";const Me=G.create({base:{color:s.negative[500],lineHeight:L.h1.lineHeight,minHeight:32,paddingHorizontal:3,paddingVertical:4}}),de=({message:r="",style:i})=>r!==""?e.jsx(be,{variant:"smallRegular",style:[Me.base,i],children:r}):e.jsx(M,{height:32});de.__docgenInfo={description:"",methods:[],displayName:"InputError",props:{message:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"TextStyle"}],raw:"StyleProp<TextStyle>"},description:""}}};const qe=G.create({scrollTracker:{position:"absolute",pointerEvents:"none",bottom:0,left:0,right:0}}),Re=({ItemSeparatorComponent:r,ListEmptyComponent:i,ListFooterComponent:p,ListHeaderComponent:b,contentContainerStyle:j,horizontal:d=!1,keyExtractor:c,onEndReached:u,onEndReachedThresholdPx:w=200,onKeyDown:v,onScroll:x,renderItem:n,renderSectionHeader:m,role:f,scrollEventThrottle:N=0,sections:I,showsScrollIndicators:C=!0,style:P},E)=>{const F=a.useId(),g=a.useRef(null);return a.useEffect(()=>{const y=g.current;if(y!=null){const S=new IntersectionObserver(T=>{T.forEach(z=>{z.isIntersecting&&(u==null||u())})});return S.observe(y),()=>{S.unobserve(y)}}},[I.length]),e.jsxs(xe,{contentContainerStyle:j,horizontal:d,onKeyDown:v,onScroll:x,ref:E,role:f,scrollEventThrottle:N,showsHorizontalScrollIndicator:C,showsVerticalScrollIndicator:C,style:P,children:[b,I.length>0?e.jsxs(B,{children:[I.map(y=>e.jsxs(a.Fragment,{children:[m==null?void 0:m(y),y.data.map((S,T)=>e.jsxs(a.Fragment,{children:[T!==0&&r,n({item:S,index:T})]},c(S,T)))]},`group-${F}-${y.title}`)),e.jsx(B,{ref:g,style:[qe.scrollTracker,{height:w}]})]}):i,p]})},pe=a.forwardRef(Re);pe.__docgenInfo={description:"",methods:[],displayName:"SectionList",props:{ItemSeparatorComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListEmptyComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},ListHeaderComponent:{required:!1,tsType:{name:"ReactNode"},description:""},contentContainerStyle:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""},horizontal:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: T, index: number) => string",signature:{arguments:[{type:{name:"T"},name:"item"},{type:{name:"number"},name:"index"}],return:{name:"string"}}},description:""},onEndReached:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEndReachedThresholdPx:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"200",computed:!1}},onKeyDown:{required:!1,tsType:{name:'ScrollViewProps["onKeyDown"]',raw:'ScrollViewProps["onKeyDown"]'},description:""},onScroll:{required:!1,tsType:{name:'ScrollViewProps["onScroll"]',raw:'ScrollViewProps["onScroll"]'},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(info: ListRenderItemInfo<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  item: T;
  index: number;
}`,signature:{properties:[{key:"item",value:{name:"T",required:!0}},{key:"index",value:{name:"number",required:!0}}]}},name:"info"}],return:{name:"ReactNode"}}},description:""},renderSectionHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(section: Section<T>) => ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}},name:"section"}],return:{name:"ReactNode"}}},description:""},role:{required:!1,tsType:{name:"WebRole"},description:""},scrollEventThrottle:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},sections:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  title: string;
  data: T[];
}`,signature:{properties:[{key:"title",value:{name:"string",required:!0}},{key:"data",value:{name:"Array",elements:[{name:"T"}],raw:"T[]",required:!0}}]}}],raw:"Section<T>[]"},description:""},showsScrollIndicators:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""}}};const Ne=120,Fe=32,_e=10.5,l=G.create({base:{...L.regular,backgroundColor:Z.accented,borderColor:s.gray[100],borderRadius:Se[6],borderWidth:1,cursor:"default",overflow:"hidden",transitionDuration:"150ms",transitionProperty:"border-color, box-shadow"},errored:{borderColor:s.negative[500]},tag:{marginRight:4,marginVertical:2},hovered:{boxShadow:ee.tile},focused:{borderColor:s.gray[500],boxShadow:ee.tile,outlineStyle:"none"},disabled:{backgroundColor:s.gray[50],borderColor:s.gray[100],cursor:"not-allowed"},actions:{marginVertical:"auto",position:"absolute",bottom:0,top:0,right:20},placeholder:{...L.regular,color:s.gray[300],userSelect:"none"},list:{marginVertical:4,maxHeight:Fe*_e,minHeight:224},filterContainer:{flexGrow:1,flexShrink:1,margin:16},filterInput:{...L.regular,backgroundColor:Z.accented,borderColor:s.gray[100],borderRadius:4,borderWidth:1,flexGrow:1,flexShrink:1,height:40,outlineStyle:"none",paddingHorizontal:12,paddingLeft:40,placeholderTextColor:s.gray[300]},filterFocused:{borderColor:s.gray[200]},searchIcon:{position:"absolute",left:14},tagsList:{flexWrap:"wrap",maxHeight:Ne,minHeight:40,overflowY:"auto",paddingHorizontal:16,paddingRight:60,paddingVertical:8},groupTitleBase:{alignItems:"center",flexDirection:"row",flexGrow:1,flexShrink:1,justifyContent:"space-between",paddingHorizontal:16,paddingVertical:12,transitionDuration:"200ms",transitionProperty:"background-color"},groupTitle:{...L.semibold,userSelect:"none"},line:{...L.regular,paddingHorizontal:16,paddingVertical:8,transitionDuration:"200ms",transitionProperty:"background-color",userSelect:"none"},lineInGroup:{paddingLeft:24},emptyList:{height:136},emptyListText:{color:s.gray.primary}}),U=a.memo(({color:r="gray",disabled:i=!1,emptyResultText:p,enableGroups:b=!0,filterPlaceholder:j,items:d,onValueChange:c,placeholder:u,renderTagGroup:w,error:v,style:x,values:n,id:m})=>{const[f,N]=a.useState(""),[I,C]=ve(!1),P=a.useRef(!1),E=a.useRef(null),F=a.useRef(null),[g,{open:y,close:S}]=Ie(!1),T=s[r][50],z=s[r][100];a.useEffect(()=>{g||N("")},[g]),a.useEffect(()=>{var t,o;if(P.current){const h=(t=E.current)==null?void 0:t.scrollHeight;(o=E.current)==null||o.scrollTo({top:h})}P.current=!1},[n]);const Y=t=>{P.current=!0,c([...n,t.value])},me=t=>{c(n.filter(o=>o!==t.value))},fe=()=>{c([])},ge=t=>{P.current=!0;const o=t.map(A=>A.value),h=[...new Set([...n,...o])];c(h)},X=a.useMemo(()=>d.reduce((t,o)=>(t[o.value]=o,t),{}),[d]),W=a.useMemo(()=>n.map(t=>X[t]).filter($),[n,X]),O=a.useMemo(()=>{const t=d.filter(h=>!n.includes(h.value)),o=f.trim().toLowerCase();return o===""?t:t.filter(({label:h})=>h.toLowerCase().includes(o))},[f,d,n]),ye=a.useMemo(()=>Te.filterMap(je.entries(Ce(O,({group:t})=>t)),([t,o])=>o===void 0?te.None():te.Some({title:t,data:o})),[O]),J=a.useMemo(()=>e.jsxs(_,{direction:"row",alignItems:"center",style:l.filterContainer,children:[e.jsx(Ve,{autoComplete:"off",inputMode:"search",multiline:!1,rows:1,onChangeText:t=>N(t),placeholder:j,value:f,onFocus:C.on,onBlur:C.off,style:[l.filterInput,I&&l.filterFocused]}),e.jsx(H,{name:"search-filled",color:s[r].primary,size:20,style:l.searchIcon})]}),[f,I,C,j,r]),Q=a.useMemo(()=>e.jsxs(_,{justifyContent:"center",alignItems:"center",style:l.emptyList,children:[e.jsx(H,{name:"clipboard-search-regular",size:24,color:s.gray.primary}),we(p)&&e.jsxs(e.Fragment,{children:[e.jsx(M,{height:8}),e.jsx(D,{style:l.emptyListText,children:p})]})]}),[p]);return e.jsxs(B,{style:x,children:[e.jsxs(K,{id:m,ref:F,"aria-haspopup":"listbox",role:"button","aria-expanded":g,disabled:i,onPress:y,style:({hovered:t,focused:o})=>[l.base,t&&l.hovered,(o||g)&&l.focused,i&&l.disabled,$(v)&&l.errored],children:[e.jsx(_,{ref:E,alignItems:"center",direction:"row",style:l.tagsList,children:W.length>0?W.map(t=>e.jsx(re,{color:r,onPressRemove:i?void 0:()=>me(t),style:l.tag,children:t.label},t.value)):u!==""?e.jsx(D,{role:"label",numberOfLines:1,style:l.placeholder,children:u}):null}),e.jsxs(_,{direction:"row",alignItems:"center",style:l.actions,children:[W.length>=1&&!i&&e.jsxs(e.Fragment,{children:[e.jsx(K,{role:"button",onPress:fe,children:e.jsx(H,{name:"dismiss-filled",color:s.gray.primary,size:15})}),e.jsx(M,{width:8})]}),e.jsx(H,{color:s.gray.primary,name:g?"chevron-up-filled":"chevron-down-filled",size:20})]})]}),e.jsx(Le,{role:"listbox",matchReferenceWidth:!0,onDismiss:S,referenceRef:F,returnFocus:!0,visible:g,children:e.jsx(B,{style:l.list,children:b?e.jsx(pe,{role:"listbox","aria-multiselectable":!0,keyExtractor:(t,o)=>`group-field-${t.value}-${o}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(M,{height:16}),sections:ye,renderSectionHeader:({title:t,data:o})=>e.jsxs(K,{role:"listitem",onPress:()=>ge(o),style:({hovered:h,pressed:A,focused:he})=>[l.groupTitleBase,(h||he)&&{backgroundColor:T},A&&{backgroundColor:z}],children:[e.jsx(D,{numberOfLines:1,style:l.groupTitle,children:t}),$(w)&&e.jsx(re,{color:r,children:w(o)})]}),renderItem:({item:t})=>e.jsx(oe,{color:r,filter:f,item:t,handleSelectItem:Y,style:l.lineInGroup})}):e.jsx(ke,{role:"list",data:O,keyExtractor:t=>`field-${t.value}`,ListHeaderComponent:J,ListEmptyComponent:Q,ListFooterComponent:e.jsx(M,{height:8}),renderItem:({item:t})=>e.jsx(oe,{color:r,filter:f,item:t,handleSelectItem:Y})})})}),e.jsx(de,{message:v})]})}),oe=({item:r,color:i,filter:p,handleSelectItem:b,style:j})=>{const{label:d,disabled:c=!1}=r,u=p.trim().toLowerCase(),w=s[i][50],v=s[i][100],x=a.useMemo(()=>c||u===""?d:Pe(d,u),[d,c,u]);return e.jsx(Ee,{role:"listitem",disabled:c,numberOfLines:1,onPress:()=>b(r),style:({hovered:n,pressed:m})=>[l.line,j,n&&{backgroundColor:w},m&&{backgroundColor:v},c&&{backgroundColor:s.gray[50],color:s.gray[100]}],children:typeof x=="string"?x:x.map((n,m)=>n.toLowerCase()===u?e.jsx(D,{style:{color:i},children:n},m):n)})};U.__docgenInfo={description:"",methods:[],displayName:"MultiSelect",props:{color:{defaultValue:{value:'"gray"',computed:!1},required:!1},disabled:{defaultValue:{value:"false",computed:!1},required:!1},enableGroups:{defaultValue:{value:"true",computed:!1},required:!1}}};const He=G.create({select:{maxWidth:400}}),ut={title:"Forms/MultiSelect",component:U},De=[{label:"Camille",value:"camille",group:"C"},{label:"Charlotte",value:"charlotte",group:"C"},{label:"Francis",value:"francis",group:"F"},{label:"Émilie",value:"emilie",group:"E"},{label:"François",value:"francois",group:"F"},{label:"Laura",value:"laura",group:"L"},{label:"Marie-Anne",value:"marie_anne",group:"M"},{label:"Natasha",value:"natasha",group:"N",disabled:!0},{label:"Nicolas",value:"nicolas",group:"N"},{label:"Pierre",value:"pierre",group:"P"}],V=({initialValues:r=[],...i})=>{const[p,b]=a.useState(r);return e.jsx(U,{placeholder:"Select people...",filterPlaceholder:"Search...",emptyResultText:"No result",values:p,items:De,onValueChange:b,style:He.select,...i})},q=()=>e.jsxs(ue,{title:"MultiSelect variations",children:[e.jsx(k,{title:"Default",children:e.jsx(V,{})}),e.jsx(k,{title:"Without groups",children:e.jsx(V,{enableGroups:!1})}),e.jsx(k,{title:"Disabled",children:e.jsx(V,{disabled:!0})}),e.jsx(k,{title:"Disabled with a value",children:e.jsx(V,{disabled:!0,initialValues:["charlotte"]})}),e.jsx(k,{title:"Without any option",children:e.jsx(V,{items:[]})})]}),R=()=>e.jsx(ue,{title:"MultiSelect colors",children:Object.keys(s).map(r=>e.jsx(k,{title:r,children:e.jsx(V,{color:r})},r))});q.__docgenInfo={description:"",methods:[],displayName:"Variations"};R.__docgenInfo={description:"",methods:[],displayName:"Colors"};var se,ae,le;q.parameters={...q.parameters,docs:{...(se=q.parameters)==null?void 0:se.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect variations">
      <StoryPart title="Default">
        <EditableMultiSelect />
      </StoryPart>

      <StoryPart title="Without groups">
        <EditableMultiSelect enableGroups={false} />
      </StoryPart>

      <StoryPart title="Disabled">
        <EditableMultiSelect disabled={true} />
      </StoryPart>

      <StoryPart title="Disabled with a value">
        <EditableMultiSelect disabled={true} initialValues={["charlotte"]} />
      </StoryPart>

      <StoryPart title="Without any option">
        <EditableMultiSelect items={[]} />
      </StoryPart>
    </StoryBlock>;
}`,...(le=(ae=q.parameters)==null?void 0:ae.docs)==null?void 0:le.source}}};var ne,ie,ce;R.parameters={...R.parameters,docs:{...(ne=R.parameters)==null?void 0:ne.docs,source:{originalSource:`() => {
  return <StoryBlock title="MultiSelect colors">
      {Object.keys(colors).map(color => <StoryPart key={color} title={color}>
          <EditableMultiSelect color={(color as ColorVariants)} />
        </StoryPart>)}
    </StoryBlock>;
}`,...(ce=(ie=R.parameters)==null?void 0:ie.docs)==null?void 0:ce.source}}};const dt=["Variations","Colors"];export{R as Colors,q as Variations,dt as __namedExportsOrder,ut as default};
//# sourceMappingURL=MultiSelect.stories-CzjUcHgv.js.map
