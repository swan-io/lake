import{s as b,b as w,c as u,d as ae,y as D,j as e,V as m,I as P,B as ie,S as le,T as ue,L as ce}from"./Space-B-tuzGSB.js";import{r as t}from"./index-CBqU2yxZ.js";import{u as de}from"./Pressable-D4CfqCYA.js";import{g as F}from"./a11y-DXvpDVrG.js";import{L as me}from"./LakeTextInput-G3Z9Wn-s.js";import{L as S}from"./Suspendable-DyQqXxP8.js";import{P as pe}from"./Popover-IY56r5AU.js";import{b as fe}from"./_StoriesComponents-qw3Cph9e.js";import{F as ye}from"./index-BwReBjvh.js";import{P as ge}from"./index-BWWcrcy6.js";const T=64,xe=3.5,r=b.create({list:{marginVertical:w[8]},flatList:{scrollBehavior:"smooth"},item:{flexShrink:1,flexGrow:1,justifyContent:"center",paddingHorizontal:w[24],paddingVertical:0,transitionProperty:"background-color",transitionDuration:"200ms",outlineStyle:"none",justifyContents:"center"},hoveredItem:{backgroundColor:u.gray[0]},focusedItem:{backgroundColor:u.gray[0]},pressedItem:{backgroundColor:u.gray[100]},itemText:{userSelect:"none"},loader:{padding:w[24]},listContainer:{flexGrow:1,flexShrink:1},loaderAdditional:{...b.absoluteFillObject,alignItems:"center",justifyContent:"center"},loaderAdditionalUnderlay:{...b.absoluteFillObject,backgroundColor:ae.accented,opacity:.8},emptyList:{height:136},emptyListText:{color:u.gray.primary},input:{width:1,flexGrow:1}}),he=(I,i)=>({length:T,offset:T*i,index:i}),be=({inputRef:I,value:i,items:k,itemHeight:C=T,nbItemsDisplayed:N=xe,ListFooterComponent:O,onChange:_,onValueChange:j,onSelectItem:V,renderItem:B,keyExtractor:G,icon:H,placeholder:K,disabled:U=!1,emptyResultText:z,readOnly:M,id:W,error:Y,hideErrors:J},Q)=>{const f=t.useRef(null),X=de(f,I),Z=t.useRef(null),y=t.useRef(null),c=t.useRef(void 0),[$,L]=t.useState(!1),[g,l]=t.useState("closed"),ee=t.useCallback(()=>l("opened"),[]),te=t.useCallback(()=>l("closed"),[]),E=t.useCallback(()=>l("dismissed"),[]);t.useImperativeHandle(Q,()=>({open:ee,close:te}));const R=t.useId(),ne=t.useCallback(n=>{var s;if(n.nativeEvent.key==="ArrowDown"){const o=y.current;o!=null&&((s=F(o,!1)[0])==null||s.focus(),n.preventDefault())}},[]),re=t.useCallback(n=>{var s,o;if(n.nativeEvent.key==="ArrowDown"||n.nativeEvent.key==="ArrowUp"){const a=y.current;if(a!=null){const p=a,x=n.currentTarget,d=F(p,!1),A=d.indexOf(x),oe=n.nativeEvent.key==="ArrowDown"?1:-1;if(A===-1)return;const h=A+oe;n.preventDefault(),h===-1?(s=f.current)==null||s.focus():(o=d[h===d.length?0:h])==null||o.focus()}}},[]),se=t.useCallback(n=>{j(n),l(D(n)?"opened":"closed")},[j]),v=t.useCallback(()=>{D(i)&&(window.clearTimeout(c.current),c.current=window.setTimeout(()=>{l(n=>n==="closed"?"opened":n)},100))},[i]),q=t.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>{l("dismissed")},100)},[]);return e.jsxs(m,{children:[e.jsx(me,{containerRef:X,style:r.input,ariaExpanded:g==="opened",ariaControls:g==="opened"?R:"",enterKeyHint:"search",icon:H,role:"combobox",placeholder:K,value:i,disabled:U,error:Y,hideErrors:J,onChangeText:se,onChange:_,onFocus:v,onBlur:q,onKeyPress:ne,id:W,readOnly:M}),e.jsx(pe,{id:R,role:"listbox",matchReferenceWidth:!0,onEscapeKey:E,referenceRef:f,autoFocus:!1,returnFocus:!0,visible:g==="opened"&&!k.isNotAsked(),underlay:!1,forcedMode:"Dropdown",children:e.jsx(m,{style:[r.list,{maxHeight:C*N}],children:k.match({NotAsked:()=>null,Loading:()=>e.jsx(S,{style:r.loader}),Done:n=>n.match({Error:s=>e.jsx(P,{name:"error-circle-regular",size:22,color:u.negative[500]}),Ok:s=>e.jsxs(m,{ref:y,style:r.listContainer,children:[s.length===0?e.jsxs(ie,{justifyContent:"center",alignItems:"center",style:r.emptyList,children:[e.jsx(P,{name:"clipboard-search-regular",size:24,color:u.gray.primary}),e.jsx(le,{height:8}),e.jsx(ue,{style:r.emptyListText,children:z})]}):e.jsx(ye,{ref:Z,keyExtractor:G,getItemLayout:he,role:"list",data:s,style:r.flatList,ItemSeparatorComponent:fe,renderItem:({item:o})=>{const a=B(o);return e.jsx(ge,{onFocus:v,onBlur:q,role:"listitem",onKeyDown:re,style:({hovered:p,pressed:x,focused:d})=>[r.item,p&&r.hoveredItem,d&&r.focusedItem,x&&r.pressedItem,{height:C}],onPress:()=>{window.clearTimeout(c.current),L(!0),Promise.resolve(V(o)).finally(()=>{L(!1),E()})},children:typeof a=="string"||typeof a=="number"?e.jsx(ce,{numberOfLines:1,style:r.itemText,children:a}):a})}}),O,$?e.jsxs(m,{style:r.loaderAdditional,children:[e.jsx(m,{style:r.loaderAdditionalUnderlay}),e.jsx(S,{})]}):null]})})})})})]})},we=t.forwardRef(be);we.__docgenInfo={description:"",methods:[],displayName:"LakeCombobox",props:{inputRef:{required:!1,tsType:{name:"RefObject",elements:[{name:"unknown"}],raw:"RefObject<unknown>"},description:""},value:{required:!0,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"AsyncData",elements:[{name:"Result",elements:[{name:"Array",elements:[{name:"I"}],raw:"I[]"},{name:"unknown"}],raw:"Result<I[], unknown>"}],raw:"AsyncData<Result<I[], unknown>>"},description:""},itemHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"64",computed:!1}},nbItemsDisplayed:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3.5",computed:!1}},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},onChange:{required:!1,tsType:{name:'intersection["onChange"]',raw:'LakeTextInputProps["onChange"]'},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onSelectItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: I) => void | Promise<unknown>",signature:{arguments:[{type:{name:"I"},name:"value"}],return:{name:"union",raw:"void | Promise<unknown>",elements:[{name:"void"},{name:"Promise",elements:[{name:"unknown"}],raw:"Promise<unknown>"}]}}},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => ReactNode | null",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"union",raw:"ReactNode | null",elements:[{name:"ReactNode"},{name:"null"}]}}},description:""},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => string",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"string"}}},description:""},icon:{required:!1,tsType:{name:"unknown"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},emptyResultText:{required:!0,tsType:{name:"string"},description:""},error:{required:!1,tsType:{name:"string"},description:""},hideErrors:{required:!1,tsType:{name:"boolean"},description:""},id:{required:!1,tsType:{name:"string"},description:""},readOnly:{required:!1,tsType:{name:"boolean"},description:""}}};export{we as L};
//# sourceMappingURL=LakeCombobox-DVMyvLO9.js.map
