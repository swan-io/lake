import{h as L,j as e,V as c,M as re,z as se,B as oe,I as q,c as l,S as ae,L as A,s as x,m as ie,d as b}from"./ScrollView-CcIGNm4K.js";import{r as t}from"./iframe-Do3O1IWX.js";import{u as le}from"./Pressable-Bj74Kzq-.js";import{g as D}from"./FocusTrap-6YpJ5E2A.js";import{P as ue,F as de}from"./Popover-B_avZPKV.js";import{L as ce}from"./LakeTextInput-5NEnuH7s.js";import{L as F}from"./Suspendable-DFaxgPsb.js";import{S as me}from"./Separator-dwUC6aX6.js";import{M as pe}from"./index-BWxOZfMx.js";const fe=64,ye=3.5,r=x.create({list:{marginVertical:b[8]},flatList:{scrollBehavior:"smooth"},item:{flexShrink:1,flexGrow:1,justifyContent:"center",paddingHorizontal:b[24],paddingVertical:0,transitionProperty:"background-color",transitionDuration:"200ms",outlineStyle:"none",justifyContents:"center"},hoveredItem:{backgroundColor:l.gray[0]},focusedItem:{backgroundColor:l.gray[0]},pressedItem:{backgroundColor:l.gray[100]},itemText:{userSelect:"none"},loader:{padding:b[24]},listContainer:{flexGrow:1,flexShrink:1},loaderAdditional:{...x.absoluteFillObject,alignItems:"center",justifyContent:"center"},loaderAdditionalUnderlay:{...x.absoluteFillObject,backgroundColor:ie.accented,opacity:.8},emptyList:{height:136},emptyListText:{color:l.gray.primary},input:{width:1,flexGrow:1}}),ge=({ref:P,inputRef:S,value:p,items:k,itemHeight:T=fe,nbItemsDisplayed:N=ye,ListFooterComponent:V,onChange:_,onValueChange:I,onSelectItem:B,renderItem:O,keyExtractor:G,icon:H,placeholder:K,disabled:M=!1,emptyResult:U,readOnly:z,id:W,error:Y,hideErrors:J})=>{const f=t.useRef(null),Q=le(f,S),y=t.useRef(null),u=t.useRef(void 0),[X,v]=t.useState(!1),[g,i]=t.useState("closed"),Z=t.useCallback(()=>i("opened"),[]),$=t.useCallback(()=>i("closed"),[]),C=t.useCallback(()=>i("dismissed"),[]);t.useImperativeHandle(P,()=>({open:Z,close:$}));const j=t.useId(),ee=t.useCallback(n=>{if(n.nativeEvent.key==="ArrowDown"){const o=y.current;o!=null&&(D(o,!1)[0]?.focus(),n.preventDefault())}},[]),ne=t.useCallback(n=>{if(n.nativeEvent.key==="ArrowDown"||n.nativeEvent.key==="ArrowUp"){const o=y.current;if(o!=null){const s=o,a=n.currentTarget,d=D(s,!1),m=d.indexOf(a),w=n.nativeEvent.key==="ArrowDown"?1:-1;if(m===-1)return;const h=m+w;n.preventDefault(),h===-1?f.current?.focus():d[h===d.length?0:h]?.focus()}}},[]),te=t.useCallback(n=>{I(n),i(L(n)?"opened":"closed")},[I]),E=t.useCallback(()=>{L(p)&&(window.clearTimeout(u.current),u.current=window.setTimeout(()=>{i(n=>n==="closed"?"opened":n)},100))},[p]),R=t.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>{i("dismissed")},100)},[]);return e.jsxs(c,{children:[e.jsx(ce,{containerRef:Q,style:r.input,ariaExpanded:g==="opened",ariaControls:g==="opened"?j:"",enterKeyHint:"search",icon:H,role:"combobox",placeholder:K,value:p,disabled:M,error:Y,hideErrors:J,onChangeText:te,onChange:_,onFocus:E,onBlur:R,onKeyPress:ee,id:W,readOnly:z}),e.jsx(ue,{id:j,role:"listbox",matchReferenceWidth:!0,onEscapeKey:C,referenceRef:f,autoFocus:!1,returnFocus:!0,visible:g==="opened"&&!k.isNotAsked(),underlay:!1,forcedMode:"Dropdown",children:e.jsx(c,{style:[r.list,{maxHeight:T*N}],children:k.match({NotAsked:()=>null,Loading:()=>e.jsx(F,{style:r.loader}),Done:n=>n.match({Error:o=>e.jsx(q,{name:"error-circle-regular",size:22,color:l.negative[500]}),Ok:o=>e.jsxs(c,{ref:y,style:r.listContainer,children:[o.length===0?re(U).with(se.string,s=>e.jsxs(oe,{justifyContent:"center",alignItems:"center",style:r.emptyList,children:[e.jsx(q,{name:"clipboard-search-regular",size:24,color:l.gray.primary}),e.jsx(ae,{height:8}),e.jsx(A,{style:r.emptyListText,children:s})]})).when(s=>typeof s=="object"&&s!=null,s=>s).exhaustive():e.jsx(de,{keyExtractor:G,role:"list",data:o,style:r.flatList,ItemSeparatorComponent:e.jsx(me,{}),renderItem:({item:s})=>{const a=O(s);return e.jsx(pe,{onFocus:E,onBlur:R,role:"listitem",onKeyDown:ne,style:({hovered:d,pressed:m,focused:w})=>[r.item,d&&r.hoveredItem,w&&r.focusedItem,m&&r.pressedItem,{height:T}],onPress:()=>{window.clearTimeout(u.current),v(!0),Promise.resolve(B(s)).finally(()=>{v(!1),C()})},children:typeof a=="string"||typeof a=="number"?e.jsx(A,{numberOfLines:1,style:r.itemText,children:a}):a})}}),V,X?e.jsxs(c,{style:r.loaderAdditional,children:[e.jsx(c,{style:r.loaderAdditionalUnderlay}),e.jsx(F,{})]}):null]})})})})})]})};ge.__docgenInfo={description:"",methods:[],displayName:"LakeCombobox",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:`{
  close: () => void;
  open: () => void;
}`,signature:{properties:[{key:"close",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}}]}}],raw:"Ref<LakeComboboxRef>"},description:""},inputRef:{required:!1,tsType:{name:"Ref",elements:[{name:"unknown"}],raw:"Ref<unknown>"},description:""},value:{required:!0,tsType:{name:"string"},description:""},items:{required:!0,tsType:{name:"AsyncData",elements:[{name:"Result",elements:[{name:"Array",elements:[{name:"I"}],raw:"I[]"},{name:"unknown"}],raw:"Result<I[], unknown>"}],raw:"AsyncData<Result<I[], unknown>>"},description:""},itemHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"64",computed:!1}},nbItemsDisplayed:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"3.5",computed:!1}},ListFooterComponent:{required:!1,tsType:{name:"ReactNode"},description:""},onChange:{required:!1,tsType:{name:'intersection["onChange"]',raw:'LakeTextInputProps["onChange"]'},description:""},onValueChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onSelectItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: I) => void | Promise<unknown>",signature:{arguments:[{type:{name:"I"},name:"value"}],return:{name:"union",raw:"void | Promise<unknown>",elements:[{name:"void"},{name:"Promise",elements:[{name:"unknown"}],raw:"Promise<unknown>"}]}}},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => ReactNode | null",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"union",raw:"ReactNode | null",elements:[{name:"ReactNode"},{name:"null"}]}}},description:""},keyExtractor:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: I) => string",signature:{arguments:[{type:{name:"I"},name:"item"}],return:{name:"string"}}},description:""},icon:{required:!1,tsType:{name:"unknown"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},emptyResult:{required:!0,tsType:{name:"union",raw:"string | ReactElement",elements:[{name:"string"},{name:"ReactElement"}]},description:""},error:{required:!1,tsType:{name:"string"},description:""},hideErrors:{required:!1,tsType:{name:"boolean"},description:""},id:{required:!1,tsType:{name:"string"},description:""},readOnly:{required:!1,tsType:{name:"boolean"},description:""}}};export{ge as L};
//# sourceMappingURL=LakeCombobox-CrzZtfhC.js.map
