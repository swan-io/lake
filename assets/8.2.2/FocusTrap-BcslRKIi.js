import{i as w,f as g,$ as q,j as S,V as x}from"./Space-lmyxvGbk.js";import{r as e}from"./index-BwDkhjyp.js";import{g as L}from"./a11y-DXvpDVrG.js";import{f as I,l as N}from"./array-rjEBP2Ry.js";const M=(o,r)=>{const c=e.useRef(o);e.useEffect(()=>{c.current=o},[o]),e.useEffect(()=>{const n=window.setInterval(()=>c.current(n),r);return()=>window.clearInterval(n)},[r])},V=({containerRef:o,onClickOutside:r,onFocusOutside:c})=>{const n=e.useRef(!1),a=e.useCallback(s=>{const u=s.target;return w(o.current)&&o.current instanceof HTMLElement&&o.current.contains(u)},[o]);e.useEffect(()=>{if(g(r))return;const s=i=>{a(i)||(n.current=!0)},u=i=>{!a(i)&&n.current&&(r==null||r(i)),n.current=!1};return document.addEventListener("mousedown",s,!0),document.addEventListener("mouseup",u,!0),document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",u,!0),()=>{document.removeEventListener("mousedown",s,!0),document.removeEventListener("mouseup",u,!0),document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",u,!0)}},[a,r]),e.useEffect(()=>{if(g(c))return;const s=u=>{a(u)||c==null||c(u)};return document.addEventListener("focusin",s,!0),()=>{document.removeEventListener("focusin",s,!0)}},[a,c])};let E=0;const j=e.forwardRef(({children:o,focusLock:r,onClickOutside:c,onEscapeKey:n,returnFocus:a,style:s,autoFocus:u},i)=>{const m=e.useRef(null),h=e.useRef(null),y=e.useRef(!1);e.useImperativeHandle(i,()=>({setInitiallyFocusedElement:t=>h.current=t}));const[T]=e.useState(E);e.useEffect(()=>(++E,()=>{--E}));const R=e.useCallback(({nativeEvent:t})=>{q(t.key).with("Escape",()=>{E===T+1&&(n==null||n())}).with("Tab",()=>{if(!r)return;const f=m.current;if(w(f)){const d=t.target,l=L(f),p=I(l),v=N(l);d===p&&t.shiftKey&&(t.preventDefault(),v==null||v.focus()),d===v&&!t.shiftKey&&(t.preventDefault(),p==null||p.focus())}}).otherwise(()=>{})},[r,n,T]);e.useEffect(()=>{if(a)return h.current=document.activeElement,()=>{var t;y.current||(t=h.current)==null||t.focus()}},[a]),M(t=>{if(u){const f=m.current;if(w(f)){if(f.offsetWidth===0)return;const d=L(f),l=I(d);l==null||l.focus(),window.clearInterval(t)}}},16);const b=e.useCallback(()=>{y.current=!0},[]);return V({containerRef:m,onClickOutside:c,onFocusOutside:b}),S.jsx(x,{ref:m,onKeyDownCapture:R,style:s,children:o})});j.__docgenInfo={description:"",methods:[{name:"setInitiallyFocusedElement",docblock:null,modifiers:[],params:[{name:"element",optional:!1,type:null}],returns:null}],displayName:"FocusTrap",props:{autoFocus:{required:!0,tsType:{name:"boolean"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},focusLock:{required:!0,tsType:{name:"boolean"},description:""},onClickOutside:{required:!1,tsType:{name:"signature",type:"function",raw:"(event: TouchEvent | MouseEvent) => void",signature:{arguments:[{type:{name:"union",raw:"TouchEvent | MouseEvent",elements:[{name:"TouchEvent"},{name:"MouseEvent"}]},name:"event"}],return:{name:"void"}}},description:""},onEscapeKey:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},returnFocus:{required:!0,tsType:{name:"boolean"},description:""},style:{required:!1,tsType:{name:"StyleProp",elements:[{name:"ViewStyle"}],raw:"StyleProp<ViewStyle>"},description:""}}};export{j as F};
//# sourceMappingURL=FocusTrap-BcslRKIi.js.map
