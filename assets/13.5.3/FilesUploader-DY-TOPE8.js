import{j as e,B as w,L as j,c as y,S as f,V as D,I as P,M as R,z as S,a0 as E,g as O,f as V,s as A,ag as L,d as T,m as B}from"./ScrollView-DKnHZPpz.js";import{r as o}from"./iframe-BVF-ltaA.js";import{g as N,F as z}from"./FileInput-DPvINIb9.js";import{L as C}from"./LakeAlert-bELhbywT.js";import{a as I,L as G}from"./LakeButton-BBjEMhqV.js";import{P as _}from"./Pressable-DRiMdEc4.js";import{T as H}from"./Tag-DY-CMiUR.js";import{c as W}from"./commonStyles-BBEkV6IC.js";import{s as Q}from"./clipboard-BXAk6GqW.js";import{t as r}from"./i18n-MyaAAreT.js";import{L as $}from"./LakeModal-Bh8P_MqC.js";const J=a=>{const[m,p]=o.useState(a.initialFiles),v=o.useCallback(s=>{p(i=>i.some(t=>t.id===s.id)?i.map(t=>t.id===s.id?s:t):[...i,s])},[]),h=o.useCallback((s,i)=>a.generateUpload(s).tapError(t=>{a.onError!=null&&a.onError(t)}).flatMapOk(({upload:t,id:l})=>{p(u=>[...u.filter(n=>n.id!==l),{id:l,statusInfo:{status:"Uploading",progress:0},name:i.name}]);const k=u=>{p(n=>n.map(d=>d.id!==l?d:{...d,statusInfo:{status:"Uploading",progress:u}}))};return a.uploadFile({id:l,upload:t,file:i,onProgress:k}).tapOk(()=>{p(u=>u.map(n=>n.id!==l?n:{...n,statusInfo:{status:"Uploaded"}}))}).tapError(u=>{a.onError!=null&&a.onError(u),p(n=>n.filter(d=>d.id!==l))})}),[a]),c=o.useCallback(s=>{p(i=>i.filter(t=>t.id!==s))},[]);return{files:m,upload:h,remove:c,add:v}},q=A.create({base:{backgroundColor:B.accented,borderRadius:8,borderWidth:1,overflow:"hidden"},content:{height:56,paddingLeft:T[20],paddingRight:T[8]},progressBar:{flex:1,height:4,borderRadius:2,backgroundColor:L},progress:{height:4,transitionProperty:"width",transitionDuration:"1000ms",transitionTimingFunction:"ease-in-out",borderRadius:2,backgroundColor:y.current[500]},id:{alignSelf:"flex-start"}}),M=({file:{id:a,statusInfo:m,name:p,url:v},showId:h=!1,onRemove:c})=>{const[s,i]=o.useState(!1),[t,l]=o.useState(!1),k=o.useCallback(()=>{c!=null&&(i(!0),c().tap(()=>{i(!1),l(!1)}))},[c]),[u,n]=o.useState("copy");return e.jsxs(w,{style:[q.base,{borderColor:R(m.status).with("Uploaded","Uploading",()=>y.gray[100]).with("Pending",()=>y.shakespear[100]).with("Validated",()=>y.positive[500]).with("Refused",()=>y.negative[100]).exhaustive()}],children:[e.jsx(w,{alignItems:"center",direction:"row",style:q.content,children:m.status==="Uploading"?e.jsxs(e.Fragment,{children:[e.jsx(j,{numberOfLines:1,color:y.gray[700],children:r("fileTile.uploading")}),e.jsx(f,{width:20}),e.jsx(D,{role:"progressbar",style:q.progressBar,children:e.jsx(D,{style:[q.progress,{width:`${m.progress*100}%`}]})})]}):e.jsxs(e.Fragment,{children:[m.status==="Validated"?e.jsx(P,{size:24,color:y.positive[500],name:"checkmark-circle-regular"}):e.jsx(H,{icon:N(p),iconSize:20,color:R(m).with({status:S.union("Uploaded","Pending")},()=>"shakespear").with({status:"Refused"},()=>"negative").exhaustive()}),e.jsx(f,{width:16}),e.jsxs(w,{grow:1,children:[e.jsx(j,{numberOfLines:1,color:y.gray[700],style:W.fill,children:p}),h?e.jsx(D,{style:q.id,children:e.jsx(E,{describedBy:"copy",onHide:()=>n("copy"),togglableOnFocus:!0,content:u==="copy"?r("copyButton.copyTooltip"):r("copyButton.copiedTooltip"),children:e.jsx(_,{onPress:d=>{d.stopPropagation(),d.preventDefault(),Q(a),n("copied")},children:e.jsxs(w,{direction:"row",alignItems:"center",children:[e.jsx(j,{numberOfLines:1,variant:"smallRegular",children:r("fileTile.id",{id:a})}),e.jsx(f,{width:4}),e.jsx(P,{size:14,name:"copy-regular"})]})})})}):null]}),e.jsx(f,{width:12}),O(v)&&e.jsx(I,{mode:"tertiary",size:"small",icon:"open-filled",onPress:()=>{window.open(v,"_blank")},ariaLabel:r("common.open")}),V(c)&&e.jsx(I,{mode:"tertiary",size:"small",icon:"delete-regular",color:"negative",onPress:()=>l(!0),ariaLabel:r("common.remove")}),e.jsx($,{title:r("fileTile.deleteModal.title"),icon:"subtract-circle-regular",visible:t,onPressClose:()=>l(!1),color:"negative",children:e.jsx(G,{paddingBottom:0,children:e.jsx(I,{loading:s,grow:!0,color:"negative",onPress:k,children:r("fileTile.deleteModal.delete")})})})]})}),R(m).with({status:"Pending"},()=>e.jsx(C,{anchored:!0,title:r("fileTile.status.Pending"),variant:"info"})).with({status:"Refused"},({reason:d,reasonCode:F})=>e.jsx(C,{anchored:!0,title:r("fileTile.status.Refused"),variant:"error",children:e.jsxs(w,{direction:"column",children:[e.jsx(j,{children:R(F).with("BadDocumentQuality",()=>r("supportingDocuments.rejectionReason.BadDocumentQuality")).with("CompanyNameMismatch",()=>r("supportingDocuments.rejectionReason.CompanyNameMismatch")).with("DeclaredAmountMismatch",()=>r("supportingDocuments.rejectionReason.DeclaredAmountMismatch")).with("ExpiredDocument",()=>r("supportingDocuments.rejectionReason.ExpiredDocument")).with("FullDocumentRequired",()=>r("supportingDocuments.rejectionReason.FullDocumentRequired")).with("IbanMismatch",()=>r("supportingDocuments.rejectionReason.IbanMismatch")).with("InvalidAddress",()=>r("supportingDocuments.rejectionReason.InvalidAddress")).with("InvalidDocument",()=>r("supportingDocuments.rejectionReason.InvalidDocument")).with("InvalidOrMissingData",()=>r("supportingDocuments.rejectionReason.InvalidOrMissingData")).with("InvalidTransaction",()=>r("supportingDocuments.rejectionReason.InvalidTransaction")).with("HandwrittenOrCertifiedElectronicSignatureRequired",()=>r("supportingDocuments.rejectionReason.HandwrittenOrCertifiedElectronicSignatureRequired")).with("MissingAccommodationProviderId",()=>r("supportingDocuments.rejectionReason.MissingAccommodationProviderId")).with("MissingAccommodationProviderIdLetter",()=>r("supportingDocuments.rejectionReason.MissingAccommodationProviderIdLetter")).with("MissingAccommodationProviderLetter",()=>r("supportingDocuments.rejectionReason.MissingAccommodationProviderLetter")).with("MissingCompanyDomiciliationStatement",()=>r("supportingDocuments.rejectionReason.MissingCompanyDomiciliationStatement")).with("MissingProviderProofOfAddress",()=>r("supportingDocuments.rejectionReason.MissingProviderProofOfAddress")).with("MissingProviderProofOfAddressAndIdDocument",()=>r("supportingDocuments.rejectionReason.MissingProviderProofOfAddressAndIdDocument")).with("MissingDescription",()=>r("supportingDocuments.rejectionReason.MissingDescription")).with("MissingSignature",()=>r("supportingDocuments.rejectionReason.MissingSignature")).with("PowerOfAttorneyToSwanRequired",()=>r("supportingDocuments.rejectionReason.PowerOfAttorneyToSwanRequired")).with("ProviderColorIdDocumentRequired",()=>r("supportingDocuments.rejectionReason.ProviderColorIdDocumentRequired")).with("TransactionAmountMismatch",()=>r("supportingDocuments.rejectionReason.TransactionAmountMismatch")).with("TransactionDateMismatch",()=>r("supportingDocuments.rejectionReason.TransactionDateMismatch")).with("TransactionNameMismatch",()=>r("supportingDocuments.rejectionReason.TransactionNameMismatch")).with("UnacceptableDocument",()=>r("supportingDocuments.rejectionReason.UnacceptableDocument")).with("other",()=>null).otherwise(b=>b)}),e.jsx(j,{children:d})]})})).otherwise(()=>null)]})};M.__docgenInfo={description:"",methods:[],displayName:"FileTile",props:{file:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  id: string;
  statusInfo: SwanFileStatusInfo;
  name: string;
  url?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"statusInfo",value:{name:"union",raw:`| { status: "Uploading"; progress: number }
| { status: "Uploaded" }
| { status: "Pending" }
| { status: "Validated" }
| {
    status: "Refused";
    reason: string;
    reasonCode?: string;
  }`,elements:[{name:"signature",type:"object",raw:'{ status: "Uploading"; progress: number }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploading"',required:!0}},{key:"progress",value:{name:"number",required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Uploaded" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploaded"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Pending" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Pending"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Validated" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Validated"',required:!0}}]}},{name:"signature",type:"object",raw:`{
  status: "Refused";
  reason: string;
  reasonCode?: string;
}`,signature:{properties:[{key:"status",value:{name:"literal",value:'"Refused"',required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"reasonCode",value:{name:"string",required:!1}}]}}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"url",value:{name:"string",required:!1}}]}},description:""},showId:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Future<unknown>",signature:{arguments:[],return:{name:"Future",elements:[{name:"unknown"}],raw:"Future<unknown>"}}},description:""}}};const K=({ref:a,maxSize:m,accept:p,icon:v,getUploadConfig:h,onRemoveFile:c,onChange:s,formatAndSizeDescription:i,canUpload:t=!0,showIds:l=!1,...k})=>{const{files:u,upload:n,remove:d,add:F}=J(k),b=o.useRef(s);b.current=s;const x=o.useRef(!0);return o.useImperativeHandle(a,()=>({add:F})),o.useEffect(()=>{if(x.current){x.current=!1;return}const g=b.current;g?.(u)},[u]),e.jsxs(w,{children:[t?e.jsxs(e.Fragment,{children:[e.jsx(z,{layout:"horizontal",onFiles:g=>{g.forEach(U=>{n(h(U),U)})},accept:p,icon:v,description:i,maxSize:m}),e.jsx(f,{height:12})]}):null,u.map((g,U)=>e.jsxs(o.Fragment,{children:[U>0?e.jsx(f,{height:12}):null,e.jsx(M,{file:g,showId:l,onRemove:c!=null&&g.statusInfo.status==="Uploaded"?()=>c(g).tapOk(()=>{d(g.id)}):void 0})]},g.id))]})};K.__docgenInfo={description:"",methods:[],displayName:"FilesUploader",props:{initialFiles:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  id: string;
  statusInfo: SwanFileStatusInfo;
  name: string;
  url?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"statusInfo",value:{name:"union",raw:`| { status: "Uploading"; progress: number }
| { status: "Uploaded" }
| { status: "Pending" }
| { status: "Validated" }
| {
    status: "Refused";
    reason: string;
    reasonCode?: string;
  }`,elements:[{name:"signature",type:"object",raw:'{ status: "Uploading"; progress: number }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploading"',required:!0}},{key:"progress",value:{name:"number",required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Uploaded" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploaded"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Pending" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Pending"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Validated" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Validated"',required:!0}}]}},{name:"signature",type:"object",raw:`{
  status: "Refused";
  reason: string;
  reasonCode?: string;
}`,signature:{properties:[{key:"status",value:{name:"literal",value:'"Refused"',required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"reasonCode",value:{name:"string",required:!1}}]}}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"url",value:{name:"string",required:!1}}]}}],raw:"SwanFile[]"},description:""},generateUpload:{required:!0,tsType:{name:"signature",type:"function",raw:`(
  config: UploadInput,
) => Future<Result<UploadOutputWithId<UploadOutput>, GenerateUploadError>>`,signature:{arguments:[{type:{name:"UploadInput"},name:"config"}],return:{name:"Future",elements:[{name:"Result",elements:[{name:"signature",type:"object",raw:"{ id: string; upload: UploadOutput }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"upload",value:{name:"UploadOutput",required:!0}}]}},{name:"GenerateUploadError"}],raw:"Result<UploadOutputWithId<UploadOutput>, GenerateUploadError>"}],raw:"Future<Result<UploadOutputWithId<UploadOutput>, GenerateUploadError>>"}}},description:""},uploadFile:{required:!0,tsType:{name:"signature",type:"function",raw:"(config: UploadFileInput<UploadOutput>) => Future<Result<unknown, UploadFileError>>",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  upload: UploadOutput;
  file: File;
  onProgress: (progress: number) => void;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"upload",value:{name:"UploadOutput",required:!0}},{key:"file",value:{name:"File",required:!0}},{key:"onProgress",value:{name:"signature",type:"function",raw:"(progress: number) => void",signature:{arguments:[{type:{name:"number"},name:"progress"}],return:{name:"void"}},required:!0}}]}},name:"config"}],return:{name:"Future",elements:[{name:"Result",elements:[{name:"unknown"},{name:"UploadFileError"}],raw:"Result<unknown, UploadFileError>"}],raw:"Future<Result<unknown, UploadFileError>>"}}},description:""},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: GenerateUploadError | UploadFileError) => void",signature:{arguments:[{type:{name:"union",raw:"GenerateUploadError | UploadFileError",elements:[{name:"GenerateUploadError"},{name:"UploadFileError"}]},name:"error"}],return:{name:"void"}}},description:""},ref:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:`{
  add: (file: SwanFile) => void;
}`,signature:{properties:[{key:"add",value:{name:"signature",type:"function",raw:"(file: SwanFile) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  statusInfo: SwanFileStatusInfo;
  name: string;
  url?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"statusInfo",value:{name:"union",raw:`| { status: "Uploading"; progress: number }
| { status: "Uploaded" }
| { status: "Pending" }
| { status: "Validated" }
| {
    status: "Refused";
    reason: string;
    reasonCode?: string;
  }`,elements:[{name:"signature",type:"object",raw:'{ status: "Uploading"; progress: number }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploading"',required:!0}},{key:"progress",value:{name:"number",required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Uploaded" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploaded"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Pending" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Pending"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Validated" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Validated"',required:!0}}]}},{name:"signature",type:"object",raw:`{
  status: "Refused";
  reason: string;
  reasonCode?: string;
}`,signature:{properties:[{key:"status",value:{name:"literal",value:'"Refused"',required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"reasonCode",value:{name:"string",required:!1}}]}}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"url",value:{name:"string",required:!1}}]}},name:"file"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<FilesUploaderRef>"},description:""},getUploadConfig:{required:!0,tsType:{name:"signature",type:"function",raw:"(file: File) => UploadInput",signature:{arguments:[{type:{name:"File"},name:"file"}],return:{name:"UploadInput"}}},description:""},accept:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxSize:{required:!0,tsType:{name:"number"},description:""},icon:{required:!0,tsType:{name:"unknown"},description:""},formatAndSizeDescription:{required:!1,tsType:{name:"string"},description:""},onRemoveFile:{required:!1,tsType:{name:"signature",type:"function",raw:"(file: SwanFile) => Future<Result<unknown, unknown>>",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  statusInfo: SwanFileStatusInfo;
  name: string;
  url?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"statusInfo",value:{name:"union",raw:`| { status: "Uploading"; progress: number }
| { status: "Uploaded" }
| { status: "Pending" }
| { status: "Validated" }
| {
    status: "Refused";
    reason: string;
    reasonCode?: string;
  }`,elements:[{name:"signature",type:"object",raw:'{ status: "Uploading"; progress: number }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploading"',required:!0}},{key:"progress",value:{name:"number",required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Uploaded" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploaded"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Pending" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Pending"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Validated" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Validated"',required:!0}}]}},{name:"signature",type:"object",raw:`{
  status: "Refused";
  reason: string;
  reasonCode?: string;
}`,signature:{properties:[{key:"status",value:{name:"literal",value:'"Refused"',required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"reasonCode",value:{name:"string",required:!1}}]}}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"url",value:{name:"string",required:!1}}]}},name:"file"}],return:{name:"Future",elements:[{name:"Result",elements:[{name:"unknown"},{name:"unknown"}],raw:"Result<unknown, unknown>"}],raw:"Future<Result<unknown, unknown>>"}}},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: SwanFile[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  id: string;
  statusInfo: SwanFileStatusInfo;
  name: string;
  url?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"statusInfo",value:{name:"union",raw:`| { status: "Uploading"; progress: number }
| { status: "Uploaded" }
| { status: "Pending" }
| { status: "Validated" }
| {
    status: "Refused";
    reason: string;
    reasonCode?: string;
  }`,elements:[{name:"signature",type:"object",raw:'{ status: "Uploading"; progress: number }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploading"',required:!0}},{key:"progress",value:{name:"number",required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Uploaded" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Uploaded"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Pending" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Pending"',required:!0}}]}},{name:"signature",type:"object",raw:'{ status: "Validated" }',signature:{properties:[{key:"status",value:{name:"literal",value:'"Validated"',required:!0}}]}},{name:"signature",type:"object",raw:`{
  status: "Refused";
  reason: string;
  reasonCode?: string;
}`,signature:{properties:[{key:"status",value:{name:"literal",value:'"Refused"',required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"reasonCode",value:{name:"string",required:!1}}]}}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"url",value:{name:"string",required:!1}}]}}],raw:"SwanFile[]"},name:"files"}],return:{name:"void"}}},description:""},canUpload:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showIds:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};export{K as F};
//# sourceMappingURL=FilesUploader-DY-TOPE8.js.map
