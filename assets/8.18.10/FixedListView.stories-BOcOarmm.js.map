{"version":3,"file":"FixedListView.stories-BOcOarmm.js","sources":["../../../packages/lake/__stories__/FixedListView.stories.tsx"],"sourcesContent":["import { Meta, StoryFn } from \"@storybook/react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { v4 as uuid } from \"uuid\";\nimport { Box } from \"../src/components/Box\";\nimport {\n  ColumnCellConfig,\n  ColumnTitleConfig,\n  FixedListView,\n  FixedListViewEmpty,\n  FixedListViewPlaceholder,\n  FixedListViewProps,\n} from \"../src/components/FixedListView\";\nimport {\n  ColorPatchCell,\n  LinkCell,\n  SimpleHeaderCell,\n  SimpleRegularTextCell,\n  SimpleTitleCell,\n} from \"../src/components/FixedListViewCells\";\nimport { LakeButton } from \"../src/components/LakeButton\";\nimport { LakeLabelledCheckbox } from \"../src/components/LakeCheckbox\";\nimport { Space } from \"../src/components/Space\";\nimport { Tag } from \"../src/components/Tag\";\n\nexport default {\n  title: \"Layout/FixedListView\",\n  component: FixedListView,\n} as Meta<typeof FixedListView>;\n\ntype TestRow = {\n  id: string;\n  name: string;\n};\n\nconst keyExtractor = ({ id }: TestRow) => id;\n\ntype SortInfo = {\n  key: string;\n  order: \"Asc\" | \"Desc\";\n};\n\nconst generateRandomName = () => {\n  const names = [\n    \"Matthias\",\n    \"John\",\n    \"Jane\",\n    \"Camille\",\n    \"Charlotte\",\n    \"Francis\",\n    \"Émilie\",\n    \"François\",\n    \"Laura\",\n    \"Marie\",\n    \"Natasha\",\n    \"Nicolas\",\n    \"Pierre\",\n    \"Thomas\",\n    \"Valérie\",\n    \"Yann\",\n    \"Zoé\",\n    \"Jérôme\",\n    \"Thomas\",\n  ] as const;\n\n  return names[Math.floor(Math.random() * names.length)] ?? names[0];\n};\n\nconst generateItem = (): TestRow => {\n  return {\n    id: uuid(),\n    name: generateRandomName(),\n  };\n};\n\nconst EditableFixedListView = (props: Pick<FixedListViewProps<TestRow, SortInfo>, \"mode\">) => {\n  const [sort, setSort] = useState<SortInfo>({ key: \"name\", order: \"Desc\" });\n  const [endReachedTimes, setEndReachedTimes] = useState(0);\n  const [withInfiniteScroll, setWithInfiniteScroll] = useState(false);\n  const [showFakeLoader, setShowFakeLoader] = useState(false);\n  const [forceIsLoading, setForceIsLoading] = useState(false);\n\n  const [data, setData] = useState(() => Array.from({ length: 100 }, _ => generateItem()));\n\n  const onEndReached = useCallback(() => {\n    setEndReachedTimes(v => v + 1);\n    if (withInfiniteScroll) {\n      setShowFakeLoader(true);\n    }\n  }, [withInfiniteScroll]);\n\n  useEffect(() => {\n    if (showFakeLoader) {\n      const timeout = setTimeout(() => {\n        setShowFakeLoader(false);\n        setData(data => [...data, ...Array.from({ length: 100 }, _ => generateItem())]);\n      }, 1000);\n\n      return () => clearTimeout(timeout);\n    }\n  });\n\n  const { stickedToStartColumns, columns, stickedToEndColumns } = useMemo(() => {\n    const stickedToStartColumns = [\n      {\n        width: 4,\n        id: \"color\",\n        title: \"Color\",\n        renderTitle: () => null,\n        renderCell: ({ isHovered }: ColumnCellConfig<TestRow, SortInfo>) => (\n          <ColorPatchCell isHovered={isHovered} color=\"live\" />\n        ),\n      },\n      {\n        width: 300,\n        id: \"name\",\n        title: \"Name\",\n        renderTitle: ({ title, extraInfo, id }: ColumnTitleConfig<SortInfo>) => (\n          <SimpleHeaderCell\n            text={title}\n            sort={extraInfo.key === id ? extraInfo.order : undefined}\n            onPress={() => setSort({ key: id, order: extraInfo.order === \"Desc\" ? \"Asc\" : \"Desc\" })}\n          />\n        ),\n        renderCell: ({ item: { name } }: ColumnCellConfig<TestRow, SortInfo>) => (\n          <SimpleTitleCell text={name} />\n        ),\n      },\n    ];\n\n    const columns = [\n      {\n        width: 500,\n        id: \"event_id\",\n        title: \"Event ID\",\n        renderTitle: ({ title }: ColumnTitleConfig<SortInfo>) => <SimpleHeaderCell text={title} />,\n        renderCell: ({ item: { id } }: ColumnCellConfig<TestRow, SortInfo>) => (\n          <SimpleRegularTextCell text={id} />\n        ),\n      },\n      {\n        width: 150,\n        id: \"link_before\",\n        title: \"Link before\",\n        renderTitle: ({ title }: ColumnTitleConfig<SortInfo>) => <SimpleHeaderCell text={title} />,\n        renderCell: () => (\n          <LinkCell onPress={() => {}} buttonPosition=\"start\">\n            <Tag color=\"shakespear\">Demo link</Tag>\n          </LinkCell>\n        ),\n      },\n      {\n        width: 500,\n        id: \"onboarding_id\",\n        title: \"Onboarding ID\",\n        renderTitle: ({ title }: ColumnTitleConfig<SortInfo>) => <SimpleHeaderCell text={title} />,\n        renderCell: ({ item: { id } }: ColumnCellConfig<TestRow, SortInfo>) => (\n          <SimpleRegularTextCell text={id} />\n        ),\n      },\n      {\n        width: 150,\n        id: \"link_after\",\n        title: \"Link after\",\n        renderTitle: ({ title }: ColumnTitleConfig<SortInfo>) => <SimpleHeaderCell text={title} />,\n        renderCell: () => (\n          <LinkCell onPress={() => {}} buttonPosition=\"end\">\n            <Tag color=\"shakespear\">Demo link</Tag>\n          </LinkCell>\n        ),\n      },\n      {\n        width: 500,\n        id: \"account_id\",\n        title: \"Account ID\",\n        renderTitle: ({ title }: ColumnTitleConfig<SortInfo>) => <SimpleHeaderCell text={title} />,\n        renderCell: ({ item: { id } }: ColumnCellConfig<TestRow, SortInfo>) => (\n          <SimpleRegularTextCell text={id} />\n        ),\n      },\n    ];\n\n    const stickedToEndColumns = [\n      {\n        width: 100,\n        id: \"dot\",\n        title: \"Settings\",\n        renderTitle: () => <SimpleHeaderCell text={\"End\"} />,\n        renderCell: () => <SimpleRegularTextCell text=\"...\" />,\n      },\n    ];\n\n    return { stickedToStartColumns, columns, stickedToEndColumns };\n  }, []);\n\n  return (\n    <>\n      <Box direction=\"row\" alignItems=\"center\">\n        <LakeButton\n          icon=\"add-circle-filled\"\n          color=\"live\"\n          onPress={() => setData(data => [generateItem(), ...data])}\n        >\n          Prepend\n        </LakeButton>\n\n        <Space width={16} />\n\n        <LakeButton icon=\"delete-filled\" color=\"negative\" onPress={() => setData([])}>\n          Clear\n        </LakeButton>\n\n        <Space width={16} />\n        <Tag label=\"End reached\">{endReachedTimes} times</Tag>\n        <Space width={16} />\n\n        <LakeLabelledCheckbox\n          label=\"With infinite scroll\"\n          value={withInfiniteScroll}\n          onValueChange={setWithInfiniteScroll}\n        />\n\n        <Space width={16} />\n\n        <LakeLabelledCheckbox\n          label=\"Force loading state\"\n          value={forceIsLoading}\n          onValueChange={setForceIsLoading}\n        />\n      </Box>\n\n      <Space height={16} />\n\n      <FixedListView\n        extraInfo={sort}\n        keyExtractor={keyExtractor}\n        data={data}\n        stickedToStartColumns={stickedToStartColumns}\n        columns={columns}\n        stickedToEndColumns={stickedToEndColumns}\n        rowHeight={48}\n        rowVerticalSpacing={4}\n        headerHeight={48}\n        onEndReached={onEndReached}\n        onEndReachedThresholdPx={300}\n        renderEmptyList={() => (\n          <FixedListViewEmpty icon=\"lake-inbox-empty\" title=\"Nothing to see here\" />\n        )}\n        loading={{\n          isLoading: forceIsLoading || showFakeLoader,\n          count: 5,\n        }}\n        {...props}\n      />\n    </>\n  );\n};\n\nexport const Primary: StoryFn<typeof FixedListView> = () => {\n  return <EditableFixedListView />;\n};\n\nexport const WithoutBackground: StoryFn<typeof FixedListView> = () => {\n  return <EditableFixedListView mode=\"plain\" />;\n};\n\nexport const Placeholder: StoryFn<typeof FixedListView> = () => {\n  return (\n    <FixedListViewPlaceholder rowHeight={48} rowVerticalSpacing={4} headerHeight={48} count={3} />\n  );\n};\n"],"names":["FixedListView_stories","title","component","FixedListView","keyExtractor","id","generateRandomName","names","Math","floor","random","length","generateItem","uuid","name","EditableFixedListView","props","sort","setSort","useState","key","order","endReachedTimes","setEndReachedTimes","withInfiniteScroll","setWithInfiniteScroll","showFakeLoader","setShowFakeLoader","forceIsLoading","setForceIsLoading","data","setData","Array","from","_","onEndReached","useCallback","v","useEffect","timeout","setTimeout","clearTimeout","stickedToStartColumns","columns","stickedToEndColumns","useMemo","width","renderTitle","renderCell","isHovered","jsx","ColorPatchCell","extraInfo","SimpleHeaderCell","undefined","item","SimpleTitleCell","SimpleRegularTextCell","LinkCell","Tag","jsxs","Fragment","Box","LakeButton","Space","LakeLabelledCheckbox","FixedListViewEmpty","isLoading","count","Primary","WithoutBackground","Placeholder","FixedListViewPlaceholder"],"mappings":"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"}